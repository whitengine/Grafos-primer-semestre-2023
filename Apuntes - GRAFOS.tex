\documentclass[12pt]{report}


\usepackage{fouriernc}%la fuente
%\usepackage[sc]{mathpazo} %antigua fuente

\usepackage[utf8]{inputenc}

\usepackage[a4paper,width=150mm,top=25mm,bottom=25mm]{geometry}



\usepackage{subfiles} %esto es para modularizar el overleaf
%para usar este paquete solamente hay que usar el comando
%\subfile{}



\usepackage{graphicx}

\graphicspath{{./Apendice/Figuras/Capitulo
    1/}{./Editor de Grafos/Figuras/Clase 11/}{./Editor de Grafos/Figuras/Clase 12/}{./Editor de Grafos/Figuras/Clase 13/}{./Editor de Grafos/Figuras/Clase 14/}{./Editor de Grafos/Figuras/Clase 15/}} %esto es para que encuentre las figuras hechas con pdf_tex en inkscape

\usepackage{framed}
\usepackage[dvipsnames]{xcolor} %agrega mas colores para xcolor.

%\usepackage[outdir=./]{epstopdf} %sin esto importar eps es imposible



\usepackage{xparse}
\usepackage{xstring}

\usepackage{stmaryrd} %para poner el comando \mapsfrom "<---|"	

\usepackage{amssymb}

\usepackage{amsmath}

\usepackage{subfig}

\usepackage{mathrsfs} % para tener mas tipos de texto: \mathscr que es una letra mayuscula cursiva.

\usepackage{tikz-cd}

\usepackage{tkz-graph}%este paquete es para crear grafos con el ambiente \begin{tikzpicture}

\usepackage{caption}

\usepackage[shortlabels]{enumitem}

\usepackage{mathabx}
\let\widering\relax %esto es porque hay problemas con el comando \widering que se define en la fuenta fouriernc y en el paquete \usepackage{mathabx}

\usepackage[spanish,activeacute]{babel}

\usepackage{xparse}
\usepackage{xstring}

\usepackage{braket} %para definir \set , \Set y que los conjuntos se vean mas lindos

\usepackage{mathtools}

\usepackage[shortlabels]{enumitem}

\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=red,
    filecolor=red,
    linkcolor=red,
    urlcolor=red
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsthm}

\theoremstyle{plain}
\newtheorem{theorem}{Teorema}[section]
\newtheorem{lemma}[theorem]{Lema}
\newtheorem{proposition}[theorem]{Proposición}
\newtheorem{proposition/definition}[theorem]{Proposición/Definición}
\newtheorem{corollary}[theorem]{Corolario}
\newtheorem{conjecture}[theorem]{Conjetura}
\newtheorem{afirmacion}[theorem]{Afirmación}
\newtheorem{recuerdo}[theorem]{Recuerdo}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definición}
\newtheorem{hypothesis}[theorem]{Hipótesis}
\newtheorem{example}[theorem]{Ejemplo}
\newtheorem{obs}[theorem]{Observación}
\newtheorem{notation}[theorem]{Notación}
\newtheorem{remark}[theorem]{Comentario}


%por alguna razon el teorema $warning  est aen uso, asi que lo remuevo de maqnera trucha
\newtheorem{warn}[theorem]{\textbf{ADVERTENCIA}}
\renewenvironment{warning}{\begin{warn}}{\end{warn}}

%crear ejercicio
\newtheorem{exercise}[theorem]{Ejercicio}
%solución
\newenvironment{solution}{\begin{proof}[Solución]}{\end{proof}}





%como crear un nuevo ambiente de teorema o proposición que este sobreado con un recuadro de "color". primero hacemos

%\newenvironment{Theorem}{\colorlet{shadecolor}{color} \begin{shaded} \begin{theorem} }{ \end{theorem} \end{shaded} }

%Notar que primero hay que definir el color del sobreado con el comando
%"\colorlet{shadecolor}{color}" y luego hay que usar el environment "shaded". Adentro de este ponemos el environment que queremos, en nuestro caso queremos "pintar" el environment "\begin{theorem}".


%se puede cambiar la tonalidad de un color "yellow!80" es el color amarillo pero al 80%  y el 20% es mezclado con blanco, i.e. está aclarado. Pero "yellow!80!Black" es 80% amarillo y 20% negro, i.e. es obscurecido 20%.

\newenvironment{Definition}{\colorlet{shadecolor}{Apricot!12} \begin{shaded} \begin{definition} }{ \end{definition} \end{shaded} }

\newenvironment{Example}{\colorlet{shadecolor}{Goldenrod!16} \begin{shaded} \begin{example}}{ \end{example} \end{shaded}}

\newenvironment{Remark}{\colorlet{shadecolor}{Orchid!12} \begin{shaded} \begin{remark}}{ \end{remark} \end{shaded}}

\newenvironment{Warning}{\colorlet{shadecolor}{red!12} \begin{shaded} \begin{warning}}{ \end{warning} \end{shaded}}

\newenvironment{Conjecture}{\colorlet{shadecolor}{magenta!16} \begin{shaded} \begin{conjecture}}{ \end{conjecture} \end{shaded}}

\newenvironment{Theorem}{\colorlet{shadecolor}{OliveGreen!18} \begin{shaded} \begin{theorem}}{ \end{theorem} \end{shaded}}

\newenvironment{Lemma}{\colorlet{shadecolor}{LimeGreen!12} \begin{shaded} \begin{lemma}}{ \end{lemma} \end{shaded}}

\newenvironment{Proposition}{\colorlet{shadecolor}{Green!12} \begin{shaded} \begin{proposition}}{ \end{proposition}\end{shaded}}

\newenvironment{Corollary}{\colorlet{shadecolor}{TealBlue!16} \begin{shaded} \begin{corollary}}{ \end{corollary} \end{shaded}}

\newenvironment{Obs}{\colorlet{shadecolor}{Dandelion!22} \begin{shaded} \begin{obs}}{ \end{obs} \end{shaded}}

\newenvironment{Exercise}{\colorlet{shadecolor}{Lavender!12} \begin{shaded} \begin{exercise}}{ \end{exercise} \end{shaded}}

%%%%%COLORES%%%%%%%%%%%%
%Hay varios comandos del paquete Xcolor:
%\color{blue,green,red,yellow,orange,black,white,pink,purble,etc...} hace que todo el bloque de texto se transforme en este color, se puede encerrar entre {} el bloque de texto que uno quiere colorear
%\textcolor{color}{text} escribe el texto "text" en "color".
%\colorbox{color}{text} pinta un rectangulo de "color" detrás del "text".
%\shaded



%lista de colores base de xcolor, como son colores de la extension del paquetem, empiezan con la primera letra mayuscula: si usaramos solo el paquete {xcolor} entonces no sería necesario.

%red, Green (fluorecente), Blue (muy obscuro), Cyan, Magenta, Yellow, Black, Gray, lightgray, White, darkgray, lightgray, Brown, lime (este verde mas lindo manzana), olive (marron verdoso feo), Orange, pink, Purple, teal (verde marino), Violet

%marco los colores lindos: red, Cyan, Magenta, Yellow, Black, Gray, White,  lime, Orange, pink, teal, Violet

%Colores que incluye el paquete dvipsnames: Apricot (color beige), Brown, Goldenrod, JungleGreen, Salmon, Lavender, SpringGreen, Turquoise, Plum, Emerald, BurntOrange (naranja piola), ForestGreen (verde oscuro), BrickRed (rojo obscuro)


\newcommand{\red}[1]{\textcolor{BrickRed}{#1}}

			\newcommand{\comentario}[1]{\red{#1}}

\newcommand{\green}[1]{\textcolor{SpringGreen}{#1}}

\newcommand{\blue}[1]{\textcolor{Cyan}{#1}}

\newcommand{\darkblue}[1]{\textcolor{Cyan!70!Black}{#1}}

\newcommand{\yellow}[1]{\textcolor{yellow!80!Black}{#1}} %se puede cambiar la tonalidad de un color "yellow!80" es el color amarillo pero al 80%  y el 20% es mezclado con blanco, i.e. está aclarado. Pero "yellow!80!Black" es 80% amarillo y 20% negro, i.e. es obscurecido 20%.

\newcommand{\black}[1]{\textcolor{Black}{#1}}

\newcommand{\gray}[1]{\textcolor{Gray}{#1}}

\newcommand{\purple}[1]{\textcolor{Purple}{#1}}

\newcommand{\beige}[1]{\textcolor{Apricot}{#1}}

\newcommand{\darkgreen}[1]{\textcolor{ForestGreen}{#1}}

\newcommand{\pink}[1]{\textcolor{Lavender}{#1}}

\newcommand{\salmon}[1]{\textcolor{Salmon}{#1}}

\newcommand{\brown}[1]{\textcolor{RawSienna!50!Black}{#1}}

\newcommand{\white}[1]{\textcolor{White}{#1}}

\newcommand{\orange}[1]{\textcolor{BurntOrange}{#1}}













%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%grupos de matrices
%SL
\newcommand{\SL}[2]{\operatorname{SL}_{#1} ( #2)}
%GL
\newcommand{\GL}[2]{\operatorname{GL}_{#1} ( #2)}

%matriz identidad
\newcommand{\Id}{\operatorname{Id}}



%enteros Z
\newcommand{\integers}{\mathbb{Z}}
%racionales
\newcommand{\rationals}{\mathbb{Q}}
%naturales
\newcommand{\naturals}{\mathbb{N}}
%reales R
\newcommand{\reals}{\mathbb{R}}
%imaginarios
\newcommand{\complex}{\mathbb{C}}
%p-adicos
\newcommand{\padics}{\mathbb{Q}_p}
%enteros p-adicos
\newcommand{\padicintegers}{\mathbb{Z}_p}

%cuerpos finitos
%Fp
\newcommand{\Fp}{\mathbb{F}_p}
%Fq
\newcommand{\Fq}{\mathbb{F}_q}



%valor absoluto p-adico
\newcommand{\abs}[1]{\left \vert #1 \right \vert}
%valor absoluto p-adico
\newcommand{\Abs}[1]{\left \vert \left \vert #1 \right \vert \right \vert}
%valuacion p-adica
\newcommand{\val}[1]{\operatorname{val} (#1)}

%Hom
\newcommand{\Hom}{\operatorname{Hom}}

%imagen y núcleo
\newcommand{\Imagen}{\operatorname{Im}}
\newcommand{\Ker}{\operatorname{Ker}}

%coker
\newcommand{\Coker}{\operatorname{Coker}}

%limite inverso
\newcommand{\liminv}{\varprojlim}


%un poco de typeset para categorias
\newcommand{\catname}[1]{{\operatorfont\textbf{#1}}}


\renewcommand{\hat}[1]{\widehat{#1}}
\renewcommand{\bar}[1]{\overline{#1}}

%declaro un comando nuevo para escribir restricción de funciones
\newcommand\rest[2]{{% we make the whole thing an ordinary symbol
  \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
  #1 % the function
  \vphantom{\big|} % pretend it's a little taller at normal size
  \right|_{#2} % this is the delimiter
  }}


%%%%   COMANDO ALGEBRA CONMUTATIVA   %%%%

%altura de un ideal:
\newcommand{\height}{\textsc{height}}

%Clausura topológica
\newcommand{\closure}[1]{\overline{#1}}

%longitud de un A-modulo. Notacion: \length_A M
\newcommand{\length}{\operatorname{length}}

%Anulador de un $A$-módulo.
\newcommand{\Ann}[1]{\operatorname{Ann} (#1)}

%Cuerpo de fracciones. Notacion $\FracField A$.
\newcommand{\FracField}[1]{\operatorname{Fr} (#1)}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%






%%%%   COMANDO TEORÍA DE NÚMEROS  %%%%

%Discriminante
\newcommand{\discriminant}[1]{\mathfrak{d} (#1 )}

%%%%Ideales primos%%%
%escribe una letra en notación mathfrak, para denotar a un ideal o elemento primo.

\newcommand{\primo}[1]{\mathfrak{#1}}
\newcommand{\Primo}[1]{\mathfrak{\MakeUppercase{#1}}}

%anillo de enteros O_K
\renewcommand{\O}{\mathcal{O}}
%anillo de enteros con subindice de cuerpo (input, por ejemplo $K$).
\newcommand{\integralring}[1]{O_{#1}}

%caracteristica de un cuerpo Char k
\newcommand{\Char}[1]{\operatorname{Char} #1}

%traza. Notación \trace = Tr
\newcommand{\trace}{\operatorname{Tr}}

%Traza de extensiones. Notación \Tr L K \alpha = \operatorname{Tr}_{L/K} (\alpha)
\newcommand{\Tr}[1]{\operatorname{Tr}_{L/K} (#1)} %la extension es L/K por default
\newcommand{\tr}[3]{\operatorname{Tr}_{#1/#2} (#3)}

%Norma de extensiones. Notación \Norm L K \alpha = \operatorname{N}_{L/K} (\alpha)
\newcommand{\Norm}[1]{\operatorname{N}_{L/K} (#1)}%la extension es L/K por default
\newcommand{\norm}[3]{\operatorname{N}_{#1/#2} (#3)}


%discriminante de una forma bilineal simetrica. notacion \disc{B} = \operatorname{disc} ( B)
\newcommand{\disc}[1]{\operatorname{disc} (#1)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%COMANDO GRAFOS%%%%%%%%%%%%%

%\ceil funcion techo
\newcommand{\ceil}[1]{\left\lceil #1  \right\rceil}

%\floor funcion piso
\newcommand{\floor}[1]{\left\lfloor #1  \right\rfloor}

%diámetro de un grafo
\newcommand{\diam}[1]{\operatorname{diam} (#1)}

%radio de un grafo
\newcommand{\rad}[1]{\operatorname{rad}(#1)}

%Kappa: 
\newcommand{\Kappa}{\mathcal{K}}

%Defecto:
\newcommand{\defecto}[1]{\mathrm{df}(#1)}















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Creamos un ambiente para cada clase


\newcounter{numeroClase}%ponemos un contador que empieza en 0 y que cuenta el número de clase

%creamos una clase, i.e. ponemos un aseccion con el numero de clase y con un argumento obligatorio \Clase{argumento obligatorio} que es la fecha de la clase, por ejemplo 13/03/23.
\newenvironment{Clase}[1]{
	\stepcounter{numeroClase}
    \section{Clase \thenumeroClase: #1}
}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Cada dibujo se puede automatizar:
%1) necesitamos el archivo "Dibujo n.png" en la carpeta "Clase m", donde $n$ es el número del dibujo y $m$ es el número de la clase.

\newcounter{numeroDibujo}[numeroClase]

\renewcommand\thefigure{\thesection.\arabic{figure}}  

%el comando Dibujo tiene dos inputs \Dibujo{input 1}{input 2}, el primer input es [OPCIONAL] y representa el ancho del dibujo, y el segundo es el caption de la figura.
\NewDocumentCommand{\Dibujo}{O{0.8} m}{
\stepcounter{numeroDibujo}
\begin{center}
\includegraphics[width=#1\columnwidth]{"./Editor de Grafos/Figuras/Clase \thenumeroClase /Dibujo \thenumeroDibujo .pdf"}
\captionof{figure}{#2}
\end{center}
}


%el comando Inkscape tiene dos inputs \Inkscape{input 1}{input 2}, el primer input es [OPCIONAL] y representa el ancho del dibujo, y el segundo es el caption de la figura.
\NewDocumentCommand{\Inkscape}{O{1} m}{
\stepcounter{numeroDibujo}
\begin{center}
\def\svgwidth{#1\textwidth}
\input{"./Editor de Grafos/Figuras/Clase \thenumeroClase/Dibujo \thenumeroDibujo.pdf_tex"}
\captionof{figure}{#2}
\end{center}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Apuntes - GRAFOS}
\author{Enzo Giannotta}






\begin{document}

\maketitle

%--------------------------------- ACA VA LA TABLA DE CONTENIDOS

\tableofcontents

%---------------------------------

\chapter{Parte I: Introducción a grafos}


Bibliografia: \cite{diestelGraphTheory}.



\section*{Evaluaciones:}

\textbf{Nota:} sumativa significa examen.

\begin{enumerate}
\item Sumativa 1 : Lunes 24 abril. 30 porciento.
\item Sumativa 2: Lunes 22 mayo: 25 porciento.
\item Sumativa 3: Jueves 6 julio: 25 porciento.
\item Talleres (usualmente los viernes): 20 porciento (hay que trabajar y entregar lo que se hizo en el taller, te pueden hacer resolver en clase al azar el ejercicio al siguiente taller).
\end{enumerate}


%%%%%%%%%%%
\Clase{16/03/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%

\begin{Definition}
Un \textbf{Grafo} es un par ordenado $G = (V,E)$, donde $V$ es un conjunto de \textbf{vértices} y $E$ es un conjunto de \textbf{Aristas}. Es decir, las aristas son pares $(v_1,v_2)$ con $v_1,v_2 \in V$. En un prinicipio si el grafo \textbf{no es dirigido}, no importa el orden de los vértices que aparece en un par $(v_1,v_2)$.
\end{Definition}

La manera de visualizar un grafo es dibujar cada vértice y unir dos pares de vértices $v_1,v_2 \in V$ por un segmento que representa la arista $(v_1,v_2)$.

\begin{example}
Sea $V = \{ 1,2,3,4,5\}$ y $E = \{ \{1,3\} , \{3,4\} , \{ 5,4\} , \{4,1 \} , \{ 1,2\}\}$


\Dibujo{Dibujo del grafo $V$.}
\end{example}


\begin{definition}
Para un grafo $G = (W,R)$, denotamos por $V(G)$ a $W$ (los vértices) y por $E(G) = R$ (las aristas).

El número de vértices de $G$ se denota como $\abs G$ o $\abs{V(G)}$, y se llama \textbf{orden} de $G$. El número de aristas lo denotamos como $\Abs G$ o simplemente $\abs{E(G)}$. Un grafo con orden $1$ o $0$ se llama \textbf{trivial}.
\end{definition}

\begin{definition}
Si $v \in V(G)$ y $e \in E(G)$, y además $v \in e$, decimos que $v$ es \textbf{incidente} en $e$ y viceversa, i.e. $e$ es incidente en $v$. Los dos vértices que inciden en una arista son sus \textbf{extremos}.

Dos vértices $x,y$ son \textbf{adyacentes} o \textbf{vecinos} si $(x,y) \in E$ (Otra notación: $xy \in E$ donde $xy$ es la arista).
\end{definition}

\begin{obs}
Si mi grafo tiene $n$ vértices, entonces tiene a lo sumo $\binom n 2$ aristas. Luego, la cantidad de grafos que se pueden construir es $2^{\binom n 2}$.
\end{obs}

\begin{definition}
Si en un grafo todo par de vértices es adyacente, decimos que el grafo es \textbf{completo}.
Notamos: $K_n$ para todo $n \geq 1$, al grafo completo con $n$ vértices.
\end{definition}

\Dibujo{Ejemplo de grafos completos de orden $1,2,3$ y $5$.}

\begin{definition}
Si un par de vértices no es adyacente, decimos que son \textbf{independientes} o \textbf{estables}.

Si $V' \subset V(G)$ es tal que cada par de vértices en $V'$ es independiente, entonces decimos que $V'$ es \textbf{independiente}.
\end{definition}

\begin{definition}
Sean $G1 = (V1,E1)$ y $G2 = (V2, E2)$ grafos, decimos que $\varphi : V1 \rightarrow V2$ es un \textbf{isomorfismo} si para todo par de vértices $x,y \in V1$ se tiene que $xy \in E1 \Leftrightarrow \varphi (x) \varphi (y) \in E2$. 

Usualmente no hacemos distinciones entre dos grafos isomorfos. De hecho en ese caso escribimos $G1 = G2$.
\end{definition}


\Dibujo{Ejemplo de isomorfismo de grafos.}
En este ejemplo un isomorfismo válido entre $G1$ y $G2$ es
\begin{align*}
\varphi : 1 &\mapsto A \\
			2 &\mapsto B \\
			3 &\mapsto C \\
			4 &\mapsto D
\end{align*}


\begin{definition}
Definimos:
\begin{itemize}
\item $G \cup G' := (V \cup V', E \cup E')$
\item $G \cap G' := (V \cap V' , E \cap E')$
\end{itemize}
\end{definition}

\Dibujo{Ejemplo de unión e intersección de grafos.}

\begin{definition}
Si $G \cap G' = \emptyset$, decimos que son \textbf{disjuntos}.

Si $V' \subset V$ y $E' \subset E$, decimos que $G'$ es \textbf{subgrafo} de $G$, y que $G$ es \textbf{supergrafo} de $G'$. Notamos $G' \subset G$. Si $G'$ es subgrafo de $G$ pero $G \neq G$, decimos que $G'$ es \textbf{subgrafo propio} de $G'$ y análogamente decimois que $G$ \textbf{supergrafo propio} de $G'$; notamos $G' \subsetneq G$.
\end{definition}

\begin{definition}
Sea $G' \subset G$, tal que $G'$ contiene todas las aristas $xy \in E$ tal que $x,y \in V'$. Decimos que $G'$ es un \textbf{subgrafo inducido} de $G$.

En este caso diremos que $V'$ \textbf{induce} $G'$ en $G$, y escribimos $G' = G[V']$ para un subconjunto $V' \subset V$.
\end{definition}

\Dibujo{Ejemplo de grafo inducido y no inducido.}







%%%%%%%%%%%
\Clase{18/03/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%

\begin{definition}
Si $U \subset V(G)$, escribimos $G \setminus U$ para denotar $G[V \setminus U]$. Es decir, $G \setminus U$ se obtiene de borrar los vértices de $U$ y sus aristas incidentes.
\end{definition}

\Dibujo{Ejemplo de $G \setminus U$.}

\begin{definition}
El \textbf{complemento} $\bar G$ de un grafo $G$, es el grafo con vértices $V(G)$ y que tiene una arista $xy$ si y solo si $xy \not \in E(G)$.
\end{definition}

\Dibujo{Ejemplo de complemento.}

Notar que en el ejemplo de arriba, $G$ y $\bar G$ son isomorfos. Esto no pasa necesariamente, por ejemplo el complemento de un grafo completo es el grafo sin aristas.


\subsection{El grado de un vértice}
\begin{definition}
Sea $G$ un grafo no vacío, y sea $v \in V(G)$. El conjunto de vecinos de $v$ lo denotamos como $N (v)$ o si el contexto no es claro $N_G (v)$. Llamamos a este conjunto el \textbf{vecindario} de $v$.

Más en general, si $U \subset V(G)$, no vacío. El \textbf{vecindario} de $U$ es el subconjunto de vértices de $V(G) \setminus U$ que contiene vecinos de algún elemento de $U$. Notamos $N(U)$ o $N_G (U)$.
\end{definition}

\Dibujo[0.6]{Ejemplo de vecindario de $U = \{ 3,4\}$. Tenemos que $N(U) = \{0,2\}$.}

\begin{Definition}
El \textbf{grado} de un vértice $v \in V(G)$ es el número de aristas que inciden en $v$ y lo denotamos como $d (v)$ o $d_G (v)$. Notar que 
$$
d(v) = \abs{N(v)},
$$
porque no permitimos multigrafos.

Si $v$ tiene grado $0$, decimos que es \textbf{aislado}.
\end{Definition}

\begin{Definition}
Definimos la cantidad de $G$:
$$
\delta ( G) := \min_{v \in V(G)} \{ d(v) \}.
$$
Es el \textbf{grado mínimo} de $G$.

Análogamente, tenemos la cantidad $G$:
$$
\Delta (G) := \max_{v \in V(G)} \{ d(v) \}.
$$
Es el \textbf{grado máximo} de $G$.

En el caso que todos los vértices tienen el mismo grado, i.e. $\delta (G) = \Delta (G)$, decimos que $G$ tiene grado $k$ y que $G$ es \textbf{$k$-regular} o simplemente \textbf{regular}.
\end{Definition}

\begin{definition}
Definimos la cantidad del grafo $G$:
$$
d(G) := \frac{1}{\abs {V(G)}} \sum_{v \in V(G)} d(v) = \frac{1}{\abs {G}} \sum_{v \in V(G)} d(v) .
$$
Es el \textbf{grado promedio} de $G$.
\end{definition}

\begin{Obs}
$$
\sum_{v \in V(G)} d(v) = 2 \abs{E(G)} = 2 \Abs G.
$$
Con lo cual,
$$
\boxed{d(G) = 2 \frac{E(G)}{V(G)}= 2 \frac{\Abs G}{\abs G}.}
$$
\end{Obs}

\begin{Proposition}
El número de vértices de grado impar en un grafo siempre par.
\end{Proposition}
\begin{proof}
Por la observación anterior, $\sum_{v \in V(G)} d(v) = 2 \abs{G} \equiv 0 \mod 2$ con lo cual,
$$
\# \set{ v \in V(G) | d(v) \equiv 1 \mod 2 } = \sum_{v | d(v) \equiv 1 \mod 2} d(v) \equiv 0 \mod 2 .
$$
\end{proof}

\begin{proposition}\label{prop:ultima proposicion de la clase anterior a caminos y ciclos}
Para todo grafo $G$ con al menos una arista, existe un subgrafo $H$ tal que
$$
\delta (H) > \frac{\abs{E(H)}}{\abs{V(H)}} \geq \frac{\abs{E(G)}}{\abs{V(G)}}.
$$
\end{proposition}
\begin{proof}
En efecto, la idea es la siguiente: construimos una secuencia de grafos $G = G_0 \supset G_1 \supset \ldots$ de subgrafos inducidos, tales que si $G_i$ tiene un vértice de grado $d(v_i) \leq \frac{\abs{E(G_i)}}{\abs{V(G_i)}}$, entonces tomamos $G_{i+1} := G_i \setminus v_i$; si no, la secuencia termina en $H := G_i$.
Por la elección de $v_i$ se sigue que $\frac{\abs{E(G_{i+1})}}{\abs{V(G_{i+1})}} \geq \frac{\abs{E(G_i)}}{\abs{V(G_i)}}$, pues esto sucede si y solo si
\begin{align*}
\frac{\abs{E(G_i)}-d(v_i)}{\abs{V(G_i)}-1} & \geq \frac{\abs{E(G_i)}}{\abs{V(G_i)}} \\
\Leftrightarrow (\abs{E(G_i)}-d(v_i))\abs{V(G_i)} &\geq \abs{E(G_i)}(\abs{V(G_i)}-1) \\
\Leftrightarrow -d(v_i) \abs{V(G_i)} &\geq -\abs{E(G_i)} \\
\Leftrightarrow \frac{\abs{E(G_i)}}{\abs{V(G_i)}} &\geq d (v_i).
\end{align*}
En particular, $\frac{\abs{E(H)}}{\abs{V(H)}} \geq \frac{\abs{E(G)}}{\abs{V(G)}}$.

Afirmamos que $H$ tiene al menos una arista, de lo contrario $\frac{\abs{E(H)}}{\abs{V(H)}} = 0 < \frac{\abs{E(G)}}{\abs{V(G)}}$, por tener $G$ al menos una arista. En particular, $H \neq \emptyset$. Como $H$ es el mínimo de esta construcción, se tiene que $\delta (H) > \frac{\abs{E(H)}}{\abs{V(H)}}$.
\end{proof}

\subsection{Caminos y Ciclos}

\begin{Definition}
Un \textbf{camino} es un grafo no vacío $P = (V,E)$ de la forma
$$
V = \{ x_0,x_1,\ldots,x_k\}, \ k \geq 0.
$$
Con
$$
E = \{ x_0x_1, x_1x_2,\ldots,x_{k-1} x_k\}.
$$
Donde todos los $x_i$ son distintos.

Decimos que $\Abs G$, i.e. el número de aristas, es su \textbf{longitud}.

Usualmente denotamos al camino $P$ como la secuencia de vértices
$$
P = x_0 x_1 \ldots x_k.
$$
En este caso diremos que $P$ es un \textbf{camino entre} $x_0$ y $x_k$.
\end{Definition}

Notar que $\abs G = k+1$, y que $\Abs G = k$.

\Dibujo[0.9]{Dibujo de un camino de $k+1$ vértices.}



\begin{definition}
Sea $C$ un grafo que se construye a partir de un camino $P = x_0x_1\cdots x_k$ con $k \geq 1$, en donde agregamos la arista $x_kx_0$. Este grafo se llama \textbf{ciclo}. Notamos a esta construcción $C:= P + x_k x_0$ o $x_0 x_1 \ldots x_k x_0$.

La \textbf{longitud} de un ciclo es su número de aristas, es decir $\Abs C$.
\end{definition}
Notar que $\abs C = k$.


\begin{definition}
Sea $G$ un grafo. Definimos la \textbf{cintura} de $G$ como la mínima longitud $g(G)$ de un ciclo en $G$.

Definimos la \textbf{circunferencia} como la máxima longitud de un ciclo en $G$.
\end{definition}

Si $G$ no tiene ciclos, definimos $g(G):= \infty$ y circunferencia $0$.

\Dibujo[0.6]{Ejemplo de ciclos en un grafo de cinutra igual a $4$.}


\begin{definition}
Una arista que une a dos vértices de un ciclo $C$, pero que no pertenece a $E(C)$, se la llama \textbf{cuerda}.
\end{definition}

\Dibujo{Ejemplo de dos cuerdas de un ciclo $C$.}

\begin{Proposition}\label{proposition:todo grafo tiene un camino de largo >= delta y ciclo de largo >= delta +1}
Todo grafo $G$ contiene un camino de largo $\geq \delta (G)$. Más aún, si $\delta (G) \geq 2$, entonces también contiene un ciclo de largo $\geq \delta (G) + 1$.
\end{Proposition}
\begin{proof}
Sea $P = x_0x_1\ldots x_k$ un camino de largo $k$ máximo en $G$. El caso $k = 1$ es inmediato, luego supongamos que $k \geq 1$.

\Dibujo[0.9]{Camino $P$ de longitud maximal $k$. Imaginemos que $x_0 = 0$ y que $x_k = 8$ (no pude cambiar las etiquetas en sage math cuando grafique el grafo).}

Notar que por maximalidad de $P$, todos los vecinos de $x_k$ están en $V(P)$, de lo contrario habria un camino más largo. Con lo cual 
$$
\abs{V(P)} = k \geq d(x_k) + 1 \geq \delta (G) + 1 .
$$
Con lo cual, $\Abs P \geq \delta (G)$.

Ahora, sea $i <k$ el menor índice tal que $x_i x_k \in E(G)$. Como $\delta (G) \geq 2$, se sigue que $i < k-1$, i.e. $x_i$ y $x_k$ no son adyacentes, luego tomamos el ciclo $C = x_i x_{i+1} \ldots x_k x_i$. Notar que entonces la longitud de $\Abs C \geq \delta (x_k) + 1 \geq \delta (G) + 1$.
\end{proof}



%%%%%%%%%%%
\Clase{20/03/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%


\begin{Definition}
La \textbf{distancia} entre dos vértices $x,y$ de un grafo $G$, es la longitud de un camino con longitud mínima entre $x,y$, la notamos
$$
d(x,y).
$$
Si no hay un camino entre $x$ e $y$, escribimos
$$
d(x,y) = \infty.
$$

El \textbf{diámetro} de $G$ es el máximo de las distancias entre todos los pares de vértices, lo notamos
$$
\diam G .
$$
\end{Definition}

Notar que $d(x,y) = 0$ si y solo si $ x = y$.

\begin{definition}
El \textbf{radio} de un grafo $G$, denotado $\rad G$, es la cantidad
$$
\rad G = \min_{x \in V(G)} \max_{y \in V(G)} d (x,y).
$$

Decimos que un vértice $v \in V(G)$ es \textbf{central}, si
$$
\max_{y \in v(G)} d(v,y) = \rad G. 
$$
Es decir, $v$ minimiza la función $x \mapsto \max_{y \in V(G)} d(x,y)$.

\Dibujo{Ejemplo de vértice central es $3$ y tiene radio $4$. El grafo $G$ tiene diámetro $8$.}
\end{definition}

\begin{Exercise}[\textbf{Entrega de taller}]
Probar que
$$
\rad G \leq \diam G \leq 2 \rad G .
$$
\end{Exercise}
\begin{solution}
Si el grafo $G$ no es conexo, luego el radio y el diámetro son infinito, luego vale la desigualdad. En efecto, por un lado si $x \in V(G)$ está fijo, como $G$ no es conexo existe $y \in V(G)$ tal que $d (x,y) = \infty$, con lo cual $\max_{y \in V(G)} d(x,y) = \infty$ para $x$ fijo, luego si tomamos mínimo sobre los $x$ se tiene que $\rad G = \infty$. Por otro lado, $\diam G = \infty$ porque es el máximo sobre todas las distancias entre dos vértices, y como mencionamos recién, al no ser conexo el grafo tiene que haber una distancia infinita entre algún par de vértices.

Ahora supongamos que $G$ es conexo, es decir para todo par de vértices $x,y$ existe un camino $P_{xy}$ que los conecta, sin pérdida de generalidad supongamos que es el más corto, i.e. $d(x,y)$ es la longitud de $P_{xy}$. Se deduce que $d(x,y) \leq \diam G$ por definición de diámetro. Tomando máximo sobre $y$ y luego mínimo sobre $x$ se sigue por definición que
$$
\rad G \leq \diam G.
$$
Esto prueba la primera desigualdad. Ahora veamos la segunda.

Sea $o$ un vértice que minimice la función $x \mapsto \max_{y \in V(G)} d(x,y)$, es decir, $o$ es central. Ahora tomemos dos vértices arbitrarios $x,y$. Como $o$  minimiza la función anterior, tenemos que $d(x,o) \leq \rad G = \max_{z \in V(G)} d(o,z)$, es decir existe un camino de longitud $\leq \rad G$ que une $x$ con $o$. Análogamente, existe un camino de longitud $\leq \rad G$ que une $o$ con $y$. Concatenando ambos caminos obtenemos un camino entre $x$ e $y$ de longitud $\leq 2 \rad G$. Tomando máximo sobre $x,y$ obtenemos la otra desigualdad:
$$
\diam G \leq 2 \rad G.
$$
\end{solution}

Si queremos relacionar el radio o diámetro con el grafo mínimo, promedio o máximo debemos tener otros parámetros como intermediario. Por ejemplo, los caminos tienen grado mínimo $1$ pero pueden tener radio y diámetro arbitrariamente grandes. O podemos tener radio y diámetro arbitrariamente grande y grado mínimo arbitrario. Antes de dar un ejemplo, necesitamos la siguiente definición:

\begin{definition}
Sea $G$ un grafo, definimos $G^k$ como la \textbf{potencia} de $G$. Es el grafo que contiene los mismos vértices y
las aristas son las originales pero agregando a cada vértice $x$ una arista incidente con cada vértice $y$ a
distancia $ d(x,y) \leq k$.
\end{definition}

\Dibujo[0.6]{El camino $P : 0,1,2,\ldots,7$ dibujado en \black{negro}, le agregamos aristas para dibujar $P^3$. Las aristas rojas conectan nodos a distancia $2$ y las \blue{azules} $3$.}

Por ejemplo, todo camino de longitud $2n$ tiene $2n+1$ vértices, radio $n$, diámetro $2n$. Luego $P^k$ tiene misma cantidad de vértices (pero no aristas), mismo radio y diámetro, pero grado $k$ para todo $1 \leq k \leq 2n$.

Vamos a relacionar el radio y grado máximo a través de el número de vértices. Un grafo puede tener muchos vértices, por ejemplo si tiene radio alto, o si tiene grado máximo alto, 

\begin{proposition}
Sea $d \geq 3$. Un grafo $G$ con radio a lo más $k$ y grado máximo a lo más $d$. Entonces tiene menos que $\frac{d}{d-2} (d-1)^k$ vértices.
\end{proposition}
\begin{proof}
Sea $z$ un vértice central de $G$ y $D_i$ el conjunto de los vértices a distancia $i$ de $z$.

\Dibujo{$D_0$ son los \green{verdes}, $D_1$ los \yellow{amarillos}, y así...}

Tenemos que $\abs{D_0} =1, \abs{D_1} \leq \Delta \leq d$. Notar que cada vértice de $D_1$ tiene como vecino en $D_2$ a lo sumo $d - 1$ vértices, pues ya es vecino de $z$. En general, tenemos que
$$
\abs{D_{i+1}} \leq \abs{D_i} (d-1) , \quad i \geq 1 .
$$
Con lo cual 
$$
\abs{D_{i+1}} \leq \abs{D_1} (d-1)^i = d (d-1)^i , \quad i \geq 1 .
$$
Entonces
\begin{align*}
\abs{V(G)} = \sum_{i=0}^k \abs{D_i} &\leq 1 + d \sum_{i=0}^{k-1} (d - 1)^i \\
&= 1 + d (d-1)^k - 1 / d-2 \\
&< \frac{d}{d-2} (d-1)^k .
\end{align*}
\end{proof}

\begin{obs}
\begin{enumerate}[1.]
\item Cuando el radio es $k=1$, por ejemplo en un grafo estrella, la cantidad de vértices es asintóticamente igual a $\frac{d}{d-2} (d-1)^k$ cuando $d \rightarrow \infty$.

\Dibujo[0.6]{Ilustración del grafo estrella.}


\item La cota no es para nada óptima para grafos de potencia $P^k$ de caminos. Por ejemplo, si $P$ tiene $2n+1$ vértices, $k = n$ y $d = k \geq 3$. Luego en el mejor de los casos con $d = 3$, tenemos que
$$
\abs{P^k} = 2n+1 \ll 3 \cdot 2^n .
$$
O sea que la diferencia es exponencial.

\end{enumerate}
\end{obs}

Similarmente, podemos acotar el orden de $G$ por abajo, si es que podemos controlar inferiormente $\delta$ y $g$. Definamos la cantidad para $d \in \reals$ y $g \in \naturals$:
\[
    n_0(d,g):= \begin{cases}
                1 + d \sum_{i = 0}^{r-1} (d-1)^i & \text{ si $g = 2 r +1$ es impar,}\\
                2 \sum_{i=0}^{r-1} (d-1)^i & \text{ si $g = 2 r$ es par.}
                \end{cases}
\]

\begin{theorem}[Versión débil]\label{th:version debil del teorema de Alon, Hoory y Lineal en 2002}\footnote{La versión fuerte de este teorema, por Alon, Hoory and Linial, 2002, dice que
 si $d(G) \geq d \geq 2$ y $g(G) \geq g \in \naturals$, entonces $\abs G \geq n_0 (d,g)$.}
Sea $G$ un grafo con $\delta (G) \geq d \geq 2$ y $g(G) \geq g \in \naturals$. Entonces
\[
    \abs G \geq n_0 (d,g).
\]
En particular, $\abs G \geq n_0 ( d(G)/2, g)$.
\end{theorem}
\begin{proof}
Notar que la función es creciente en ambas variables para todo $d \geq 2$ y $g \in \naturals$. Con lo cual, basta
probar la afirmación para $d = \delta(G)$ y $g = g(G)$.

Sea $v$ un vértice de un ciclo $C$ de largo mínimo, i.e. $\geq g$. Consideremos como $D_i$ al conjunto de vértices a distancia $i$ de $v$ en $G$. Como antes, $\abs {D_0} = 1$, para cada vértice de $D_{i+1}$ tiene un vecino en $D_{i}$ si $i>0$; como cada vértice de $D_i$ tiene un vecino en $D_{i-1}$, se sigue que $\abs{D_{i+1}}  \geq (d-1) \abs{D_i}$ si $i < r$, ya que de lo contrario existiría un ciclo de longitud más chica que $r$.
Reiterando recursivamente esta igualdad, se sigue que $\abs{D_{i+1}} \geq (d-1)^i \abs{D_1}$ para todo $i < r$

Luego como
$$
G = \sqcup_{i} D_i \supset \sqcup_{0\leq i\leq r} D_i,
$$
se sigue que
\begin{enumerate}
\item[Caso $g = 2 r +1$]
$$
\abs G \geq \sum_{0 \leq i \leq r} \abs{D_i} =  1 + \sum_{i=0}^{r-1} \abs{D_{i+1}} \geq 1 + \sum_{i=0}^{r-1} (d-1)^i \abs{D_1} \geq 1 + \sum_{i=0}^{r-1} (d-1)^i d.$$

\item[Caso $g = 2 r$] Analogo.
\end{enumerate}

La última afirmación vale, pues sea $d = d(G)/2 = \epsilon (G)$, luego por la Proposición \ref{prop:ultima proposicion de la clase anterior a caminos y ciclos}, existe un subgrafo $H$ de $G$ tal que $\delta (G) > d$, y por lo tanto aplicando este teorema a $H$ se tiene que $\abs G \geq \abs H \geq n_0 (\delta(H),g(H))$, pero como $\delta (H) > d$ y $g(H) \geq g(G) = g$, y $n_0$ es creciente en ambas variables, se sigue que $\abs G \geq n_0 (d,g)$.

\end{proof}
\begin{corollary}\label{corolario:si delta(G) geq 3, entonces g(G) < 2 log_2 abs G}
Si $\delta(G) \geq 3$, entonces $g(G) < 2 \log_2 \abs G$.
\end{corollary}
\begin{proof}
Tomamos $g = g(G)$. Si es par, entonces
$$
n_0(3,g) = 2 \frac{2^{g/2}-1}{2  - 1} = 2^{g/2} +(2^{g/2}-2) > 2^{g/2}.
$$
Si $g$ es impar, entonces
$$
n_0(3,g) = 1 + 3 \frac{2^{(g-1)/2}-1}{2-1} = \frac{3}{\sqrt 2} 2^{g/2} - 2 > 2^{g/2}.
$$
Luego por el teorema anterior el resultado se sigue luego de tomar logarítmo en base $2$.
\end{proof}

\begin{proposition}
Todo grafo $G$ que contiene al menos un ciclo, satisface
$$
g(G) \leq 2 \diam G +1.
$$
\end{proposition}
\begin{proof}
Supongamos que no. Es decir, si $C$ es el ciclo de $G$ con menor longitud, se tiene que $\Abs C = g(G) \geq 2 \diam
G+2$. Es decir, existen dos vértices de $C$, digamos $x,y$ tales que su distancia en $C$ es mayor o igual a $\diam G +1$. En $G$, estos vértices están a distancia menor que $\diam G+1$, sea $P$ el camino mas corto en $G$ que une a $x,y$ (i.e. tiene longitud $< \diam G +1$), luego $P$ no es subgrafo de $G$. Con lo cual, existe un subcamino de $P$ que es un $C$-camino; luego este camino unión el $x-y$ camino más corto de $C$ es un ciclo de longitud más chica que la de $C$, absurdo.
\end{proof}

\subsection{Conexidad}

\begin{Definition}
Un grafo es \textbf{conexo} si es no vacío y para todo par de vértices, existe un camino que los une a ambos.
\end{Definition}

\begin{Proposition}\label{prop: todo grafo conexo se puede enumerar de manera que G_i[v1,...,vi] es conexo para todo i}
Los vértices de un grafo conexo $G$ se pueden enumerar, digamos $v_1,v_2,\ldots,v_n$ tal que $G_i = G[v_1,v_2,\ldots,v_i]$ es conexo para todo $i = 1,\ldots ,n$.
\end{Proposition}

\begin{proof}
Probaremos la proposición por inducción en $n$. Sea $v$ arbitrario, y asumamos por inducción que $v_1,\ldots,v_i$ han sido escogidos para $i < \abs{V(G)}$ y que $G_i$ es conexo 

Escojo un vértice $v$ no enumerado aún. Como $G$ es conexo existe un camino $P$ entre $v_1$ y $v$.

\Dibujo[0.7]{Camino $P$ que une a $v$ y $v_1$. En color \blue{azul} representa los vértice de $G_i$ en $P$.}

Tomamos como $v_{i+1}$ al último vértice en $P$, contado desde $v$, que no está en $G_i$. Como $v_{i+1}$ tiene vecino en $G_i$ y $G_i$ es conexo se tiene que $G_{i+1}$ es conexo.

\end{proof}

\begin{example}
El siguiente dibujo es un mal ejemplo:

\Dibujo{Mal ejemplo, pues \gray{$0$ y $2$} no inducen un grafo conexo $G[0,2]$.}
\end{example}








%%%%%%%%%%%
\Clase{23/03/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%

\begin{definition}[Maximalidad]
Consideremos una propiedad $P$, para para algún grafo, conjunto de vértices, etc. Decimos que un conjunto de vértices $U$ es maximal para $P$, si $U$ cumple $P$, y $U \cup \{v\}$ con $v \not \in U$ no cumple $P$.
\end{definition}

\Dibujo{Ejemplo de camino maximal: $0,1,2,3,5,6,7,8$. Sin embargo, $5,7,8$ no lo es.}


\begin{definition}
Sea $G = (V,E)$ un grafo. Un subgrafo conexo maximal de $G$ es llamado una \textbf{componente} o \textbf{componente conexa} de $G$.
\end{definition}

\Dibujo{Ejemplo de componentes: tiene $3$.}


\begin{notation}
Sea $G= (V,E)$ un grafo. Vamos a notar a la cantidad de arisstas por vértice como la cantidad:
\[
    \epsilon ( G) = \frac{\abs E}{\abs V}.
\]
\end{notation}

\begin{theorem}
Sea $k \in \naturals$. Todo grafo $G$ con $d(G) \geq 4 k$ tiene un subgrafo $H$ que es $(k-1)$-conexo tal que $\epsilon (H) > \epsilon (G) -k$.
\end{theorem}
\begin{proof}
Notemos por $\gamma = \epsilon (G)$; como $\gamma = \frac 1 2 d(G)$, tenemos que $\gamma \geq 2 k$. Consideremos los subgrafos $G' \subset G$ tales que
\[
    \abs{G'} \geq 2k \quad \text{y} \quad \Abs{G'}> \gamma ( \abs{G'}-k);
\]
esta familia es no vacía, pues $G$ cumple esta condición; notemos por $H$ al subgrafo de menor orden que cumple esta condición.
En efecto, $G$ cumple ambas condiciones, pues por un lado $\Abs G > \gamma (\abs G - k) = \Abs G - \gamma k$, y por otro lado
$$
\Delta (G) \geq d(G) \geq 4k,
$$
con lo cual existe un vértice de $G$ de grado máximo, con al menos $4k$ vecinos, es decir $\abs G \geq 4k +1 \geq 2k$.

Notar que ningún grafo $G'$ que cumpla la condición tiene orden exactamente $2k$, ya que esto implicaría que $\Abs {G'} > \gamma k \geq 2k^2 > \binom{\abs {G'}}{2} = k(2k-1)$, lo cual contradice la cantidad máxima de aristas que puede tener un grafo de $\abs{G'}$ vértices.
Por minimalidad de $H$, se tiene que $\delta (H) > \gamma$: de lo contrario podríamos eliminar un vértice de grado a lo más $\gamma$ y obtener un grafo $G' \subsetneq H$ que satisface la condición. En particular, como existe un vértice de grado $> \gamma$, se sigue que $\abs H \geq \gamma$. Ddividiendo la desigualdad $\Abs H > \gamma \abs H - \gamma k$ de la c ondición por $\abs H$, tenemos que $\epsilon (H) > \gamma - k$, como queríamos.

Falta ver que $H$ es efectivamente $(k+1)$-conexo. De lo contrario, $H$ tendría una separación propia $\{U_1, U_2\}$ de orden a lo más $k$; escribamos $H[U_i] =: H_i$. Como todo vértice $v \in U_1 \setminus U_{2}$ tiene $d(v) \geq \delta (H) > \gamma$ vecínos de $H$ en $H_1$, tenemos que $\abs{H_1}\geq \gamma \geq 2k$. Similarmente, $\abs{H_2} \geq 2k$. Por la minimalidad de $H$, ninguno de los $H_1,H_2$ puede satisfaced la condición, con lo cual
\[
    \Abs {H_i} \leq \gamma (\abs{H_i}-k), \quad i = 1,2.
\]
Sin embargo, tenemos que
\begin{align*}
\Abs H &\leq \Abs {H_1} + \Abs{H_2} \\
    &\leq \gamma (\abs {H_1} + \abs{H_2} -2k) = \gamma (\abs{H}+ \abs{H_1 \cap H_2}-2k) \\
    &\leq \gamma (\abs H - k) \quad (\text{pues $\abs{H_1\cap H_2} \leq k$}),
\end{align*}
contradiciendo la condición.
\end{proof}





\subsection{Árboles y bosques}

\begin{Definition}
Un grafo acíclico, es decir, sin ciclos, es llamado un \textbf{bosque}.

A un bosque conexo lo llamamos \textbf{árbol}, es decir un grafo conexo y acíclico.

Los vértices de grado $1$ son sus \textbf{hojas}, los otros vértices son sus \textbf{vértices interiores}.
\end{Definition}
Notar que las componentes conexas de un bosque son árboles.

\begin{obs}
Los subgrafos conexos de un árbol son árboles.
\end{obs}

\Dibujo{Un \brown{árbol} con \darkgreen{hojas} y \green{vértices interiores}.}



\begin{exercise}
Todo árbol tiene al menos $1$ hoja. Más aún, si el árbol tiene más de un vértice entonces tiene al menos $2$ hojas. En particular los árboles tienen grado mínimo $\delta = 1$.
\end{exercise}
\begin{solution}
Sea $P$ un camino maximal en el árbol, y miro uno de los extremos (podría haber solo uno si el camino tiene un solo vértice). Ese extremo si tuviera grado $\geq 2$, el otro vecino debería caer en el camino por maximalidad, luego existe un ciclo, absurdo!. Más aún, si el árbol tiene más de un vértice entonces el camino maximal que tomamos tiene dos vértices, i.e. dos hojas.
\end{solution}

Esto implica lo mismo para caminos, pues los caminos son árboles.

\begin{Theorem}
Sea $T$ un grafo. Las siguientes definiciones son equivalentes:
\begin{enumerate}[(i)]
\item $T$ es árbol.
\item Cada par de vértices en $T$ están unidos por un único camino.
\item $T$ es conexo, pero $T \setminus e$ es disconexo para todo $e \in E(T)$. Es decir, es minimalmente conexo.
\item $T$ es conexo, pero $T \setminus v$ es disconexo para todo $v \in V(T)$ que no sea hoja.
\item $T$ es acíclico, pero $T \cup xy$ tiene un ciclo para cualquier par de vértices $x,y$ no adyacentes. Es decir, es maximalmente acíclico.
\end{enumerate}
\end{Theorem}
\begin{proof}
\begin{enumerate}
\item[]

\item[(i) $\Rightarrow$ (ii)] Si no, existe al menos un camino por ser conexo, luego si hay dos caminos distintos entonces podemos construir un ciclo.

\item[(ii) $\Rightarrow$ (iii)] Sea $e$ una arista entre $xy$, entonces $xy$ es un camino entre esos vértices, por hipótesis es el único, luego al quitarlo debe quedar disconexo, de lo contrario es que había otro camino.

\item[(iii) $\Rightarrow$ (iv)] Como $v$ no es una hoja, es vecino de al menos dos vértices distintos, dicamos $a,b$. Si todo camino entre $a$ y $b$ pasa por $v$, entonces quitar este vértice haría que $T$ fuera disconexo. Supongamos que existe un camino que une $a,b$ pero que no contiene a $v$. Luego si quitamos la arista $av$ o $vb$ el grafo sigue siendo conexo, pues tenemos un ciclo $a v b$, absurdo.

\item[(iv) $\Rightarrow$ (v)] $T$ es acíclico, pues de lo contrario podríamos podríamos quitar un vértice y que siga quedando conexo. En efeco, sea $C$ un ciclo en $T$, digamos con vértices $x_0,x_1,\ldots,x_n,x_0$ y $n \geq 2$. Si quitamos cualquier vértice $v$ de $C$, este queda conexo, pero veamos que $T$ también. De lo contrario, es que $v$ separa a $T$ en dos componentes conexas, es decir, todos los caminos entre $C$ y $T \setminus C$ pasan por $v$, con lo cual tomando otro vértice de $C$ que no sea $v$ y quitándolo, nos quedaría que $T$ menos ese punto ex conexo, absurdo.

Sean $x,y$ no adyacentes. Consideremos $P$ un camino entre $x,y$. Como no son adyacentes este camino necesariamente tiene al menos un vértice en intermedio, digamos $z$. Por hipótesis, si quitamos $z$ el grafo nos queda disconexo, y esto lo podemos hacer para cualquier $z \neq x,y$ en $P$. Con lo cual, $P \cup xy$ es un ciclo en $T \cup xy$.

\item[(v) $\Rightarrow$ (i)] Por hipótesis, $T$ es acíclico. Sean $x,y \in V(G)$. Por hipótesis tenemos que $T \cup xy$ tiene un cíclo $C_{xy}$, luego $C_{xy}$ debe contener la arista $xy$ pues $T$ es acíclico. Entonces $C_{xy} \setminus xy$ conecta a $xy$. Como $x,y$ eran arbitrarios, tenemos que $T$ es conexo.
\end{enumerate}
\end{proof}

\begin{definition}
Sea $G$ un grafo. Un \textbf{árbol generador} de $G$ es un subgrafo de $G$ que es árbol y que contiene a todos los vértices de $G$.
\end{definition}

\Dibujo[0.35]{Ejemplo: árbol generador, con aristas en \red{rojo}.}

\begin{obs}
Del dibujo anterior podemos ver que el árbol generador no necesariamente es único, y de hecho, puede haber otro que no sea isomorfo. Por ejemplo cambiemos los vértices del árbol en \red{rojo}, de manera que ya no tenga vértices de grado $3$:
\Dibujo[0.20]{Otro árbol generador.}
\end{obs}

\begin{proposition}
Todo grafo conexo tiene un árbol generador.
\end{proposition}
\begin{proof}
Tomemos un subgrafo minimalmente conexo $H$, que contenga a todo $V(G)$. Por (iii) del teorema anterior tenemos que $H$ es un árbol. También se puede usar el ítem (v), aplicado a un subgrafo acíclico maximal.
\end{proof}

\begin{obs}
Esta demostración nos da un álgoritmo para construir el árbol generador de un grafo: quitamos aristas hasta que nos quede minimalmente conexo.
\end{obs}

\begin{definition}
Si $T$ es un árbol generador de un grafo $G$, las aristas en $E(G) \setminus E(T)$ son las \textbf{cuerdas} de $T$ en $G$.
\end{definition}

\begin{Proposition}
Los vértices de un árbol $T$ pueden ser enumerados, digamos $v_1,v_2,\ldots,v_n$ de manera que para todo $i \geq 2$, $v_i$ es hoja en $T[v_1,\ldots,v_i]$ (que es árbol también).
\end{Proposition}
\begin{proof}
Por la Proposición \ref{prop: todo grafo conexo se puede enumerar de manera que G_i[v1,...,vi] es conexo para todo i} existe una enumeración $v_1,\ldots,v_n$ tal que $T[v_1,\ldots,v_i]$ es conexo para todo $i \geq 1$. Inspeccionando la demostración, se puede ver que esta construcción sirve. En efecto, sabemos que $v_{i+1}$ tiene un vecino en $G[v_1,\ldots,v_i]$, llamemosló $x$, si tuviera otro llamado $y$, entonces $G[v_1,\ldots,v_i]$ contiene un camino $P_{xy}$ entre ellos, que junto con $x v_{i+1} y$ nos forma un cíclo, absurdo.

\Dibujo{Ver dibujo.}
\end{proof}








%%%%%%%%%%%
\Clase{27/03/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%


\begin{corollary}
Un grafo de $n$ vértices conexo es un árbol si y solo si tiene $n-1$ aristas.
\end{corollary}
\begin{proof}
\begin{enumerate}
\item[$\Rightarrow$)] Supongamos que $T$ es árbol; en particular es conexo. Por la proposición anterior, existe una enumeración $v_1,v_2,\ldots,v_n$ tal que para todo $i \geq 1$, el grafo $T[v_1,\ldots, v_i]$ tiene $i-1$ aristas por inducción.

\item[$\Leftarrow$)] Como $T$ es conexo tiene árbol generador $T'$, y por la implicación anterior tiene $n-1$ aristas, entonces $T = T'$, i.e. $T$ es árbol.
\end{enumerate}
\end{proof}

\begin{corollary}
Todo grafo conexo de $n$ vértices tiene al menos $n-1$ aristas.
\end{corollary}
\begin{proof}
Tiene un árbol generador, que debe tener $n-1$ aristas.
\end{proof}

\begin{corollary}
Si $T$ es un arbol y $G$ es un grafo con $\delta (G) \geq \abs T -1$, entonces $T \subset G$, es decir $G$ tiene un subgrafo isomorfo a $T$.
\end{corollary}
\begin{proof}
Sea $v_1,\ldots,v_n$ con $n = \abs T$, una numeración de los vértices de $T$ tal que $v_i, i \geq 2$ es una hoja de $T[v_1,\ldots,v_{i-1}]$. Haremos inducción en estos vértices. El caso base es trivial. Veamos el paso inductivo: supongamos que $G$ tiene a $T[v_1,\ldots,v_{i-1}]$ como subgrafo con $i\leq n$, entonces como $\delta (G) \geq n-1$, tenemos que $v_j, 1 \leq j \leq i-1$ (el único vecino de $v_i$) tiene al menos $\delta(G) \geq n-1$ vecinos en $G$, es decir, tiene un vecino que no está en $T[v_1,\ldots, v_{i-1}]$, luego agregamos a ese vértice como $v_i$ junto con la arista que le corresponde a $v_j$.
\end{proof}

\bigskip

De véz en cuando, es útil fijar un vértice $r$ de un árbol $T$, que llamaremos \textbf{raíz}. Un árbol con una raíz fija, se denomina \textbf{árbol enraigado} (o en inglés, \textbf{rooted tree}).
Recordemos que para todo $y \in V(T)$, existe un único camino entre $r$ e $y$ que denotaremos $rTy$; esto induce un orden parcial $x \leq y$ si y solo si $x \in r T y$. Este orden en $V(T)$ se lo llama el \textbf{orden del árbol} asosciado a $T$ y $r$. Definimos los conjuntos:
\[
    \ceil y := \Set{x | x \leq y} \quad \text{y} \quad \floor x := \Set{ y | y \geq x}
\]
la \textbf{clausura inferior} de $y$, y la \textbf{clausura superior} de $x$, respectivamente. En general, definimos $\ceil X := \bigcup_{x \in X} \ceil x $ y análogamente $\floor X$, para un conjunto $X \subset V(T)$. Un conjunto $X$ que coincide con $\ceil X$, se dice \textbf{cerrado inferiormente}, análogamente en el otro caso tenemos que es \textbf{cerrado superiormente}.

Notar que $r$ es el \textit{mínimo} en este orden, y todas las hojas de $T$ son \textit{maximales}. Los extremos de
una arista son siempre comparables entre sí, y los elementos de una clausura inferior forman una \textit{cadena} (i.e
. son comparables entre sí), sin embargo los elementos de una clausura superior no tienen por qué formar una cadena.
Decimos
que los
vértice a
distancia $k$ de $r$
tienen \textbf{altura} $
k$ y el
conjunto de estos vértices forma el $k$-ésimo \textbf{nivel} de $T$.

Un árbol enraigado $T$ contenido en un grafo $G$ se dice \textbf{normal} en $G$, si los extremos de todo $T$-camino en $G$ son comparables en el orden de $T$. Si $T$ genera $G$, esto equivale a pedir que dos vértices de $T$ sean comparables siempre que sean adyacentes en $G$; ver la siguiente figura:

\Dibujo{Un \brown{árbol} generador normal con raíz \darkgreen{r} de un grafo $G$.}

Un arbol normal puede ser una herramienta realmente útil para examinar la estructura de su grafo subyacente, ya que este grafo refleja las propiedades de separación de $T$:

\begin{lemma}
Sea $T$ un árbol normal en $G$. Tenemos que:
\begin{enumerate}[(i)]
\item Dados $x,y \in V(T)$, están separados en $G$ por el conjunto $\ceil x \cap \ceil y$.
\item Supongamos que $T$ genera $G$. Si $S \subset V(T) = V(G)$ y $S$ es inferiormente cerrado, luego las componentes conexas de $G \setminus S$ están generadas por los conjuntos $\floor x$ con $x$ minimal en $T \setminus S$.
\end{enumerate}
\end{lemma}
\begin{proof}
\begin{enumerate}[(i)]
\item Sea $P$ cualquier camino entre $x,y$ en $G$; veamos que $P$ interseca $\ceil x \cap \ceil y$. Sea $t_1,\ldots,t_n$ una sucesión de vértices en $P \cap T$, minimal con la propiedad que $t_1 = x$ y $t_n = y$ y $t_i,t_{i+1}$ son comparables en el orden del árbol $T$ para todo $i$. Dicha sucesión existe, pues el conjunto de todos los vértices en $P \cap T$, con el orden natural inducido por $P$, tiene esta propiedad, ya que como $T$ es normal todo segmento $t_i P t_{i+1}$ es una arista de $T$ o un $T$-camino. En nuestra secuencia minimal no podemos tener $t_{i-1}< t_i > t_{i+1}$ para ningún $i$, pues $t_{i-1},t_{i+1}$ son comparables y podríamos eliminar a $t_i$ de nuestra secuencia, obteniendo así una secuencia más chica. Entonces nuestra secuencia tiene la forma
\[
    x = t_1 > \ldots > t_k < \ldots < t_n = y
\]
(se podrían retirar los elementos en el ''medio''). Así, $t_k \in \ceil x \cap \ceil y \cap V(P)$.
\item Consideremos una componente $C$ de $G \setminus S$, y tomemos $x$ un elemento minimal ($T$ genera $G$) de $V(G)$. Afirmamos que $x$ es único, en efecto, si $x'$ fuera otro, ambos serian no comparables entre sí, pero por el ítem (i), cualquier camino entre $x,x'$ contiene un vértice más chico que ambos, contradiciendo minimalidad en $C$. Por lo tanto todo vértice de $C$ yace arriba de $x$: nuevamente por el ítem (i) hay un vértice debajo de ambos que por minimalidad es $x$. Recíproccamente, todo vértice $y \in \floor x$ está en $C$, pues como $S$ es cerrado inferiormente, el camino creciente $x T y$ yace en $T\setminus S$. Consecuentemente, $V(C)= \floor x$.

Ahora veamos que $x$ es minimal no solo en $V(C)$, sino también en $T \setminus S$. Los vérticces por debajo de $x$ forman una cadena $\ceil t$ en $T$. Como $t$ es vecino de $x$ en $T$, la maximalidad de $C$ como componente conexa de $G \setminus S$ implica que $t \in S$, y por lo tanto $\ceil t \subset S$ porque $S$ es cerrado inferiormente. Esto completa la demostración de que toda componente de $G\setminus S$ está generada por un conjunto $\floor x$ con $x$ minimal en $T \setminus S$.

Recíprocamente, si $x$ es un elemento minimal en $T \setminus S$, claramente también es minimal en la componente $C$ de $G \setminus S$ que lo contiene. Eso significa que $V(C) = \floor x$.
\end{enumerate}
\end{proof}


\begin{proposition}
Sea $G$ un grafo conexo y $r \in V(G)$ arbitrario. Entonces existe un árbol generador normal $T_r$ de $G$, con el orden
inducido
por $r$.
\end{proposition}
\begin{proof}
Sea $G$ un grafo conexo y $r \in G$ un vértice fijo. Sea $T$ un árbol normal maximal con raíz $r$, veamos que $V(T) = V(G)$, i.e. genera $G$..

Supongamos por el absurdo que no, y sea $C$ una componente conexa de $G \setminus T$. Como $T$ es normal, la vecindad $N_G (C)$ (que está contenida en $T$) es una cadena en $T$, obviamente porque $C$ permite construir $T$-caminos entre cualquier par de vértices de $N_G(C)$. Sea $x$ su máximo elemento (recordemos que estamos en una cadena), y sea $y \in C$ adyacente a $x$. Sea $T'$ el arbol obtenido de $T$ agregando la arista $yx$; el orden de árbol de $T'$ extiende al de $T$. Veamos que $T'$ también es normal en $G$, contradiciendo maximalida.

Sea $P$ un $T'$-camino en $G$. Si sus extremos están en $T$, luego son comparables con el orden de $T$, y por lo tanto por el de $T'$ también, ya que $P$ es un $T$-camino también porque $T \subset T'$ y $T$ es normal. Si alguno de los extremos de $P$ fuera $y$, tenemos que $P \subset C$ salvo por su otro extremo $z$, que yace en $N_G(C)$. Como $x$ era máximo, tenemos que $z \leq x$. Luego $z,y$ serán comparables si vemos que $x < y$, es decir que $x \in r T' y$. Lo cual es claro ya que $y$ es una hoja de $T'$ con vecinon $x$.
\end{proof}




\subsection{Grafos bipartitos}

\begin{Definition}
Sea $r \geq 2$ entero. Decimos que un grafo $G = (V,E)$ es \textbf{$r$-partito} si podemos particionar a $V$ en $r$ partes tal que cada arista tiene sus extremos en partes distintas. Es decir, cada parte es un conjunto independiente.

$2$-partito es \textbf{bipartito}, $3$-partito es \textbf{tripartito}, etc.
\end{Definition}

\Dibujo[0.20]{Ejemplo de grafo $3$-partito, $4$-partito y $5$-partito, pero no $2$-partito porque siempre existirian dos vértices del triangulo \yellow{amarillo} en la misma partición, pero eso es imposible porque son adyacentes. Se ilustran dos triparticiones distintas: $A,B,C$ y por otro lado \red{rojo}, \blue{azul}, \green{verde}.}

\Dibujo[0.6]{Ejemplo de grafo $2$-partito.}

\begin{definition}
Un grafo $r$-partito $G$, donde cada par de vértices de partes distintas son adyacentes, decimos que $G$ es \textbf{$r$-partito completo}.

Un grafo $r$-partito completo con partes de tamaño $n_1,n_2,\ldots, n_r$ se denota $K_{n_1,n_2,\ldots, n_r}$.

\Dibujo[0.6]{Ejemplo de grafo $3$-partito completo.}
\end{definition}

\begin{obs}
Un grafo $K_{1,n}$ es una \textit{estrella}.

\Dibujo[0.60]{$K_{1,5}$}
\end{obs}

\begin{obs}
Si $G$ es bipartito, entonces no tiene ciclos impares.
\end{obs}
\begin{proof}
Sea $C=C_{2k+1}$ con $k \geq 1$ un subciclo de longitud $2k+1$ de $G$. Si $G$ fuera bipartito, entonces $C$ también. En efecto, numerando $C : x_0, x_1, \ldots, x_{2k} , x_0$, ser bipartito equivale a que existe una función $\rho : x_i \mapsto 0, 1 \in \{ 0 , 1 \}$ tal que $\rho (x) \neq \rho (y)$ para todo par de vértices adyacentes $x,y \in C$. Sin pérdida de generalidad $\rho (x_0 ) = 0$. Pero como $x_i$ y $x_{i+1}$ son siempre adyacentes, debe ser que $\rho (x_0 ) =  0 , \rho (x_1) = 1 , \ldots , \rho (x_i) = i \mod 2$ (lo podemos probar recursivamente). Con lo cual, $\rho ( x_{2k}) = 0 = \rho ( x_0)$, lo cual es absurdo porque $x_{2k}$ y $x_0$ son adyacentes.
\end{proof}


\Dibujo{Como se ilustra en el dibujo, no podemos $2$-particionar a $C_7,C_5$ ni $C_3$. Pues siempre que pintamos con dos colores quedan dos vértices adyacentes.}

\begin{Theorem}
Un grafo es bipartito si y solo si no tiene ciclos impares.
\end{Theorem}
\begin{proof}
La observación anterior prueba la necesidad. Veamos la suficiencia. Sea $G$ un grafo sin ciclos impares. Podemos asumir sin pérdida de generalidad que es conexo. Sea $T$ un árbol generador, $r$ un vértice de $G$ que llamaremos raíz (de $T$). Para $v \in V(G)$ denotamos por $rTv$ al único camino entre $r$ y $v$ en $T$ (por la caracterización de árboles). Por último, si $w,v \in V(G)$, entonces decimos que $w \leq v$, si $w \in rTv$.

Definimos la partición de $G$: los vértices $v$ tales que $rTv$ tiene largo par, y por otro lado los vértices $v$ tales que $rTv$ tiene largo impar. Veamos que en efecto esto es una partición, i.e., no hay vértices adyacentes en la misma partición. Sea $e = xy$ una arista de $G$.
\begin{enumerate}
\item[]

\item[\textsc{Caso 1:}] Si $e \in E(T)$, tendremos $x < y$ o $y < x$, pero nunca igualdad. Más aún, $\Abs{rTx} = \Abs{rTy} \pm 1$, i.e. tienen paridades distintas.

\item[\textsc{Caso 2:}]  Si $e \not \in E(T)$, entonces $rTx, rTy$ y $e$ forman un ciclo (por la caracterización de árbol). Por la hipótesis, el ciclo es par. Esto implica que $\Abs{rTx}$ y $\Abs{rTy}$ tienen distinta paridad:

\Dibujo[0.7]{Ilustración de este hecho.}
\end{enumerate}
\end{proof}

\begin{corollary}
Los árboles y los bosques son bipartitos.
\end{corollary}


\subsection{Paseos Eulerianos}

Viajamos a Prusia, siglo XVIII, a la ciudad de Königsberg.

\Dibujo{Los siete puentes de Königsberg.}

La gente de la ciudad se preguntaba si se podía partir de un punto $x \in A$ o $B$ de la ciudad, cruzar cada puente exactamente una sola vez y volver a $x$. Euler se propuso a responder la pregunta.

Podemos modelar el problema como un \textit{multi}grafo (i.e. dos vértices pueden estar unidos por más de una arista):

\Dibujo[0.7]{Multigrafo de los puentes de Königsberg.}


\begin{Definition}
Un \textbf{paseo} en un multigrafo, es una secuencia de vértices $x_0,x_1,\ldots, $ tal que $x_i x_{i+1}$ es arista para todo $i \geq 0$, y ninguna de estas aristas se repite.

Un \textbf{paseo cerrado} comienza y termina en el mismo vértice.

Un paseo es \textbf{Euleriano} si es cerrado y recorre todas las aristas del multigrafo.

Un \textbf{grafo Euleriano}, es un multigrafo que contiene un paseo Euleriano.
\end{Definition}

\begin{Theorem}
Un multigrafo conexo es Euleriano si y solo si todos sus vértices tienen grado par.
\end{Theorem}

Veremos la demostración la clase siguiente.












%%%%%%%%%%%
\Clase{30/03/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%



\begin{Theorem}\label{th:paseo Euleriano si todos los vertices del multigrafo tienen grado par}
Un multigrafo conexo es Euleriano si y solo si todos sus vértices tienen grado par.
\end{Theorem}
\begin{proof}
\begin{enumerate}
\item[]


\item[$\Rightarrow$)] Asumimos que $G$ tiene un paseo Euleriano $P$. Cada vez que el paseo ''entra'' en una vértice, lo hace por medio de una arista, y debe salir por otra. Cada vez que $v$ a parece en $P$ se utilizan otras dos aristas incidentes en $v$. Como se ocupan todas esas aristas, $d(v)$ es par.

\item[$\Leftarrow$)]  Supongamos que todos los grados son pares. Haremos inducción en $\Abs G$. El caso base es $\Abs G = 2$ que claramente tiene un paseo Euleriano:

\Dibujo[0.1]{$\Abs G = 2$.}

Supongamos que $\Abs G >2$. Cuando todos los grados son pares, puedo encontrar un paseo cerrado no trivial. Tomemos como $P$ el de largo máximo, y sea $F$ su conjunto de aristas. Si $F$ es todo, la demostración está terminada. Luego supongamos que no. Sea $G \setminus F = G'$, tiene una arista $e$ que incide en un vértice de $P$, pues $G$ es conexo. Sea $C$ la componente de $G'$ que contiene a $e$. Todo vértice de $G$, posee un número par de aristas incidentes en $F$, luego la cantidad de aristas en $G'$ sigue siendo par. Aplicando la hipótesis inductiva, podemos encontrar un paseo Euleriano en $C$, llamémoslo $P'$. Como $P$ y $P'$ unidos son un paseo cerrado más grande que $P$, llegamos a un absurdo.

\Dibujo{Esta es una ilustración de lo que podría suceder: $P : 0,1,2,3,5,6,7,8,4,0$ es el camino \black{negro} y \darkgreen{$C$ es el grafo conexo}.}

\end{enumerate}

\end{proof}

\subsection{Conexidad}

\begin{Definition}
Decimos que un conjunto $X$ de vértices o aristas \textbf{separa} a $u,v \in V$ si $u,v \not \in X$ y todo camino entre $u$ y $v$ tiene un elemento de $X$.

Si $X$ separa un par de vértices, decimos que es \textbf{separador} (de $u,v$). Si un vértice solo, i.e. $X$ es un singleton, es separador, decimos que es un \textbf{vértice de corte}. Un pequeño abuso de notación será simplemente referirnos a ese vértice en lugar del conjunto que lo contiene.

Análogamente, una arista sola $X = \{e\}$ que separa sus vértices se dice \textbf{puente}. Un pequeño abuso de notación será simplemente referirnos a ese vértice en lugar del conjunto que lo contiene.
\end{Definition}

\Dibujo{Ejemplo: \yellow{$X = \{4,5,7,8,9 \}$} separa a \red{$u = 3,v = 6$}. También \purple{$Y = \{ e_1, e_2 \}$} e  \brown{$Y ' = \{ e_3, e_4\}$} son separadores de \red{$u,v$}. La arista \blue{$e = (6,10)$} es un puente.}

\begin{definition}
Para $k \geq 0$ decimos que $G = (V,E)$ es \textbf{$k$-conexo} si $\abs V > k$ y $G \setminus X$ es conexo para todo $X \subset V$ con $\abs X < k$. Es decir, ningún conjunto de menos de $k$-vértices separa.
\end{definition}

\begin{example}
\begin{itemize}
\item \textit{$0$-conexo:} Todo grafo no vacío.

\item \textit{$1$-conexo:} grafos conexos no triviales (tiene que tener al menos una arista).

\end{itemize}
\end{example}


\begin{definition}
La \textbf{conexidad}, $\Kappa (G)$ de $G$, es el máximo $k \geq 0$ tal que $G$ es $k$-conexo.
\end{definition}

\begin{example}\label{ex:clase6 - exemplo Kappa(K_n) = n-1}
\begin{itemize}
\item \textit{$\Kappa (G) = 0$:} Todo grafo disconexo no vacío o $K_1$.

\item \textit{$\Kappa (K_n) = n-1 , \forall n \geq 1$.}

\end{itemize}
\end{example}

\begin{definition}
Sea $G$ no vacío y sea $\ell \geq 1$. Decimos que $G$ es \textbf{$\ell$-arista conexo}, si $G \setminus F$ es conexo para todo $F \subset E$ con $\Abs F < \ell$.
\end{definition}

\begin{example}
\textit{$1$-arista conexo:} los grafos conexos no vacíos.
\end{example}

\begin{definition}
La \textbf{arista conexidad}, $\lambda (G)$ de $G$, es el máximo $\ell$ tal que $G$ es $\ell$-arista conexo.
\end{definition}

\Dibujo[0.8]{Ejemplo de grafo que tiene $\Kappa = 4, \lambda = 4$.}

\begin{example}\label{ex:clase6 - exemplo lambda (K_n) = Kappa(K_n) = n-1}
\textit{$\lambda (K_n) = n-1 , \forall n \geq 1$.}. Con lo cual, por el Ejemplo \ref{ex:clase6 - exemplo Kappa(K_n) = n-1} tenemos que 
$$
\lambda (K_n) = \Kappa (K_n) .
$$
\end{example}

\begin{exercise}
Calcular $\Kappa$ y $\lambda$ del siguiente grafo $G$:
\Dibujo[0.5]{Grafo $G$.}
\end{exercise}
\begin{solution}
Si quitamos los  \blue{vértices $4,5$} entonces nos queda $G$ disconexo, luego $\Kappa (G) <3$. Si quito cualquier vértice, entonces el grafo sigue siendo conexo, luego es $2$-conexo, i.e. $\Kappa (G) \geq 2$. Luego $\Kappa (G) = 2$.

En el anterior ejemplo teníamos $\lambda = 4$ en cada \blue{triángulo azul}, y como sacar $3$ aristas incidentes a \blue{$4,5$} no evita que $G$ siga siendo conexo, tenemos que $G$ es $4$-arista conexo, i.e. $\lambda (G) \geq 4$. Por otro lado, si quitamos las $4$ aristas incidentes en el \red{vértice $1$}, queda el aislado del resto del grafo, i.e. $\lambda (G) < 5$. Luego $\lambda (G) = 4$.
\end{solution}


%%%%%%%%%%%
\Clase{03/04/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%

\begin{Proposition}
Si $G$ es no trivial, entonces $\Kappa (G) \leq \lambda (G) \leq \delta (G)$
\end{Proposition}
\begin{proof}
La segunda desigualdad se tiene porque todas las aristas incidentes en un vértice fijo separan a $G$.

Veamos ahora la primera desigualdad. Sea $F$ un conjunto de aristas que separa a $G$, con $\abs F = \lambda (G)$, tal que $G \setminus F$ es disconexo. \textit{Observación:} $F$ es un conjunto de aristas minimal con la propiedad de ser separador.
\begin{enumerate}
\item[\textsc{Caso 1:}] Existe $v \in V(G)$ que no incide en $F$. Sea $C$ la componente conexa que contiene a $v$ en $G \setminus F$. No puede haber una arista $f$ de $F$ con extremos en $C$, pues de lo contrario $F \setminus \{f\}$ sería un conjunto más chico tal que es separador, lo cual contradice la minimalidad de $F$. 

\Dibujo[0.6]{Ilustración de \blue{$C$}, donde las \purple{aristas violeta} corresponden a aristas de \purple{$F$}.}

Luego, si quitamos los vértices de las aristas de $F$ incidentes en $C$, las cuales solo comparten un vértice de $C$, nos queda que $v$ estaría separado del resto del grafo. Esta cantidad de vértices es a lo sumo $\abs F = \lambda (G)$. Con lo cual $\Kappa (G) \leq \abs F = \lambda (G)$.

\item[\textsc{Caso 2:}] Todo $v \in V(G)$ incide en $F$. Fijemos $v \in V(G)$ y $C$ la componente conexa de $G \setminus F$ que lo contiene. Consideremos $N_{G} (v)$, los vecinos de $v$. Cada $w \in N_{G} (v) $ incide en una arista de $F$.

\Dibujo{Ilustración de lo que sucede: los \darkgreen{vecinos} de \green{$v$} inciden en una \purple{arista de $F$}.}

Entonces $d_G (v) \leq \abs F = \lambda (G)$. Por lo tanto, salvo que $V(G) = \{ v \} \cup N_G ( v)$, tenemos que $N_G (v)$ separa a $v$ del resto del grafo, y salvo ese caso tendríamos que $\Kappa (G) \leq \abs{N_G (v)} \leq \lambda (G)$. Pero $v$ era arbitrario, entonces en el peor de todos los casos, tenemos que $V(G) =  \{ v \} \cup N_G ( v)$ para todo $v \in G$, i.e. $G$ es un grafo completo. Pero en este caso vale la igualdad por el Ejemplo \ref{ex:clase6 - exemplo lambda (K_n) = Kappa(K_n) = n-1}.
\end{enumerate}
\end{proof}

\subsection{Grafos $2$-conexos}

\begin{Definition}
Sea $H$ un grafo. Decimos que un camino $P$ es un \textbf{$H$-camino} si es no trivial (tiene al menos una arista) e interseca a $H$ exactamente en sus extremos ($P$ no tiene ni vértices ni aristas en $H$, salvo por sus extremos).
\end{Definition}

\Dibujo[.7]{Ejemplo de \blue{$H$}-camino \yellow{$P$} de un grafo \blue{$H$}. Notar que en el dibujo consideramos a los vértices \blue{$0,5$} como extremos de \yellow{$P$}.}

Los ciclos son los grafos $2$-conexos más elementales. Veamos que todos los demás se pueden construir a partir de ellos.

\Dibujo[.7]{Ejemplos de ciclos: $C_7, C_6, C_5, C_4$ y $C_3$.}

\begin{proposition}
Un grafo es $2$-conexo si y solo si se puede construir a partir de un ciclo añadiendo sucesivamente $H$-caminos a grafos $H$ ya construidos.
\end{proposition}

\begin{remark}
Es decir, si $H_0$ es un ciclo, le agregamos un $H_0$-camino, y a la unión la llamamos $H_1$, el cual es $2$-conexo, si quisieramos podemos agregar un $H_1$-camino y seguiría siendo $2$-conexo, etc.
\end{remark}

\Dibujo{Ilustración de un ciclo $H_0$ en negro, al que le agregamo $H$-caminos en el siguiente orden: \yellow{$H_0$-camino}, \red{$H_1$-camino} y por último \blue{$H_2$-camino}.}

\begin{proof}
\begin{enumerate}
\item[]

\item[ ( $\Leftarrow$ )] Claramente un grafo construido de esta manera no se puede separar por un solo vértice. Y por su puesto que tiene más de $2$ vértices.

\item[ ($\Rightarrow$)] Tomemos un grafo $G$, $2$-conexo (en particular es también conexo). Como es $2$-conexo, debe tener algún ciclo $C$, pues de lo contrario sería un árbol con al menos $3$-vértices, y quitando un vértice que no es hoja nos quedaría separado. Nos fijamos si tiene un $C$-camino, si esto es así lo agregamos, y luego seguimos agregando hasta que no podamos más. Consideremos el subgrafo maximal $H$ de $G$ construido de esta manera a partir de $C$. Entonces toda arista $xy \in E(G) \setminus E(H)$ tal que $x,y \in V(H)$, es un $H$-camino, con lo cual no puede existir por maximalidad de $H$. Es decir, $H$ es un subgrafo inducido de $G$. Entonces todas las aristas de $G$ que no están en $H$ tienen un extremo fuera de $H$. Si $H$ es $G$ habríamos terminado, luego por el absurdo supongamos que no. Por conexión existe un vértice $v \in G \setminus H$, y conectándolo por un camino con $H$ podemos asumir que $v$ es incidente en $H$, es decir existe $w \in H$ tal que $v w$ es una arista incidente en $H$. Como $G$ es $2$-conexo, si quitamos a $w$ el grafo sigue siendo conexo, luego debe ser que existe otro camino $P$ de $v$ a $H$, con lo cual $P \cup v w$ es un $H$-camino. Absurdo por maximalidad de $H$.
\end{enumerate}
\end{proof}


\Dibujo{Ilustración: \green{$H$} contiene a \green{$w$}, con una arista incidente de extremo \blue{$v$}, que se extiende a un \green{$H$}-camino \blue{P}.}







%%%%%%%%%%%
\Clase{06/04/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%




Todo grafo \textit{sin vértices aislados} se puede particionar en subgrafos $1$-conexos. Y podemos intentar lo mismo para subgrafos $2$-conexos. Pero pueden ocurrir problemas, por ejemplo:

\Dibujo{Ejemplo de problemas para particionar en subgrafos $2$-conexos maximales. Las componentes $2$-conexas del dibujo son sus \blue{ciclos} que comparten vértices con otras estructuras como por ejemplo las dos \yellow{aristas} $12$ y $23$; o comparten aristas entre dos ciclos.}

Como ilustra la figura de arriba, los subgrafos $2$-conexos maximales no siempre abarcan todo el grafo ni son siempre disjuntos. Veamos como se arregla: podemos simplificar la noción para poder abarcar todo el grafo.

\begin{definition}
Un \textbf{bloque} es un subgrafo conexo maximal sin vértices de corte.
\end{definition}

En la figura anterior, los bloques del grafo con los \blue{ciclos} y las \yellow{aristas} $12$ y $23$.

\begin{obs}
Es fácil ver que los bloques van a ser o subgrafos \textit{$2$-conexos} o una \textit{arista} o un \textit{vértice}.
\end{obs}

\begin{proposition}
Los ciclos de un grafo son los ciclos de sus bloques.
\end{proposition}
\begin{proof}
Todo ciclo es $2$-conexo, luego es conexo sin vértices de corte, y debe estar contenido en un subgrafo maximal con esta propiedad, i.e. un bloque.
\end{proof}

\begin{proposition}
Sean $e,f \in E(G)$. Entonces pertenecen a un mismo bloque si y solo si pertenecen a un mismo ciclo.
\end{proposition}
\begin{proof}
Si pertenecen al mismo ciclo, entonces por la proposición anterior están en el mismo bloque.

Recíprocamente, como $e,f$ son dos aristas en un mismo bloque, puedo asumir que el bloque es un subgrafo $2$-conexo (no es arista sola o vértice solo). La idea es la siguiente: este subgrafo $2$-conexo se construye a partir de un ciclo uniendo $H$-caminos, luego no es difícil ver que las dos aristas están contenidas en un mismo ciclo.
\end{proof}

\begin{definition}
El \textbf{grafo bloque} de un grafo $G$ tiene un vértice por cada bloque y por cada vértice de corte de $G$; hay una arista entre dos vértices si una representa un bloque y si el otro representa un vértice de corte que está dentro del bloque.
\end{definition}

\Dibujo{Ejemplo: $G$ (izquierda) tiene $5$ \purple{bloques} (denotados por letras mayúscula: \purple{$A,B,C,D,E$}) y $2$ \darkgreen{puntos de corte} (denotados por letras minúscula: \darkgreen{$a,b$}). Luego el grafo bloque (derecha) de $G$ tiene $7$ vértices.}

Notar que en nuestro ejemplo, el grafo bloque es un árbol. Esto no es casualidad:

\begin{exercise}
El grafo bloque de un grafo conexo es un árbol.
\end{exercise}
\begin{proof}
\textit{Notación:} al grafo bloque de $G$ lo denotamos por $Block(G)$. A un subgrafo conexo sin vértices de corte
maximal,
i.e. un bloque, lo vamos a denotar con las letras mayusculas $B,C,D$. Y denotaremos con la misma letra al vértice que inducen en el grafo $Block(G)$. A los vértices de corte los denotaremos por una letra minúscula como $x,y,z,u,v,w$ y los denotaremos de la misma manera en el grafo $Block (G)$. Quedará claro dependiendo del contexto, a qué grafo pertenece cada vértice en esta notación. Haremos el abuso de notación y llamaremos bloque tanto al subgrafo de $G$ como al vértice de $Block (G)$. Análogamente, cuando digamos vértice de corte de $Block(G)$ nos estamos refiriendo a un vértice que proviene de un vértice de corte de $G$.

Si $G$ es conexo, luego $Block(G)$ es conexo. Antes notemos que basta probar que entre dos blockes de $Block (G)$ existe un camino, pues todo vértice de corte de $Block (G)$ es adyacente a algún bloque en $Block (G)$ por definición de grafo bloque. Sean $B,B'$ dos bloques de $Block(G)$, consideremos luego a partir de un $B,B'$-camino siempre podemos construir un camino que no puede entrara y salir de un bloque más de una vez, por conexión del bloque. Este camino nos induce un camino en $Block(G)$ dado por $\tilde P : B_0 v_0 B_1 v_1 \cdots B_{r-1} v_{r-1} B_r $, donde cada bloque o vértice aparece en el orden en el cual el camino $P$ se intersecó por primera véz con estos en $G$.

Ahora vevamos que $Block(G)$ es aciclico. En efecto, supongamos que no, sea $C$ un ciclo en $Block(G)$. Como $Block(G)$ es bipartito (particionamos entre vértices de corte y bloques), no tiene ciclos impares, luego $C$ tiene al menos $4$ vértices (pueden ser cortes o bloques). Con lo cual, existen dos bloques distintos $B_1,B_2$ y dos vértices de corte distintos $v_1,v_2$ tal que podemos escribir $C : B_1 v_1 B_2 \cdots v_2 B_1$. Pero esto quiere decir que hay otro $B_1,B_2$-camino en $G$ que no pasa por $v_1$, es decir que $v_1$ no era vértice de corte, absurdo.
\end{proof}


\subsection{Contracciones y menores}

\begin{definition}
\textbf{Contraer una arista} $e=xy$ equivale a borrar $x$ e $y$, y añadir un nuevo vértice $v_{xy}$ adyacente a todos los vértices que eran vecinos a $x$ o $y$.
\end{definition}

\Dibujo{Ejemplo. Contraemos los vértices \blue{$x,y$} y formamos $\blue{v_{xy}}$.}

\begin{notation}
Dado un grafo $G$ y $e = xy \in E(G)$, notamos como $G/e$ al grafo que se obtiene de $G$ al contraer la arista $e$.
\end{notation}

\begin{definition}
Decimos que $H$ es un \textbf{menor} de $G$ si se puede obtener $H$ a partir de $G$ al utilizar las siguientes operaciones:
\begin{enumerate}[1.]
\item Borrar vértices.
\item Borrar vértices y aristas.
\item Contraer aristas. O equivalentemente, contraer subgrafos conexos.
\end{enumerate}
\end{definition}

\begin{example}
Los subgrafos y contracciones de $G$ son \textit{menores} de $G$. No necesariamente vale la vuelta:

\Dibujo{Ejemplo de menor \blue{$H$} de \green{$G$}, que no es subgrafo porque tiene grado máximo $\Delta (H) = 5$. Pues \blue{$H$} se obtiene luego de contraer las \yellow{aristas} de \green{$G$}}
\end{example}


\subsection{subdivisiones}\label{subsection: subdivisiones}

Sea $X$ un grafo fijo.

\begin{definition}
Llamamos \textbf{subdivisión} de $X$ a cualquier grafo $G$ que se obtiene de \textit{subdividir} algunas aristas de $X$ y dibujando encima nuevos vértices. Más precisamente, reemplazamos las aristas de $X$ con nuevos caminos entre sus extremos, de manera que estos caminos no se intersecan entre si y tampoco intersecan a $V(X)$ salvo en los extremos.
Diremos que $G$ es un $TX$.

Llamaremos a los vértices originales de $X$, \textbf{vértices de ramificación de los de} $TX$; a los nuevos vértices los llamaremos \textbf{vértices subdivisores}.

Si un grafo $Y$ contiene a $TX$ como subgrafo, diremos que $X$ es una \textbf{menor topológica} de $Y$.
\end{definition}
Notar que los vértices subdivisores tienen grado $2$ y los vértices de ramificación no cambian de grado.

\Inkscape{De izquierda a derecha, tenemos la construcción prograsia de $X$, luego le agregamos \red{vértices subdivisores} formando $TX$, y finalmente ilustramos un ejemplo de grafo $Y$ con $X$ como menor topológico.}



\begin{definition}
Similarmente, reemplazando los vértices $x \in X$ con grafos conexos disjuntos $G_x$, y las aristas $xy \in X$ con conjuntos no vacíos de $G_x - G_y$ aristas, obtenemos un grafo que llamaremos $IX$. Recíprocamente, decimos que $X$ se obtiene a partir de $G$ \textbf{contrayendo} subgrafos $G_x$ (y fusionando las $G_x-G_y$ aristas), y lo llamamos una \textbf{menor contraida} de $G$.

Si un grafo $Y$ contiene un $IX$ como subgrafo, decimos entonces que $X$ es una \textbf{menor} de $Y$, llamamos a $IX$ un \textbf{modelo} de $X$ en $Y$, y denotamos $X\preccurlyeq Y$
\end{definition}

\Dibujo{De izquierda a derecha, tenemos el grafo $X$, que se obtiene de contraer \purple{sub}\red{gr}\darkgreen{af}\blue{os} de $G$; finalmente, el grafo $Y$ tiene a $X$ como menor y a $G$ como modelo de $X$ en $Y$}

Por lo tanto, $X$ es un menor de $Y$ si y solo si existe una función $\varphi : S \subset V(Y) \twoheadrightarrow V(X)$ tal que para todo vértice $x \in X$ si preimagen $\varphi^{-1} (x)$ es conexa en $Y$ y para toda arista $xx' \in E(X)$ existe una arista en $Y$ entre conjuntos de ramificación $\varphi^{-1}(x), \varphi^{-1} (x')$. Si el dominio de $\varphi$ es todo $V(Y)= S$, y si $xx' \in E(X)$ siempre que $x \neq x'$ e $Y$ tiene una arista entre $\varphi^{-1}(x)$ y $\varphi^{-1} (x')$ (es decir $Y$ es una $IX$), decimos que $\varphi$ es una \textbf{contracción} de $Y$ en $X$.


\begin{proposition}
La relación de menores $\preccurlyeq$ y la relación de menores topológicos son ordenes parciales en la clase de grafos finitos. Es decir, son reflexivos, antisimétricos, y transitivos.
\end{proposition}


Si $G$ es una $IX$, luego $P = \Set{G_x | x \in X}$ es una partición de $V(G)$, y notamos $G/P := X$. Si $U = G_x$ es el único conjunto de ramificación que no es un singleton, escribimos $G/U := X$, y notamos $v_U$ al vértice $x \in X$ al que se contrae $U$, y pensamos al ressto de $X$ como un subgrafo inducido de $G$. El caso más simple es cuando $U$ contiene exactamente dos vértices que forman una arista $e= U$, aquí escribiremos $G/e = X$, el grafo que se obtiene de \textbf{contraer la arista} $e$.

\begin{proposition}
Sean $X$ e $Y$ grafos finitos. Entonces $X$ es una menor de $Y$ si y solo si existen grafos $G_0,\ldots,G_n$ tales que $G_0 = Y$ y $G_n = X$, y además $G_{i+1}$ se obtiene a partir de $G_i$ borrando aristas, contrayendo aristas, o borrando vérticces.
\end{proposition}
\begin{proof}
Estas tres últimas operaciones claramente producen una menor $X$, pues la relación de menor es transitiva. Recíprocamente, se puede hacer inducción en $\abs Y + \Abs Y$.
\end{proof}

Finalmente, tenemos la siguiente relación entre menores y menores topológicos:

\begin{proposition}
\begin{enumerate}[(i)]
\item Todo $TX$ es también un $IX$ (ver la siguiente figura); por lo tanto, toda menor topológica de un grafo es su menor (ordinaria).
\item Si $\Delta (X) \leq 3$, entonces todo $IX$ contiene un $TX$; con lo cual, toda menor con grado máximo a lo sumo $3$ de un grafo es también su menor topológico.
\end{enumerate}
\end{proposition}
\begin{proof}
Veamos solo (ii), el primer ítem es obvio. En efecto, $IX$ es el grafo que se obtiene de $X$ reemplazando cada vértice $x$ de él por un subgrafo conexo $G_x$ y cada arista por un conjunto de aristas no vacío, luego tomando una arista de ese conjunto, basta con escoger un vértice de $G_x$ que tenga por cada vecino de $x$ en $X$ un camino distinto hacia cada arista incidente en $G_x$. Esto es posible: empezamos eligiendo de manera inocente al vértice que es extremo de una arista incidente con $G_x$, de este vértice, llamemosló $x$, tendríamos que contrar dos caminos disjuntos con extremo final, en el peor de los casos pues $\Delta (X) \leq 3$, en otras dos aristas de $X$; ahora si no se cruzan ya ganamos, de lo contrario se fusionan a partir de un momento, incluso varias veces, pero luego movemos nuestro vértice $x$ a la última véz que se fusionan los caminos, y llamemosló $x'$:

\Dibujo{Ilustración de cómo se ven dos caminos, ambos de color amarillo pero uno más claro que el otro, que salen de nuestro vértice $x$ y tienen que llegar a las aristas incidentes en $G_x$. Al final movemos nuestro vértice a $x'$.}

\end{proof}

\Dibujo{Ejemplo: Una subdivisión de $K^4$ visto como $I K^4$.}


Ahora que conocemos todas las relaciones standard entre grafos, podemos definir lo qu esignifica embeber a un grafo en otro.

\begin{definition}
Básicamente, una \textbf{inmersión} (o \textbf{embedding} en inglés) de $H$ en $G$ es un mapa inyectivo $\varphi : V(H) \rightarrow V(G)$ tal que preserva la estructura en la que estamos interesados. Con lo cual, $\varphi$ embebe a $H$ en $G$ c omo un subgrafo si preserva la adyacencia entre vértices, y como subgrafo inducido si preserva tanto la adyacencia como la no adyacencia. Si $\varphi$ está definido también en $E(H)$ como en $V(H)$ y manda $xy$ en caminos independientes de $G$ entre $\varphi (x)$ y $\varphi (y)$, decimos que $\varphi$ embebe a $H$ en $G$ como un menor topológico. Similarmente, decimos que es una inmesión de $H$ en $G$ como un menor, si mapea a $V(H)$ en conjuntos disjuntos de vértices en $G$ conexos, de manera que $G$ tiene una arista entre los conjuntos $\varphi (x)$ y $\varphi (y)$ siempre que $xy$ es una arisda de $H$. Más varíantes existen, pero depende del contexto en el que estemos; por ejemplo, se pueden definir de manera obvia las inmersiones de 'subgrafos generadores', y 'menores inducidas', etc.
\end{definition}

%%%%%%%%%%%
\Clase{17/04/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%


\begin{lemma}
Todo grafo $3$-conexo, distinto de $K_4$, tiene una arista $e$ tal que $G/e$ es $3$-conexo.
\end{lemma}
\begin{proof}
Supongamos que no hay una arista con esta propiedad. Es decir, para toda $xy \in E(G)$, el grafo $G/xy$ tiene un conjunto separador $S$ de a lo más $2$ vértices. Como $G$ es $3$-conexo, $v_{xy}$ (el vértice que sale de contraer la arista $xy$) tiene que estar en $S$ y $\abs S = 2$, ya que $\abs S = 0$ es imposible porque el grafo es conexo y por otro lado si $\abs S = 1$, estamos diciendo que $G$ se puede separar con un solo vértice si $v_{xy} \not \in S$ o si $v_{xy}\in S$ entonces podemos desconectar a $G$ con los vértices $x, y$, imposible.
Luego, escribimos $S = \{z, v_{xy}\}$ con $z \not \in \{x,y\}$ separador de $G/xy$. Con lo cual, $T=\{z,x,y\}$ separa a $G$. Como ningún subconjunto propio de $T$ separa, cada vértice de $T$ tiene un vecino en cada componente de $G \setminus T$.
\Dibujo{Ilustración del conjunto \purple{$T$}, donde se muestra que el vértice \purple{$z$} tiene vecinos en cada \yellow{com}\red{po}\blue{nente} de $G \setminus T$.}

Como $xy$ era arbitrario, podemos elegir la arista $xy$, el vértice $z$ y la componente $C$ tal que $\abs C$ es mínimo. Tomo $v \in C$ y es vecino de $z$. Entoncces $G/v z$ tampoco es $3$-conexo, o sea que existe $w$ tal que $v,z,w$ (distintos) separan $G$. Como antes cada una de $v,z,w$ tiene un vecino en cada conmponente de $G \setminus \{v,z,w\}$. Como $x$ e $y$ son adyacentes, existe $D$ componente de $G \setminus \{v,z,w\}$ tal que $D \cap \{x,y\} = \emptyset$ (porque $G \neq K_4$!).
\Dibujo{\blue{$D$} está contenido en el \blue{subgrafo azul}.}
Dado que $v \in C$, los vecinos de $v$ en $D$ están en $C$. Tenemos que $D \cap C \neq \emptyset$, más aún, $D \subsetneq C$. Contradiciendo la minimalidad del orden de $C$.
\end{proof}

\begin{theorem}[Teorema de Tutte, 1961]
Un grafo $G$ es $3$-conexo si y solo si existe una secuencia de grafos $G_0, G_1, \ldots, G_n$ que cumple lo siguiente:
\begin{enumerate}[(i)]
\item $G_0 = K_4$ y $G_n = G$.
\item $G_{i+1}$ tiene una arista $xy$ tal que $d(x),d(y) \geq 3$ y $G_i = G_{i+1}/xy$ para todo $i < n$. Más aún, cada $G_i$ es $3$-conexo.
\end{enumerate}
\end{theorem}
\begin{proof}
Por el lema anterior, podemos quitar una arista recursivamente hasta llegar a $K_4$. La vuelta esta en el DIESTEL.
\end{proof}


\subsection[]{Teorema de Menger}
\begin{definition}
Si $A,B,X \subset V(G)$ son tales que todo $A,B$-camino tiene un vértice de $X$, decimos que $X$ separa a $A$ y $B$ en $G$.
\end{definition}

\begin{theorem}[Menger, 1927]
Sea $G = (V,E)$ un grafo y sean $A,B \subset V$. El mínimo número de vértices que separa a $A$ y $B$ es igual al máximo número de $A,B$-caminos disjuntos.
\end{theorem}







%%%%%%%%%%%
\Clase{20/04/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%



\begin{theorem}[Menger, 1927]
Sea $G = (V,E)$ un grafo y sean $A,B \subset V$. El mínimo número de vértices que separa a $A$ y $B$ es igual al máximo número de $A,B$-caminos disjuntos.
\end{theorem}
\begin{proof}
Sea $k$ el mínimo numero de vértices que separan $A$ y $B$. No es difícil convencerse que $G$ no puede contener más de $k$ caminos entre $A$ y $B$, i.e. $k\geq$ al máximo número de $A,B$-caminos disjuntos.

\Dibujo{El \brown{conjunto separador con $k$-elementos} se ilustra en el medio de los conjuntos \red{$A$} y \blue{$B$}, formados por los vértices \brown{$0$},\red{1},\red{2},\red{3} y \brown{$0$},\blue{4},\blue{5},\blue{6} respectivamente.}

Para la otra desigualdad, haremos inducción en el número de aristas. Si $G$ no tiene aristas entonces los $A,B$-caminos son puntos de $A \cap B$! y trivialmente vale la igualdad. Ahora, si existe una arista $e = xy$ de $G$, y si $G$ no tiene $k$ caminos entre $A,B$ disjuntos (es decir tiene $<k$), entonces $G/e$ tampoco pues $G/e$ no puede tener más $A,B$-caminos (contamos a $v_e$ como elemento de $A$ (o $B$) si alguna de $x $ o $y$ está en $A$ (o $B$)). Luego por hipótesis inductiva, $G/e$ tiene un $A,B$-separador $Y$ con menos de $k$ vértices. El vértice $v_e$ debe estar en $Y$, porque si no $Y$ sería separador de $G$, contradiciendo minimalidad de $k$. Entoncces $X = (Y \setminus v_e) \cup \{x,y\}$ es un $A,B$-separador de $G$ con exactamente $k$ vértices. En efedcto, por minimalidad $k \leq \abs X$, y por construccón $\abs X = \abs Y + 1 < k +1 \leq k$.

Consideremos ahora $G \setminus e$. Como $x,y \in X$, todo $A,X$-separador en $G \setminus e$ es un $A,B$-separador en $G$ con al menos $k$-vértices por minimalildad de $k$.

\Dibujo{Ilustración del conjunto separador \brown{$X$} y los conjuntos de vértices \red{$A$} y \blue{$B$}. Notar que todos los $A,B$-caminos deben pasar por el \yellow{$A,X$-separador}.}

Por inducción, hay al menos $k$ caminos entre $A,X$ disjuntos en $G \setminus e$. Lo mismo pasa con los $B,X$-caminos. Como $X$ separa a $A$ y $B$, estos caminos solo se encuentran en $X$ y los puedo combinar para tener al menos $k$ caminos entre $A$ y $B$ (disjuntos), contradicción.
\end{proof}

\begin{definition}
El \textbf{grafo línea} $L(G)$ de un grafo $G = (V,E)$ es aquel cuyo conjunto de vértices es $E$ y hay una arista entre dos elementos de $E$ si y solo si las aristas son adyacentes en $G$, es decir comparten un extremo.
\end{definition}

\Dibujo{Ejemplo de un grafo $G$.}

\Dibujo{Grafo de línea de $G$, donde se puede ver que sus \brown{vértices} son las \brown{aristas} de $G$.}


\begin{definition}
Un conjunto de $a,B$-caminos es un \textbf{$a,B$-abanico} si cada par de estos caminos se intersecta SOLO en $a$.
\end{definition}

\Dibujo{Ejemplo de $\red{a},\blue{B}$-abanico.}


\begin{corollary}
Para $B \subset V$ y $a \in V \setminus B$, el mínimo número de vértice que separan $a$ de $B$ en $G$ es igual al máximo número de caminos en un $a,B$-abanico en $G$.
\end{corollary}
\begin{proof}
Aplicamos el Teorema de Menger a $G \setminus a$ con conjuntos $A = N_G (a)$ y $B$ como en el enunciado.

\Dibujo{Ilustración del procedimiento: en rojo los \red{vecinos} de $a$, en azúl el conjunto \blue{B}, y en marrón a un connjunto $\red{A},\blue{B}$-separador \brown{$X$}.}

\end{proof}


\begin{corollary}
Sean $a$ y $b$ vértices distintos de $G= (V,E)$.
\begin{enumerate}[(i)]
\item Si $ab \not \in E$ ($a,b$ no son adyacentes), entonces el mínimo número de vértices que separan $a$ de $b$ en $G$ es igual al máximo número de $a,b$-caminos INTERNAMENTE disjuntos.
\item El mínimo número de aritas que separan $a$ de $b$ es igual al máximo número de $a,b$-caminos arista-disjuntos.
\end{enumerate}
\end{corollary}
\begin{proof}
\begin{enumerate}[(i)]
\item Aplicamos el Teorema de Menger a $G \setminus \{a,b\}$ con $A = N_G (a)$ y $B = N_G (b)$.
\item Aplicamos el Teorema de Menger al grafo $L(G)$ con conjuntos $A = E(a)$ y $B = E(b)$ los conjuntos de aristas incidentes en $a$ y $b$, respectivamente.
\end{enumerate}
\end{proof}

Notar que en el segundo ítem de la demostración anterior usamos que hay una correspondencia biyectiva entre aristas $A,B$-separadoras y vérticces separadores de $E(A),E(B)$ en $L(G)$, y también entre los $A,B$-caminos arista-disjuntos y los $E(A),E(B)$-caminos disjuntos de $L(G)$.

\begin{theorem}[Versión global de Menger]
\begin{enumerate}[(i)]
\item Un grafo es $k$-conexo si y solo si contiene $k$-caminos internamente disjuntos entre cada par de vértices.
\item Un grafo es $k$-aristaconexo si y solo si contiene $k$ caminos arista disjuntos entre cada par de vértices.
\end{enumerate}
\end{theorem}
\begin{proof}

\end{proof}





\section{Ejercicios}

\begin{exercise}
Sea $G$ un grafo que contiene un ciclo $C$, y supongamos que $G$ contiene un camino de longitud al menos $k$ entre
dos vértices de $C$. Probar que $G$ contiene un ciclo de longitud al menos $\sqrt k$.
\end{exercise}
\begin{solution}
    Si $C$ tiene longitud $\sqrt k$ entonces la afirmación vale. Si no, denotemos por $P$ al camino de longitud $k$
    entre dos vérticces $x,y \in C$. Como $\Abs C < \sqrt k$, $P$ interseca con $C$ en menos de $\sqrt k$ vértices,
    por lo tanto existen dos vértices $a,b \in P \cap C$ tales que, en el orden inducido por el camino $P$, no hay otro
    vértice de $C$ entre estos, y $a P b$ tiene longitud $\geq \sqrt k$. Luego el ciclo $a P b C a$ tiene logitd $\geq \sqrt k$.
\end{solution}


\begin{exercise}
Probar que los grafos de cintura $\geq 5$ y orden $n$ tienen $\delta = o (n)$. Es decir, existe $f : \naturals \rightarrow \naturals$ tal que $f(n) /n \rightarrow 0$ cuando $n \rightarrow \infty$ y $\delta (G) \leq f(n)$ para todo $G$ de orden $n$.
\end{exercise}
\begin{solution}
    En efecto, tenemos que
    $$
    n = \abs G \geq n_0 ( \delta, 5) = 1 + \delta (1 + (\delta -1)) = 1 + \delta^2
    $$
    por el Teorema débil \ref{th:version debil del teorema de Alon, Hoory y Lineal en 2002}, si $\delta \geq 2$.
\end{solution}

\begin{exercise}
Probar que todo grafo conexo $G$ contiene un camino o un ciclo de longitud al menos $\min \{2 \delta (G) , \abs G\}$.
\end{exercise}
\begin{solution}
Comentario, el resultado es falso solo para $n = 2$. En efecto, veremos en la demostración que vale para $n \neq 2$,
y un camino de longitud uno no cumple pues $2 \delta = 2$ y $n = 2$ pero la longitud de cualquier sub camino o ciclo
es a lo más uno.

Consideremos $P$ el camino de longitud máxima. Por maximalidad los vecinos de los extremos de $P$ tienen que estar en $P$. Si $G[P]$ forma un ciclo $C$ de longitud mayor a $P$, i.e. $G[C] = G[P]$ debe ser que
\begin{enumerate}[(i)]
\item $\Abs C = \abs G$ si $G = G[C]$. Luego en este caso se tiene que vale la afirmación;
\item o si no, como $G$ es conexo existe un vértice $v \not \in V(C)$ adyacente a $C$. Más aún, todos sus vecinos deben estar en $C$, de lo contrario podíamos encontrar un camino más grande que $P$. Con lo cual $\delta (G) \leq d (v) \leq \Abs C / 2$ porque no puede haber dos vecinos de $v$ en $C$ ayacentes mediante una arista de $C$ por maximalidad de $C$. Luego en este caso también vale la afirmación.
\end{enumerate}

Por otro lado, si $G[P]$ no forma ciclos de longitud mayor a $P$, debe ser que los extremos de $P$ (digamos $x_1$ y $x_2$, que podemos suponer son distintos pues este caso es trivial) no son vecinos entre sí. Veamos que esto implica que $\Abs P \geq 2 \delta (G)$, para eso, basta ver que $\Abs P \geq d (x_1) + d (x_2)$. En efecto, ordenemos a los vecinos de $x_1$ en $P$: $V: v_1<v_2< \cdots < v_{d(x_1)}$; similarmente ordenamos los vecinos de $x_2$ en $P$: $W: w_1 < w_2 <\cdots < w_{d(x_2)}$. Notemos que un elemento de $v \in V$ no puede ser adyacente a un elemento $w \in W$ cuando $v > w$, pues podríamos construir un ciclo de longitud más grande que $P$: $w x_2 P v x_1 P w$. Luego con esta observación, probemos que el camino de $P$ generado por todos los vértices $x_i,y_j$ tiene longitud al menos $d(x_1) + d(x_2) -2$. Para eso, basta ver que este conjunto tiene al menos $d (x_1) + d(x_2) -1$ vértices. Sea $j_0$ el primer índice tal que $y_{j_0}$ coincide con un $x_i$, luego debe ser que para todo $y_j$ con $j > j_0$ tal que coincide con un $x_i$ no puede ser consecutivo a $y_{j-1}$ (por la observación de recién con $v = y_{j}$ y $w = y_{j-1}$), de hecho debe haber un vértice entre $y_{j-1}$ e $y_j$ que no sea ningún $x_i$: el consecutivo a $y_{j-1}$ por la observación anterior. Es decir, salvo por $y_{j_0}$ los $y_j$ son distintos a los $x_i$ o si coinciden con algún $x_i$ es porque hay un tercer vértice distinto de $x_i$ o $y_j$ que podemos contar en lugar de $y_j$.
\end{solution}

\begin{exercise}
Sean $\alpha, \beta$ dos invariantes de grafos en $\naturals$.
\end{exercise}

\begin{exercise}
Probar que todo árbol $T$ tiene al menos $\Delta (T)$ hojas.
\end{exercise}
\begin{proof}
En efecto, fijemos una raíz $r$ con $d (r) = \Delta (t)$. Afirmamos que hay una hoja distinta por cada vecinos de $r$, más aún, estos son los elementos maximales en el orden de arbol con raíz $r$. Y hay al menos $d(r)$ de estos, tomand el máximo de cada conjuntos $w^{\geq} := \{ v \in T | v \geq w \}$, con $w \in N_T (r)$. Son distintos, pues de lo contrario, sean $m_1$ al mínimo vértice de $w_1^{\geq}$ y $m_2$ el de $w_2^{\geq}$ tales que no son más grandes que $w_2$ y $w_1$ respectivamente. En particular, existe $m \geq w_1,w_2$. Luego tenemos un ciclo $r <  w_1 < \cdots < m_1 < m > m_2 > \cdots > w_2 > r$, lo cual es imposible.
\end{proof}




\begin{exercise}
Sean $F,F'$ dos bosques en el mismo conjunto de vértices, y $\Abs F < \Abs  {F'}$. Probar que $F'$ tiene una arista $
e$ tal que $F + e$ es nuevamente un bosque.
\end{exercise}
\begin{solution}
    En efecto, si $F$ tuviera más de una componente, entonces cualquier arista $e \in F'$ con extremo en ambas
    funcionaría. Luego supongamos que $F'$ no tiene aristas que conectan ningúna componente de $F$, es decir por
    inducción en $\Abs F$ se sigue el resultado. Luego supongamos que $F$ es conexo, es decir es un árbol, como $\Abs {F'} = \abs {F'}- \# \text{componentes}$, se sigue de la desigualdad del enunciado que $F'$ también es conexo. Ahora si consideramos el grafo $G = F + F$, este grafo tiene dos árboles generadores $F$ y $F'$. Si $F$ y $F'$ tuvieran una arista en común, luego el resultado se sigue. De lo contrario, tendríamos que por cada arista $e \in F'$, tenemos un ciclo en $T+e$, es decir un ciclo fundamental $C_e$. Pero por la Ecuación \eqref{eq:formula de la dimension para los subsespacios ortogonales de E(G)} aplicada al subespacio de cortes $\mathcal B (G)$ y usando el Teorema \ref{th:apendice subespacio de ciclos y subespacio de cortes son mutuamente ortogonales entre si}:
    \[
    \Abs F + \Abs {F'} = \dim \mathcal E (G) = n -1 + \dim \mathcal C (G)
    \]
    con $n = \abs F = \abs {F'}$, y como $F$ es árbol $n-1 = \Abs F$. Luego $\dim \mathcal C (G) = \Abs {F'}$. An
    álogamente, $\dim \mathcal C (G) = \Abs {F} < \Abs {F'}$, imposible.
\end{solution}

\begin{exercise}
    Probar que todo grafo es $2$-arista-conexo, si y solo si, tiene una orientación \textbf{fuertemente conexa}, es
    decir, tiene una orientación en la cual para todo par de vértices $x,y$ existe un camino dirigido $\overset{
    \rightarrow}{P}$ con dirección de $x$ hacia $y$.
\end{exercise}
\begin{solution}
    \begin{enumerate}
    \item[($\Rightarrow$)] Lo probaremos para multigrafos $2$-arista-conexos, por inducción en el número de aristas.
    Primero supongamos que $\delta (G) \geq 3$, digamos con $d(x) \geq 3$ y $e$ aristas incidentes en $x$.
    Consideremos el grafo $G \setminus e$. Si sigue siendo $2$-arista conexo, luego por inducción tenemos que tiene
    una orientación fuertemente conexa y en particular $G$ también. De lo contrario, es porque existe otra arista $f$, distinta de $e$, tal que $
    G\setminus \{e,f\}$
    tiene
    exactamente dos componentes $2$-conexas, conectadas entre sí por $e$ y $f$, digamos $H_1,H_2$ y por hipótesis
    inductiva
    tienen una
    oritentación
    fuertemente conexa cada una, las cuales podemos extender a todo $G$ declarando a $f$ como la orientación $H_1$
    hacia $H_2$ y a $e$ como la orientación opuesta.
    \begin{figure}
        \centering
        \includegraphics{"./Editor de Grafos/Figuras/Ejercicios/Dibujo 1"}
        \caption{Por un lado tenemos a \red{$H_1$} y por el otro \blue{$H_2$}, conectados por \yellow{$e$} y \yellow{$f$}.}
    \end{figure}


    Ahora, si $\Delta (G) \leq 2$, tenemos que como $2 \leq \lambda (G) \leq \delta (G) \leq \Delta (G)$, en realidad
     vale la igualdad, es decir $G$ es $2$-regular. Si $G$ tiene solo vértice no hay nada que probar, en general sea $x \in V(G)$, luego tiene dos vecinos o era el multigrafo con solo dos vértices de grado $2$; en el primer caso podemos \textit{remover} a $x$, es decir, los vecinos de $x$ ahora van a estar unidos por una arista en vez de conectarse a $x$, como la cantidad de aristas disminuye pero sigue siendo $2$-conexo, luego por inducción tiene una orientación fuertemente conexa, la cual sencillamente podemos extender a todo $G$ como lo muestra el dibujo:
      \begin{figure}
          \centering
          \includegraphics{"./Editor de Grafos/Figuras/Ejercicios/Dibujo 2"}
          \caption{Remover \red{$x$} es equivalente a unir a sus vecinos por una \yellow{arista} y quitar \red{las
          aristas
          incidentes} en
           \red{$x$}.}
      \end{figure}


    \item[($\Leftarrow$)] Quitar una arista no nos puede remover la conexión de $G$, de lo contrario, sean $x,y$ dos
    vértices adyacentes tales que $e = xy$ es un puente, i.e. $G\setminus e$ es arista disconexo, tenemos que $e$ ten
    ía la orientación,
    digamos $x$ a $y$, sin embargo existe un camino en $G$ con orientación de $y$ en $x$, el cual no puede tener
    ninguna arista igual a $e$, con lo cual $x,y$ seguían siendo arista-conectados en $G \setminus e$, absurdo.
    \end{enumerate}
\end{solution}

\begin{exercise}
    Dar una demostración corta por inducción de la exisstencia de un árbol normal generador en cualquier grafo finito
     conexo (para cualquier orden de árbol).
\end{exercise}
\begin{solution}
    Afirmamos que existe un vértice $v$ de $G$ que se puede eliminar y sigue siendo conexo: $G$ tiene un árbol generador
    , luego quitamos una hoja. Ahora por inducción, $G \setminus v$ tiene un árbol generador normal $T'$. Afirmamos
    que el árbol generador $T = T' vx$ de $G$ es también normal, donde $x \in T'$ es adyacente a $v$ en $G$, maximal
    en el orden de $T'$.
    Ahora, el orden de $T'$ se extiende al de $T$ para cualquier raíz $r$ de $T'$. Sea $P$ un $T$-camino entre dos vértices
    distintos de $v$, luego son comparables en $T'$; por otro lado, si uno de los vértices es $v$ y el otro es $y$,
    digamos, entonces $x v P y$ es un $T'$-camino, luego $x$ e $y$ son comparables, y por lo tanto $v$ e $y$ tambi
    én, pues por la maximalidad de $x$, $x \geq y$. (
    Notar
    que
    luego
    vale para $v$
    como raíz
    tambi
    én.)
\end{solution}


\begin{exercise}[Depth-first search]
Sea $G$ un grafo conexo, y $r \in G$ un vértice arbitrario. Empezando desde $r$, nos movemos a través de las aristas
de $G$, priorizando movernos a un vértice que no hayamos visitado aún. Si no hay ningún vértice, retrocedemos por las
 aristas que visitamos por última véz, ordenadamente: la más reciente primero, intentando ocupar un vértice no
 visitadao nuevamente. El algorítmo para cuando regresamos a $r$. Probar que las aristas recorridas forman un árbol
 normal generadores de $G$ con raíz $r$.
\end{exercise}
 \begin{solution}
 Debemos probar varias cosas, primero que este recorrido, que llamaremos $T$, es un árbol: basta ver que no tiene
 ciclos;
  que
  es generador; y que es
  normal.
  \begin{enumerate}[1.]
  \item Sea $C$ un ciclo con vértices consecutivos $x_0, x_1, x_2 , \ldots, x_k$ en $T$. Podemos suponer que $x_k$ fue
   el último en haber sido visitado. Luego $x_0$ tuvo que haber sido el vértice que se visitó primero de $C$ y en
   consecuencia se visitó en orden: $x_0, x_1, \ldots, x_k$. Pero una vez visitado $x_k$ el algorítmo sigui corriendo
    sin volver a $x_0$ pues este ya fue visitado, pero esto significa que $C$ no puede tener la arista $x_k x_0$,
    absurdo.
  \item Supongamos que existe un vértice no visitado, luego existe un vértice sin visitar a distancia mínima de $T$,
  i.e. adyacente a $x \in T$. Luego el algorítmo tuvo que pasar por este vértice cuando volvió a $x$ por última vez.
    \item Como $T$ genera, se sigue que es normal si y solo si para todo par de vértices adyacentes en $G \setminus T$ son comparables. En efecto, supongamos que el algorítmo visitó primero a $x$ y luego a $y$, con lo cual $x \leq y$.
  \end{enumerate}
 \end{solution}

 \begin{exercise}
     Sea $\mathcal T$ un conjunto de subárboles de un árbol $T$, y $k \in \naturals$.
     \begin{enumerate}[(i)]
     \item Mostrar que si los árboles de $\mathcal T$ son disjuntos dos a dos, entonces $\bigcap_{S \in \mathcal T} S \neq \emptyset$.
     \item Mostrar que o $\mathcal T$ tiene $k$ árboles disjuntos o existe un conjunto de a lo sumo $k-1$ vérticces
     de $T$ en $\bigcap_{S \in \mathcal T} S$.
     \end{enumerate}
 \end{exercise}
 Notar que $\mathcal T$ tiene que ser finito, por ejemplo si $T$ es finito, porque si no el primer ítem fallta
 tomando una cadena (con el orden de inclusión) de conjuntos de caminos infinitos.

\begin{solution}
    \begin{enumerate}[(i)]
    \item Lo probaremos por inducción en $n = \abs T$. Si $n = 1$ es trivial. En general, si $n>1$, tomamos una hoja $x \in T$ y consideramos $T' = T \setminus x$. Sea $\mathcal T$ un subconjunto de árboles de $T$ con la propiedad de intersección dos a dos del enunciado. Si $x \in \bigcap \mathcal T$, entonces ganamos. Supongamos luego que no, y consideremos $\mathcal T '$ el conjunto de los $T_i' := T_i \setminus x$ con $T_i \in \mathcal T$. Este es un subconjunto de árboles en $T'$, luego si vemos que cumple la propiedad de intersección dos a dos, se seguirá por inducción que $\emptyset \neq \bigcap \mathcal T ' \subset \bigcap \mathcal T$. En efecto, si existieran $T_1', T_2' \in \mathcal T'$ tales que $T_1' \cap T_2' = \emptyset$, quiere decir que $T_1 \cap T_2 = \{x\}$, pero esto es imposible salvo que $T_1$ o  $T_2$ sea igual a $\{ x \}$, ya que $x$ es una hoja de $T$, pero entonces por la intersección dos a dos de $\mathcal T$, tenemos que $x \in \bigcap \mathcal T$, pero ya habíamos descartado este caso.
    \item Lo haremos por inducción en el número de vértices $n$ de $T$. Si $n = 1$, el resultado es trivial. En
    general, tomemos una hoja $x \in T$, y consideremos un conjunto $\mathcal T$ de árboles de $T$. Supongamos que no
     contiene $k \in \naturals$ árboles disjuntos. Sea $\mathcal T ' := \{ T \setminus \{x \} | T \in \mathcal T \}$, una familia de subárboles de $T' = T \setminus \{x\}$.
      Pueden ocurrir dos casos: en el primero $\mathcal T'$ no tiene $k-1$ árboles disjuntos, luego por hipótesis
      inductiva, existe un conjunto de vértices $S \subset T' := T \setminus \{x\}$ con a lo más $k-2$ vértices que
      interseca a todos los árboles de $\mathcal T'$. Si ningún árbol de $T$ fuera exactamente $\{x\}$, entonces se
      seguiría que esos vértices también intersecan a los de $\mathcal T$. De lo contrario, agregando a $x$ tenemos
      un subconjuntos de a lo más $k-1$ vértices que también sirve para $\mathcal T$. El segundo caso es cuando $\mathcal T '$ tiene $k-1$ árboles disjuntos pero no tiene $k$. El mismo procedimiento nos daría un conjunto $S \subset T'$ de a lo más $k-1$ elementos que interseca a los árboles de $\mathcal T'$, pero como hay $k-1$ disjuntos, debe ser exactamente $k-1$. Ahora, estos $k-1$ árboles de $\mathcal T'$, originalmente a lo más uno podía contener a $x$, de lo contrario com $x$ es hoja, su vecino $y$ estária en la intersección de dos árboles de $\mathcal T '$. Como $\mathcal T$ no puede tener $k$ árboles disjuntos, debe ser que el árbol $\{x\}$ interseca a alguno de los que no se degeneraron en $T'$, o sea que hay exactamente un árbol $T_0$ en $\mathcal T$, tal que $x,y \in T_0$ pero que no están en ningún otro árbol, reemplazando al elemento de $S \cap T_0' = S \cap (T_0 \setminus \{x\} = \{z\})$ por $x$, obtenemos que $S$ tiene $k-1$ elementos e interseca a todos los árboles de $\mathcal T$.
    \end{enumerate}
\end{solution}

\begin{remark}
Utilizando el vocabulario del Capítulo \ref{apendice:orden parcial completo
-dirigido y teorema del punto fijo de Kleene} del Apéndice, los ítems del ejercicio anterior se pueden traducir.
Antes, vamos a considerar el conjunto $\operatorname{Trees} (T)$, de subármoles de $T$, el cual es un orden parcial
con la inclusión, pero nos va a interesar mirar el orden opuesto $\leq:= \subset^{op}$. Así, la operación supremo
entre un conjunto arbitrario de subárboles de $T$, digamos $\mathcal T$, es $\bigvee \mathcal T = \bigcap \mathcal T$, cuando el supremo exista, y este sea un subárbol de $T$. Notar que siempre que dos árboles en $T$ no sean disjuntos, entonces la intersección está en $\operatorname{Trees} (T)$, es decir tienen supremo. Con lo cual:
\begin{enumerate}[(i)]
\item La hipótesis que todo par de elementos de $\mathcal T$ tengan intersección dos a dos, equivale a decir que $\mathcal T$ es
 un
conjunto dirigido del orden parcial $(\operatorname{Tree} (T), \leq )$; y que $\bigcap \mathcal T \neq \emptyset$
equivale a que $\mathcal T$ tenga supremo en $\operatorname{Tree} (T)$ (pues la intersección de árboles sigue siendo
un árbol, si el conjunto es dirigido). En resumen, en el ejercicio anterior probamos que $(\operatorname{Tree} (T), \leq)$ es un \textit{orden parcial completo-dirigido}.
\item Más aún, el segundo ítem nos dice que todo $\mathcal T \subset \operatorname{Tree}(T)$ tiene $k$ elementos sin
relacionar o existe un conjunto de a lo más $k-1$ vértices (pensados como árboles) en $\operatorname{Tree} (T)$ cada
uno $\leq$ que alǵun árbol de $\mathcal T$. Intuitivamente, $\mathcal T$ no tiene supremo, pero tenemos un poco de
control que ``tan lejos está de tener supremo'': a lo más $k-1$, pues si fuera $1$, tendríamos que $\sup \mathcal T = \bigcap \mathcal T $ existe.
\end{enumerate}
\end{remark}



\begin{exercise}\label{ejercicio:todo automorfismo de un arbol tiene un vertice o arista fijos}
    Probar que todo automorfismo de un árbol fija un vértice o una arista.
\end{exercise}
\begin{solution}
    Probaremos el enunciado por inducción en el cardindinal de $T$. Si $\abs T$ es $1$ el resultado es trivial.
    En general, consideramos $f : T \rightarrow T$ endomorfismo de grafos, luego induce un endomorfismo $f^* : L
     (T) \rightarrow L(T)$ entre grafos de línea, que manda $e = xy \mapsto f^*(e) = f(x)f(y)$ (siempre está bien
      definido el morfismo de grafos $f^*$ inducido por un morfismo des grafos $f : G_1 \rightarrow G_2$). Como $
      L(T)$ es un árbol también (en efecto, es el grafo de bloque de $T$) y tiene $n-1$ vértices si $n= \abs T$,
      se sigue por inducción que $f^*$ deja fijo a una arista o a un vértice de $L(T)$. En ambos casos se implica
       que $f$ tiene un punto fijo.
\end{solution}



\begin{exercise}
    Mostrar que en un grafo conexo los conjuntos de aristas que son minimales con la propiedad de contener una arista
     de cada árbol generador son precisamente los enlaces del grafo.
\end{exercise}
\begin{solution}
    Por un lado, un corte de $G$ tiene que tener una arista de cada árbol generador, pues el arbol es conexo y no se
    puede separar por las partes que inducen el corte; luego los enlaces son minimales con esta propiedad. Por otro
    lado, lo anterior implica que los conjuntos de aristas minimales con esta propiedad, cumplen que si son cortes
    entonces son enlaces. Luego basta probar que estos conjuntos son cortes. En efecto, sea $E$ un conjunto de
    aristas minimal con la propiedad que interseca a todos los árboles generadores de $G$. Sea $f \in E$, por
    minimalidad tenemos que existe un árbol generador $T$ tal que $E(T) \cap E = \{f \}$. Afirmamos que el corte
    fundamental
    \[
        D_f = D_f(T) \subset E;
    \]
    con lo cual, como $D_f$ es un enlace, interseca a todos los árboles generadores, luego por minimalidad de $E$
    deben ser iguales, i.e. $E$ es un corte (de hecho un enlace). Finalmente, veamos la afirmación: ya sabemos que $f \in D_f \cap E$; sea ahora $g \in D_f \setminus \{f\}$, consideremos el árbol $T' = T - f + g$ que es también generador de $G$. Notemos que $T'$ debe intersecar a $E$ porque es árbol generador, pero por cómo elegimos a $T$, la única arista que puede estár en $E$ es $g$. Como $g$ era arbitrario, $D_f \subset E$, como queríamos.
\end{solution}

\begin{exercise}
    Probar que el espacio de ciclos de un grafo está generado por:
    \begin{enumerate}[(i)]
    \item sus ciclos inducidos;
    \item sus ciclos geodésicos;
    \item sus ciclos sin cuerdas.
    \end{enumerate}
    (Un ciclo $C \subset G$ se dice \textbf{geodésico} en $G$, si para todo par de vértices de $C$, su distancia en $
    G$ coincide con su distancia en $C$.)
\end{exercise}
\begin{solution}
Como todo elemento del espacio de ciclos se escribe como unión disjunta de ciclos, basta ver que los ciclos
sin cuerdas generan a los ciclos. En efecto, sea $C$ un ciclo, entonces consideremos la cuerda $xPy$ de $C$ en $G$
con $x,
y \in V(C)$. Podemos tomar la cuerda (si es que tiene, si no ya ganamos) de manera que el ciclo $C' = xPyCx$ es un
ciclo sin cuerdas, además
\[
    C = (C \setminus C' + P) + C'
\]
donde $C \setminus C' + P$ es un ciclo de $G$ al que le podemos repetir este procedimiento
recursivamente, así,
\[
    C = D_1 + D_2 + \cdots + D_k
\]
se escribe como la suma de ciclos sin cuerdas.

Como los ciclos sin cuerdas son geodésicos y los ciclos geodésicos son ciclos inducidos, el ejercicio se sigue.
\end{solution}

\begin{exercise}
    Sea $F$ un conjunto de aristas en $G$.
    \begin{enumerate}
    \item Probar que $F$ se extiende a un elemento de $\mathcal B (G)$ si y solo si no contiene ciclos impares.
    \item Probar que $F$ se extiende a un elemento de $\mathcal C (G)$ si y solo si no contiene cortes impares.
    \end{enumerate}
\end{exercise}
\begin{solution}
    \begin{enumerate}
    \item Por un lado ningún elemento de $\mathcal B (G)$ puede tener un ciclo impar pues el subgrafo inducido es bipartito.
Recíprocamente, podemos agregar aristas de $F$ tal que siga sin contener ciclos impares hasta obtener un conjunto
maximal con esta propiedad. Claramente obtenemos una bipartición; cuya unión da $G$ por maximalidad de $F$.
    \item Por un lado, si $F$ se extiende a un elemento de $\mathcal C (G)$, digamos $\bar F$, entonces no contiene
    cortes
    impares,
    pues de lo contrario, digamos que contiene a un corte $E$ impar, luego tenemos que por ortogonalidad $\langle E, \bar F \rangle = 0$, i.e. $\bar F$  interseca una cantidad par de veces a $E$, pero como $E \subset F \subset \bar F$, interseca en su totalidad a $E$ que es una cantidad impar: absurdo. Recíprocamente, si no contiene cortes impares, podemos considerar el conjunto de aristas $F$ maximal con la propiedad de no contener cortes impares, obtenido a partir de $F$ agregando aristas. Luego para ver que está en el espacio de ciclos, hay que probar la propiedad de ortoganalidad: $F$ interseca una cantidad par de veces a todos los cortes. Probemosló por el absurdo, si no fuera así, existiría corte $E$ que interseca a $F$ una cantidad impar de veces, en particular, $E$ no está contenido en $F$.
    \end{enumerate}
\end{solution}



\begin{exercise}
Sea $A = (a_{ij})_{n \times n}$ la matríz de adyacencia de un grafo $G$. Probar que la matriz $A^k = (a'_{i,j})_{n\times n}$, tiene la propiedad de que $a'_{i,j}$ es la cantidad de \textbf{paseos} (es decir caminatas donde se pueden repetir aristas) de longitud $k$ que hay de $v_i$ hasta $v_j$ en $G$.
\end{exercise}
\begin{solution}
    Por inducción en $k$. Si $k = 1$ es trivial. En general, supongamos que vale para $k \geq 1$. Luego $A^{k+1} =
    A^k \cdot A = (a''_{i,j})$ donde
    \[
        a''_{ij} = \sum_{1 \leq l \leq n} a'_{i,l} a_{l j},
    \]
    con $A^k = (a'_{i,l})$ la cantidad de paseos de longitud $k$ entre $v_i$ y $v_l$. Luego la afirmación se sigue de
     la cantidad de $k+1$ paseos entre $v_i$ y $v_j$ es igual a la cantidad de $k$ paseos entre $v_i$ y $v_l$, y
     luego de $v_l$ a $v_j$ para cada vértice $v_l$ adyacente a $v_j$.
\end{solution}







%%%%%%%%%%%
\Clase{27/04/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%


\begin{definition}
        Un \textbf{matching} o \textbf{emparejamiento} en un grafo $G = (V,E)$ es un subconjunto $M \subset E$ tal
        que ningún par de aristas en $M$ comparten un vértice.

        Un matching es \textbf{maximal} si al añadirle cualquier otra arista deja de ser matching.

        Un matching es \textbf{máximo} si no hay otro matchinig con mayor tamaño (número de aristas).

        Decimos que un matching \textbf{cubre} a los vértices de sus aristas.

        Un matching que cubre a todo $V(G)$ es \textbf{perfecto}.
\end{definition}
Notar que un matching de un grafo $G$, es la definición dual de conjuntos de vértices aislados en su grafo de línea $
L(G)$.

\Dibujo[0.4]{Ilustración de un \yellow{matching} de un grafo $G$. Observar que este matching es maximal, no perfecto.
¿Será máximo?}

\begin{remark}
Hay grafos sin mathchings perfectos. Por ejemplo, el grafo de la ilustración anterior:
\Dibujo{En efecto, todo matching perfecto debe cubrir a los vértices de grado uno: \yellow{$1$} y \yellow{$2$}, pero
esto es imposible porque haría que sus aristas fueran adyacentes.}

En particular, el ejemplo anterior muestra que todo grafo con un par vértices de grado $1$, a distancia $2$ entre sí
, no puede tener un matching perfecto.
\end{remark}

\begin{obs}
Sea $T$ un árbol. Luego $T$ tiene un matching perfecto si y solo si la distancia entre cualquier par de hojas es impar.
\end{obs}
\begin{proof}
En efecto, la noción dual de que un árbol $T$ tenga un matching perfecto, es que podamos pintar el grafo
línea $L(T)$ (que
también es un árbol en este caso) con dos colores: \red{rojo} y \blue{azul}, el primero para representar las aristas
que no
pertencen al matching y el segundo para las que sí, de manera que partiendo de cualquier hoja podamos llegar a
otra hoja pintando la primera de \blue{azul} y luego intercalando colores llegar a la otra hoja, nuevamente de color
\blue{azul}.
Es decir, entre dos hojas de color \blue{azul} el único camino que las une debe tener longitud par (estamos pensando
en el grafo de línea $L(T)$).
Ahora, esto se traduce al grafo $T$ cambiándo la paridad, pues la distancia entre dos hojas de $T$ disminuye en uno
cuando miramos el camino que las une en $L(G)$.

\Dibujo{Los ejemplos de grafos de línea de dos árboles distintos, uno sí tiene un matching perfecto y el otro no,
pues el primero tiene distancia par entre cualquier par de hojas pero el otro no.}
\end{proof}


Sea $G = (X \sqcup Y, E)$ un grafo bipartito (hablamos de un \textbf{$X,Y$-bigrafo}). Si $G$ tiene un matching de
tamaño $\abs X$  (en particular cubre a $X$) los elementos de cualquier $S \subset X$ tienen
\begin{equation}\label{eq:condicion de Hall}
\abs{N(S)} \geq \abs S.
\end{equation}

\begin{definition}[Condición de Hall]
    Si subconjunto de vértices $S \subset G$ cumple $\eqref{eq:condicion de Hall}$, decimos que $
    S$ cumple la \textbf{condición de Hall}.
\end{definition}

\begin{theorem}[Teorema de Hall (1935)]\label{th:teorema de Hall}
En un $X,Y$-bigrafo, existe un matching que cubre a $X$ si y solo si $S$ cumple la
condición de Hall \eqref{eq:condicion de Hall} para todo $S \subset X$.
\end{theorem}
\begin{proof}
La primera implicación la vimos antes de la definición de condición de Hall.

Veamos la recíproca. Lo haremos por inducción en $\abs X =: n$. Si $n =1$ es trivial. En general, si $n> 1$, queremos
 ver que vale para $n+1$. Hay dos casos:
 \begin{enumerate}
 \item[Caso 1:] $\abs{N(S)}> \abs S$ para todo subconjunto $S \subsetneq X$ no vacío. Tomemos un par de vértices que
 sean
 vecinos $x \in X$ e $y \in Y$, luego consideramos la $X',Y' = X \setminus \{x\}, Y \setminus \{y\}$-bipartición
 proveniente
 de $G$ al eliminar $x,y$; todos los subconjuntos de $X'$ siguen cumpliendo la
 condición de
 Hall,
 luego tiene
  un matching que cubre a $X'$ por hipótesis inductiva, luego
 agregando $xy$
 obtenemos un matching que cubre a $X$ en $G$.
 \item[Caso 2:] Sea $S \supset X$ no vacío tal que $\abs{N(S)} = \abs S$.
 \Dibujo{Ilustración: \red{$S$} y \blue{$N(S)$} tienen el mismo cardinal, pero \blue{$N(S)$} podría tener otros
 vecinos en $X$ además de \red{$S$}. Junto con las \yellow{aristas}, los vértices de \red{$S$} y \blue{$N(S)$}
 forman el grafo inducido $G[S \cup N(S)]$.}
 Sea $G_1$ el grafo inducido por los vértices $S \cup N(S)$, y sea $G_2$ el subgrafo inducido por $G \setminus (S
  \cup N(S))$. Notar que $G_1$ cumple la condición de Hall. Por lo tanto, usando hipótesis inductiva, hay un matching
   en $G_1$ que cubre $S$. Veamos que la condición de Hall se tiene que cumplir también en $G_2$. Consideremos $T \subset X \setminus S$ y notemos que $$N_{G_2} (T) = N_G (T \cup S) \setminus N_G (S).$$ Así tenemos que
   \[
       \abs{N_{G_2}(T)} = \abs{N_G (T\cup S)} - \abs{N_G (S)} \geq \abs{T \cup S} - \abs{ N_G (S)} = \abs{T \cup S} - \abs S = \abs T.
   \]
   Entonces $G_2$ cumple la condición de Hall, luego tiene un matching que cubre a $X \setminus S$ por hipótesis
   inductiva.
   Uniendo los dos
   matchings
    obtenidos, conseguimos un matching que cubre a $X$.
 \end{enumerate}
\end{proof}

\begin{corollary}[König-Frobenius]\label{corollary:König-Frobenius - todo bigrafo regular no trivial tiene un matching perfecto}
Todo $X,Y$-bigrafo $(k \geq 1)$-regular tiene un matching perfecto. En particular $\abs X = \abs Y$.
\end{corollary}
\begin{proof}
    En un $X,Y$-bigrafo $k$-regular $G$, consideramos $S \subset X$. Veamos que $N(S) \geq S$. Antes, notemos que
     la cantidad de aristas que inciden en $S$ es $k \cdot \abs S$. Análogamente, hay $k \cdot \abs{N(S)}$
     aristas que inciden en $N(S)$. Todas las aristas que inciden en $S$ también lo hacen en $N(S)$, pero no son
     las únicas, podría haber más aristas incidentes en $N(S)$ que provienen de vértices de $X \setminus S$. (Pasa lo
      mismo que en la figura anterior.) Es
     decir,
     \[
         k \abs S \leq k \abs{N(S)} \quad \Leftrightarrow \quad \abs S \leq \abs{N(S)}.
     \]
     Como $S\subset X$ era arbitrario, se cumple la condición de Hall, y luego por el Teorema anterior existe un
     matching de $G$ que cubre a $X$.

    De la misma manera, podemos conseguir un matching de $G$ que cubra a $Y$. Consecuentemente, $\abs X = \abs Y$
    y luego el matching es perfecto.
\end{proof}


\subsection{Matchings con preferencias}

En alguna aplicaciones a la vida real, los matchings suelen ser buscados con algún tipo de ``estabilidad''. Más formalmente, sea $(\leq_v)_{v \in V}$ una familia ordenes totales en $E(v)$: el \textbf{conjunto de preferencias} de $G$. Luego diremos que un matching $M$ de $G$ es \textbf{estable} si para toda arista $e \in E \setminus M$, existe una arista $f \in M$ tal que $e$ y $f$ ccomparten un vértice $v$ tal que $e <_v f$.

 \begin{theorem}[El teorema del matrimonio estable - Gale \& Shapley (1962)]
 Para cualquier conjunto de preferencias $(\leq_v)_{v \in V}$ de un $X,Y$-bigrafo $G = (V,E)$. $G$ tiene un matching estable.
 \end{theorem}
 \begin{proof}
 Llamemos a un mataching $M$ de $G$ \textbf{mejor} que un matching $M' \neq M$, si $M$ hace que todos los vérticces de $Y$ más felices que $M'$, más precisamente, si todo vértice $y \in Y$ incidente en una arista $f' \in M'$ es también incidente a algún $f \in M$ tal que $f' \leq_y f$. Construiremos una sucesión de matchings cada vez mejores. Como por cada vértice $y \in Y$, podemos mejorar su felicidad a lo más unas $d(y)$ veces, este procceso debe terminar eventualmente.

Fijado un matching $M$, diremos que un vértice $x \in X$ es \textbf{aceptable} para $y \in Y$, si $e = xy \in E \setminus M$ y para cualquier arista $f \in M$ incidente en $y$ satisface $f <_y e$. Llamemos a $x \in X$ \textbf{feliz con $M$} si $x$ no está cubierto por $M$ o si la arista $f \in M$ que lo cubre satisface $f >_x e$ para toda arista $e = xy$ tal que $x$ es aceptable para $y$.

Empezando con el matching vacío, construimos una sucesión de matchings que hagan felices a todos los vértices en $X$. Dados un matching $M$ que cumple esto, cconsideremos un vértice $x \in X$ que no está cubierto por $M$ pero aceptable para algún $y \in Y$ (Si $x$ no existe, la sucesión termina). Luego agregamos a $M$ la arista $xy$ máxima respecto del orden $\leq_x$ tal que $x$ es aceptable para $y$, y descartemos de $M$ cualquier otra arista de $y$.

Claramente, todo matching en nuestra sucesión es mejor que las anteriores y mantiene a los vértices de $X$ felices, los cuales lo estaban desde el principio pues empezamos con el matching vacío. Con lo cual, la sucesión continua hasta que termina con algún mathinc $M$ que no tiene vvérticces sin cubrir en $X$ que sea aceptable para algún vecino en $Y$. Como todo vértice en $X$ es feliz con $M$, este matching es estable.
\end{proof}


\begin{definition}
Llamamos a un subgrafo $k$-regular generador de un grafo $G$, un \textbf{k-factor}.
\end{definition}

\begin{corollary}[Petersen (1891)]
Todo grafo $2k$-regular ($k \geq 1$) $G$ tiene un $2$-factor.
\end{corollary}
\begin{proof}
Sin perdida de generalidad supongamos que $G$ es conexo. Por el Teorema \ref{th:paseo Euleriano si todos los vertices del multigrafo tienen grado par}, $G$ contiene un paseo Euleriano $v_0 e_0 \cdots e_{\ell -1} v_\ell$ con $v_0 = v_\ell$. Reemplacemos cada vértice $v$ por un par $(v^- , v^+)$, y cada arissta $e_i = v_i v_{i+1}$ por la arista $v_i^+ v_{i+1}^-$. Así obtenemos un grafo bipartito $G'$ que es $k$-regular, con lo cual el Corolario \ref{corollary:König-Frobenius - todo bigrafo regular no trivial tiene un matching perfecto} implica que tenemos un $1$-factor (i.e. un matching perfecto). Colapsando cada par $(v^-,v^+)$ de vuelta a su vértice original $v$, el $1$-factor de $G'$ se convierte en un $2$-factor de $G$.

\Inkscape{Partiendo el vértice $v$ en $v^-$ y $v^+$.}
\end{proof}

\subsection{Relaciones min-máx}

El Teorema de Hall nos dice cuándo podemos encontrar un matching que cubre una de las partes de un grafo bipartito.
Pero quizá, sabiendo que no puedo cubrir ninguna de las partes, igual quiero saber el tamaño máximo de un matching en
 mi grafo.

\begin{notation}
Denotamos por $\alpha ' (G)$ al tamaño máximo de un matching en un grafo $G$ (cantidad de aristas del matching).
\end{notation}

\begin{obs}
En un grafo $G$ con un matching $M$ de tamaño $m$, tenemos que $2 m \leq \abs G$, pues los vértices que cubre cada arista de $M$ son disjuntos por definición de matching. Consecuentemente,
\[
    2 \alpha ' (G) \leq \abs G.
\]
\end{obs}

\begin{definition}
    Para un $X,Y$-bigrafo, el \textbf{defecto} $\defecto{S}$ de un conjunto $S \subset X$ es la cantidad
    \[
        \abs S - \abs{N(S)}.
    \]
\end{definition}

\begin{corollary}[Fórmula del defecto]
En un $X,Y$-bigrafo $G$, se tiene
\[
    \alpha ' (G) = \min_{S \subset X} \{ \abs X - \defecto{S} \}.
\]
\end{corollary}
\begin{proof}
    Todo matching de $G$ no cubre $\defecto{S}$ vértices de $S$, para cualquier subconjunto $S \subset X$ arbitrario. Es
    decir, todo matching tiene a lo más $\abs X - \defecto{S}$ elementos. Así, $$\alpha ' (
    G) \leq \abs X -
    \defecto{S}, \forall S \subset X.$$

    \Dibujo{Visualización: por un lado está $\red{S} \subset X$, y por otro $\blue{N(S)} \subset Y$. En \yellow{
    matching} no cubre $\defecto{S} = \red{5} - \blue{2}$ vértices de $\red{S}$, con lo cual cubre a lo
    más $\abs X - \defecto S = 8 - 2 = 6$ vértices de $X$.}

    Para la otra desigualdad construiremos un matching de tamaño mínimo. Como vimos recién $\alpha ' (G) \leq \abs X - \defecto S, \forall S \subset X$. Si tomamos $d = \max_{S \subset X} \{ \defecto S \}$, en particular tenemos que
    \[
        \alpha' (G) \leq \abs X - d.
    \]
    Luego basta encontrar un matching de tamaño al menos $\abs X - d$. Construyamos un grafo $G'$ añadiendo $d$ vértices a $Y$, cada uno adyacente a todo $X$.
    \Dibujo{Ilustración de $G'$: agregamos en el dibujo \brown{dos vértices} adyacentes a todos los vértices de $X$ (fila superior con vértices \blue{azules} y \yellow{amarillos}). Notar que en este caso \brown{$2$} es el defecto de \yellow{$S$}.}
    El grafo $G'$ cumple la condición de Hall, pues para cada subconjunto $S\subset X$ le añado $d \geq \defecto S$ vecinos nuevos. Con lo cual $G'$ tiene un matching que cubre a $X$. En el peor de los casos, este matching tiene que cubrir a los $d$ vértices nuevos que agregamos a $Y$, es decir, que quitando estos vértices obtenemos un matching con al menos $\abs X - d$ vértices de $X$ cubiertos.
\end{proof}

El tamaño de un matching está acotado por un parámetro ``dual'' natural.
\begin{definition}
Un \textbf{cubrimiento por vértices} es un conjunto de vértices que contiene al menos un extremo de cada arista.

Denotamos por $\beta (G)$ al tamaño mínimo de un cubrimiento por vértices.
\end{definition}
\Dibujo[0.5]{Ejemplo de \purple{cubrimiento por vértices} de un grafo $G$.}
Notar que un cubrimiento obvio, pero poco interesante, de un grafo $G$ es todo el conjunto de vértices $V(G)$.

\begin{obs}
Tenemos que
\[
    \#\{\text{Componentes conexas no trivialdes de $G$}\} \leq \beta (G) \leq \min \{ \abs G , \Abs G \} .
\]
\end{obs}
\begin{proof}
    Por un lado, cada componente conexa no trivial debe tener una arista, que debe ser cubiarte por al menos un vértices. Así se ve la primera desigualdad. Notar que esta cota es tight porque podemos considerar un grafo que sea la unión disjunta de $k$ estrellas de de cualquier cantidad de aristas y $l$ vértices aislados.

    Por otro lado, cada vértice $u$ de un cubrimiento $U$ por vértices de $G$ de tamaño mínimo $\beta (G)$ es extremo de alguna arista $e_u$ cuyo otro extremo está fuera de $U$. Luego si $u y u'$ son distintos, es porque sus aristas $e_u$ y $e_{u'}$ también lo son. Esto nos dice que $G$ tiene al menos $\abs U = \beta (G)$ aristas. Como trivialmente $\abs U \leq \abs G$, se tiene la segunda desigualdad. Notar que esta cota es tight porque podemos considerar a $G$ como la unión disjunta de una cantidad $k$ de $1$-caminos.
\end{proof}

\begin{theorem}[König-Egevary (1931)]
Si $G$ es bipartito, entonces
\[
    \boxed{\alpha'(G) = \beta (G).}
\]
\end{theorem}

\begin{Remark}
\begin{enumerate}
\item En todo grafo (no necesariamente bipartito) se cumple \[ \alpha' (G) \leq \beta (G).\]
En efecto, tomemos un cubrmiento de tamaño mínimo $\beta (G)$, dados un matching de $G$, toda arista del matching cubre a algún vértice del cubrimiento, pero dadas dos aristas distintas del matching, no tienen el mismo vértice del cubrmiento pues no son adyacentes.
\item El Teorema de König-Egevary nos garatinza que en un grafo bipartito podemos demostrar la optimalidad de un matching al encontrar un cubrimiento por vértices del mismo tamaño (y viceversa).
\end{enumerate}
\end{Remark}

\begin{proof}[Teorema]\red{Puede entrar en el control}
Sea $G$ un $X,Y$-bigrafo. Ya vimos una de las desigualdades, ahora veamos la otra. Vamos a buscar un cubrimiento por vértices, de tamaño $\alpha' (G)$. La fórmula del defecto nos dice que $\alpha' (G) = \min_{S \subset X} \{ \abs X - \defecto S \}$, tomando $T \subset X$ que realice el mínimo:
\[
    \alpha ' (G) = \abs X - \defecto T = \abs X - \abs T + \abs{ N(T)} = \abs{X \setminus T} + \abs {N(T)}.
\]
\Dibujo{Inspiremonos con el dibujo. Del lado \blue{$X$} tenemos a \yellow{$T$}, y del lado \red{$Y$} tenemos \yellow{$N(T)$}.}
Un cubrimiento por vértices de tamaño $\alpha ' (G)$ es entonces $(X \setminus T) \cup N(T)$, luego el cubrmiento mínimo debe ser $\beta (G) \leq \alpha ' (G)$.
\end{proof}

Como corolario, este teorema nos dice que en un bigrafo encontrar un mátching máximo, o un cubrimiento por vértices mínimo son problemas de optimizasción duales.

\begin{exercise}
Calcular $\alpha ' (K_n)$ para todo $n \geq 3$. (Notar que $\alpha ' (K_2) = 1$).
\end{exercise}
\begin{solution}
Vamos a probar por inducción que
\begin{equation}\label{eq:ejercicio random 1}
    \alpha ' (K_{n+1}) = \alpha ' (k_{n}) + 1, \quad \forall n \geq 3.
\end{equation}
Esto, junto con el hecho de que $\alpha ' (K_3) = 1$, prueba la afirmación:
\[
    \alpha ' (K_n) = n-2, \quad \forall n \geq 3.
\]

Claramente vale \eqref{eq:ejercicio random 1} para $n = 3$. En general, tomando un vértice $x \in K_{n+1}$ y considerando $K_n = K_{n+1} \setminus \{x \}$ se ve por inducción que agregando una arista incidente a $x$ a un matching de $K_n$ de tamaño $\alpha ' (K_n)$, obtenemos un matching de $K_{n+1}$ una unidad mayor, i.e. $\alpha ' (K_n) + 1 \leq \alpha ' (K_{n+1})$. Por otro lado, un matching de $K_{n+1}$ de tamaño $\alpha ' (K_{n+1})$ se convierte en un matching de $K_n$ si quitamos un vértice de $K_{n+1}$ cubierto por él, i.e. $\alpha ' (K_{n+1}) - 1 \leq \alpha ' (K_n)$. Probando así la igualdad \eqref{eq:ejercicio random 1}.
\end{solution}

\bigskip

Veamos otro par de problemas duales.

\begin{definition}
El \textbf{número de independencia} de un grafo $G$ es el tamaño máximo de un conjunto independiente de vértices en $G$. Denotamos a esta cantidad $\alpha (G)$.
\end{definition}
Notar que $\alpha ' (G) = \alpha (L(G))$, es decir que independencia de vértices y matchings son conceptos \textit{duales}.

En un $X,Y$-bigrafo, ambas partes $X,Y$ son conjuntos independientes, pero podría pasar que $\alpha (G) > \max \{ \abs X, \abs Y \}$:
\Dibujo{Ejemplo.}

\begin{obs}
Si $S$ es un conjunto de vértices independientes de tamaño máximo $\alpha (G)$, se tiene todo vértice en $V(G) \setminus S$ es adyacente a algún vértice de $S$. Luego
\[
    \abs G - \alpha (G) \leq \Abs G \quad \Leftrightarrow \quad \abs G - \Abs G \leq \alpha (G).
\]
Pero en la mayoría de los casos no nos dice nada, pues el lado izquierdo es negativo.
\end{obs}

\begin{definition}
Un \textbf{cubrimiento por aristas} de $G$ es un conjunto de aristas tal que todo vértice de $G$ es extremo de alguna arista en el conjunto. Notemos a esta cantidad $\beta ' (G)$.
\end{definition}
Notar que lo más inocente que uno podría intentar hacer en un grafo $G$ para encontrar un cubrimiento por aristas, es elegir el conjunto de todas las aristas $E$, sin embargo, si $G$ tiene vértices aislados entonces no hay cubrimiento! (En este caso definimos $\beta ' (G) := \infty$). Es decir, solamente los grafos sin vértices aislados tienen cubrimiento por aristas.

\begin{obs}
Tenemos que
\[
    \abs G / 2 \leq \beta ' (G) \leq \abs G - \#\{\text{ componentes conexas de $G$}\}.
\]
\end{obs}
\begin{proof}
Sea $S$ un cubrimiento por aristas de $G$ de tamaño mínimo $\beta ' (G)$. Por minimalidad de $S$, ambos extremos de una arista de $S$ no pueden tener otras aristas incidentes de $S$, luego en el peor de los casos, se necesitan $\abs G -1$ aristas para cubrir $G$. Luego $\beta ' (G) \leq \abs G -1$. Este argumento se puede luego aplicar a cada componente de $G$, pues un cubrimiento de $G$ es la unión disjunta de los cubrimientos de sus componentes. Esta cota es tight porque podemos considerar un grafo que sea la unión disjunta de $k$ estrellas de grado $n$.

Por otro lado, por cada arista $e \in S$ cubrimos a lo más dos vértices, luego en el por de los casos $\abs G / 2 \leq \abs S = \beta ' (G)$.
\end{proof}

\begin{exercise}
Probar que $\alpha (G) \leq \beta ' (G)$.
\end{exercise}
\begin{solution}
Claramente si $G$ tiene puntos aislados la desigualdad se cumple trivialmente. Tomemos un conjunto $U$ de vértices de $G$ que son aislados de tamaño máximo $\alpha (G)$. Consideremos un conjunto de aristas $F$ de $G$ de tamaño mínimo que cubre a $G$. Todo vértice $x$ de $U$ es extremo de una arista de $F$, más aún, dos vértices distintos de $U$ no pueden compartir la misma arista porque no son adyacentes, luego $\alpha (G) = \abs U \leq \abs F =  \beta ' (G)$.
\end{solution}

\begin{theorem}[König (1916)]
Si $G$ es bipartito sin vértices aislados
\[
    \boxed{\alpha (G) = \beta ' (G) .}
\]
\end{theorem}
\begin{proof}
El ejercicio anterior prueba una desigualdad. Para probar la otra desigualdad basta encontrar un cubrimiento por aristas de tamaño $ \leq \alpha (G)$. Tomemos un conjunto de vértices independiente $U$ de tamaño máximo $\alpha (G)$. Por maximalidad, cualquier vértice de $V(G) \setminus U$ es adyacente a un vértice de $U$. Es decir, el conjunto $F$ de aristas que inciden en $U$ cubre $G$. Sin pérdida de generalidad, supongamos que $F$ es minimal. Veamos que por cada vértice de $u \in U$ hay a lo más una arista incidente; como consecuencia se sigue que $\abs F \leq \alpha (G)$ como queríamos encontrar. En efecto, de lo contrario, si $u$ tuviera dos vecinos distintos $v,v'$ en el complemento de $U$ (digamos $u \in X$ y $v,v \in Y$), por minimalidad de $F$ debe ser que $v$ y $v'$ no tienen otro vecino en $U$ que no sea $u$. Luego llegamos a un absurdo construyendo un conjunto de vértices independiente más grande: $U\setminus \{u\} \cup \{v,v'\}$.
\end{proof}




\subsection{Ejercicios}

\begin{exercise}
\begin{enumerate}[(a)]
\item Si $M$ es un matching en un grafo $G$ tal que $\abs M < \delta (G) / 2$, entonces $M$ no es máximo. Concluya que $\alpha ' (G) \geq \delta (G)/2$ para todo grafo $G$.
\item Demuestre para todo grafo $G$ bipartito, $\alpha ' (G) \geq \delta (G)$.
\item En cada caso, encontrar una familia infinita de grafos donde se cumple la igualdad.
\end{enumerate}
\end{exercise}
\begin{solution}
\begin{enumerate}[(a)]
\item Esto equivale a probar que todo grafo $G$ tiene un matching the tamaño al menos $\lceil \delta (G)/2 \rceil$. En efecto, sabemos que todo grafo contiene un camino de longitud $\geq \delta (G)$, luego en ese camino podemos construir un matching obvio de longitud $\geq \lceil \delta (G) /2 \rceil \geq \delta (G)/2$: elegimos la primera arista (en un orden natural inducido por el camino) y luego la siguiente arista no adyacente más cercana, y repetimos el procedimiento de manera recursiva. (En un camino de longitud $n = 2k$ este algorítmo construye un matching de tamaño $k$, y en un camino de longitud $n = 2k +1$ construye uno de tamaño $k+1$). Esto implica que $\alpha ' (G) \geq \delta (G) /2$.
\item En un $X,Y$-bigrafo. Tomemos $y_0 \in Y$. Como $y$ tiene $d(y) \geq \delta (G)$ vecinos en $X$, sabemos que $X$ tiene al menos $\delta (G)$ vértices. Tomemos un subconjunto $T \subset X$ de tamaño $\delta (G)$ (por ejemplo los vecinos de $y$). Notemos que $T$ cumple la Condición de Hall. En efecto, para todo $S \subset T$ no vacío, sabemos que cualquier vértice de $S$ tiene al menos $\delta (G)$ vecinos, en particular
$$\abs {N(S)} \geq \delta (G) = \abs T \geq \abs S .$$
Con lo cual, el Teorema de Hall no dice que existe un matching de $G$ que cubre a $T$, es decir, un matching con $\abs T = \delta (G)$ aristas. Consecuentemente $\alpha ' (G) \geq \delta (G)$.
\item
        \begin{enumerate}[(a)]
        \item Consideremos la familia $G_k = (P_{2k})^{2k}$, es decir, la familia de las $2k$-potencias de caminos de longitud $2k$ con $k \in \naturals$. Recordar que la $i$-potencia de un grafo $G$ es un grafo con los mismos vértices pero donde dos vértices son adyacentes si y solo si estaban a distancia a lo más $i$ en $G$. Afirmamos que $\delta (G_k) = 2k$ y que $\alpha ' (G_k) = k$. Numerando a los vértices de $P_{2k} : x_0 x_1 \cdots x_{2k}$, tenemos que claramente $x_i$ es adyacente a $x_j$ en $G_k$, para todo $0 \leq i, j \leq 2k$, luego $G_k$ es $2k$-regular, en particular $\delta (G_k) = 2k$. Ahora, notemos que el conjunto de aristas de $G_k$ dado por $\{ e_i\}_{i = 1}^k$ con $e_i = x_{2i-1}x_{2i}$ es un matching de $G_k$ con $k$ aristas. Esto nos dice que $\alpha ' (G) \geq k$. Por otro lado, observemos que un grafo $G$ arbitrario, con un matching de $r$ aristas, se tiene que $2 r \leq \abs G$, pues el matching cubre $2 r$ vértices distintos, con lo cual $2 \alpha ' (G) \leq \abs G$. Aplicando esta observación a $G_k$, se sigue que $\alpha ' (G_k) \leq \abs {G_k}/2 = k$. En resumen, hemos visto que $\alpha ' (G_k) = k = \delta (G_k)/2$ para todo $k \in \naturals$.
        \item Consideremos ahora la familia $G_k = K_{k,k}$ de grafos bipartitos completos con dos particiones de $k$ elementos, para $k \in \naturals$. $G_k$ es $k$-regular, en particular $\delta (G_k) = k$. Por otro lado, vimos en el ítem (b) que $\alpha ' (G_k) \geq \delta (G_k) = k$. Veamos que no puede haber un matching con más de $k$ aristas. En efecto, todo matching de $G_k$ cubre a lo más $k$ vértices en una de las particiones de $K_{k,k} = G_k$. Esto concluye la demostración de que $\alpha ' (G_k) = k = \delta (G_k)$, para todo $k \in \naturals$.
        \end{enumerate}
\end{enumerate}
\end{solution}


\begin{exercise}
Demuestre que un grafo $G$ es bipartito si y solo si $\alpha ' (H) = \beta (H)$ para todo subgrafo $H$ de $G$.
\end{exercise}
\begin{solution}
En clase vimos la demostración del Teorema de König-Egevary, que dice que vale la igualdad $\alpha ' (G) = \beta (G)$ para todo grafo bipartito $G$, luego como todo subgrafo $H$ de $G$ es también bipartito, salvo por el subgrafo trivial donde no hay nada que probar, se tiene una de las implicaciones del ejercicio.

Veamos la recíproca, es decir, veamos que si un grafo $G$ cumple la igualdad para todo subgrafo $H$ de $G$, entonces es bipartito. En efecto, supongamos por el absurdo que $G$ no es bipartito, i.e. $G$ contiene un ciclo impar $H$. Llegaremos a un absurdo si logramos probar que para todo ciclo impar, no se cumple la igualdad del enunciado.

Así es, pues si escribimos $C: x_0 \cdot x_1 \cdot x_2 \cdots x_{2k} \cdot x_0$ para cualquier ciclo impar con $k \geq 1$, entonces $\beta (C) = k+1$ ya que los vértices de índice par cubren todas las aristas y con $k$ vértices no se pueden cubrir todas las aristas, pues cada vértice cubre $2$ aristas de $C$ pero $C$ tiene $2k+1$ aristas; por otro lado, sabemos que en todo grafo $\alpha ' (C) \leq \beta (C)$, entonces basta ver que no hay un mathcing en $C$ de tamaño $k+1$: como notamos en el ejercicio anterior, en un matching con $r = k+1$ aristas, $2 r \leq \abs C = 2k +1$, imposible. Esto prueba que $G$ no puede tener ciclos impares.
\end{solution}


\begin{exercise}
Sea $G$ un $X,Y$-bigrafo tal que $\abs X = \alpha (G)$, donde $\alpha (G)$ es el tamaño máximo de un conjunto de vértices independiente de $G$. Demuestre que $G$ tiene un matching que cubre a $Y$.
\end{exercise}
\begin{solution}
Notemos primero que la igualdad $\abs X = \alpha (G)$ nos dice que $\abs Y \leq \abs X$, ya que $Y$ también es un conjunto independiente. Para probar que $G$ tiene un matching que cubre a $Y$, esto equivale a probar que todos los subconjuntos de $Y$ cumplen la Condición de Hall. En efecto, supongamos por el absurdo que no, es decir, existe un subconjunto $S \subset Y$ no vacío de tamaño mínimo tal que no cumple la condición de Hall. Claramente $\abs S > 1$, pues si no $S = \{y\}$ con  $y$ sin vecinos en $X$, pero luego $X \cup S$ es independiente y $\alpha (G) > \abs X$. Ahora tomemos $y \in S$, y notemos $S' = S \setminus \{y \} \neq \emptyset$. Por minimalidad de $S$, el conjunto $S'$ cumple la condición de Hall, i.e. existe un matching de $G$ que cubre a $S'$; más aún, $\abs {N(S')} = \abs {S'} $, de lo contrario $S$ cumpliría la condición de Hall. Consideramos ahora el conjunto $X \setminus N(S') \cup S = X \setminus N(S') \cup S' \cup \{y\}$ de $G$ de tamaño $\abs X +1$. Por hipótesis, no puede ser independiente, y por construcción, debe ser que $y$ tiene un vecino en $X \setminus N(S')$, es decir, $\abs {N (S)} \geq \abs{N(S')} + 1 = \abs {S'} + 1 = \abs S$, lo cual es imposible porque $S$ no cumplía la condición de Hall.
\end{solution}



%%%%%%%%%%%
\Clase{8/05/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%



\begin{proposition}
Tenemos la fórmula
\[
    \boxed{\alpha (G) + \beta (G) = \abs G.}
\]
\end{proposition}
\begin{proof}
Tomemos un conjunto $U$ de vértices independiente de tamaño máximo $\alpha (G)$. Sea $W := V(G) \setminus U$, tenemos que todos los vértices de $W$ son adyacentes a algún vértice de $U$ por maximalidad. Notar que $W$ debe ser un cubrimiento de $G$ porque no hay aristas con ambos extremos en $U$. Con lo cual
\[
    \alpha (G) + \beta (G) \leq \alpha (G) + \abs W = \abs G.
\]

Recíprocamente, tomemos un cubrimiento por vértices $S$ de $G$ de tamaño mínimo $\beta (G)$. Por minimalidad de $G$ tenemos que el conjunto $T := V(G) \setminus S$ es independiente. Es decir,
\[
    \abs G = \abs T + \beta (G) \leq \alpha (G) + \beta (G).
\]
\end{proof}

Análogamente:
\begin{proposition}
Si $G$ no tiene vértices aislados:
\[
    \boxed{\alpha ' (G) + \beta ' (G) = \abs G .}
\]
\end{proposition}
\begin{proof}
Sea $S$ un matching de tamaño máximo $\alpha ' (G)$ en $G$. Consideremos $U$ el conjunto de vértices de $G$ que no son cubiertos por $S$, i.e. $\abs U = \abs G - 2 \alpha ' (G)$. Por maximalidad de $S$, todas las aristas incidentes a un vértice $u \in U$ deben tener su otro extremo en $W = V(G) \setminus U$. Por cada vértice de $U$, tomemos una de estas aristas. Luego este conjunto de aristas junto con $S$ cubren a $G$, i.e.
\[
    \beta ' (G) \leq \abs S + \abs U = \alpha ' (G) + (\abs G - 2 \alpha ' (G)) = \abs G - \alpha ' (G),
\]
obteniendo así una desigualdad.

Para obtener la otra, consideremos un conjunto $S$ de aristas que cubren a $G$ de tamaño mínimo, consideremos también a $S'$ matching de $G$ compuesto de aristas de $S$ de tamaño más grande. Sea $U'$ el conjunto de vértices cubiertos por $S'$, i.e. $\abs {U'} = 2 \abs {S'}$. Tomemos $U = V(G) \setminus U'$, este es cubierto por una única arista de $S \setminus S'$. En efecto, sea $u \in U$, está cubierto por una arista de $S$ que no puede estar en $S'$ por definición de $U$, y de hecho si hubiera otra arista de $S$ incidente en $u$, entonces cualquier otro extremo que no sea $u$ tiene que estar cubierto por $S'$, de lo contrario podríamos agrandar $S'$ agregando esta arista (contradiciendo maximalidad de $S'$), pero esto es imposible por minimalidad de $S$ (podríamos quitar esta arista y seguiriamos teniendo un cubrimiento de $G$). Con lo cual, $\abs {U} \leq \abs {S \setminus S'} = \abs S - \abs {S'}$. Juntando todo:
\[
    \abs G = \abs U + \abs {U'} \leq \abs S + \abs {S'} = \beta ' (G) + \abs {S'} \leq \beta ' (G) + \alpha ' (G),
\]
pues $S'$ es un matching de $G$.
\end{proof}



\subsection{Caminos aumentantes}


\begin{definition}
Dado un matching $M$ de un grafo $G$. Llamamos \textbf{camino $M$-alternate} a un camino de $G$ que alterna entre aristas de $M$ y aristas de $E(G) \setminus M$.

Un camino camino $M$-alternante cuyos vértices extremos no están cubiertos por $M$ se llama \textbf{$M$-aumentante}.
\end{definition}

\Dibujo{Ejemplo de camino \red{$M$}-aumentante: $1,2,3,4,5,6,7,8$.}

Si $P$ es un camino $M$-aumentante, entonces reemplazando las aristas de $M$ que están en $P$ por las aristas de $E(G) \setminus M$ en $P$ obtenemos un nuevo matching $M'$ de tamaño estrictamente mayor a $M$. De aquí el nombre ``aumentante''. Así, un matching máximo $M$ no tiene caminos $M$-aumentantes. Más aún, vale la recíproca:

\begin{theorem}[Berge (1957)]
Sea $M$ un conjunto de aristas en un grafo $G$. $M$ es un matching de tamaño máximo si y solo si $G$ no tiene caminos $M$-aumentantes.
\end{theorem}
\begin{proof}
Acabamos de observar una de las implicaciones, veamos la vuelta. Supongamos que sí hay un matching $M'$ de tamaño estrictamente más grande que un matching $M$ sin caminos $M$-aumentantes. Sea $F = M \Delta M'$ la diferencia simétrica entre estos dos conjuntos. Como $M$ y $M'$ son matchings, cada vértice incide en a lo más una arista de $M$ y una de $M'$. Así, $\Delta (H) \leq 2$ si vemos a $F$ como un grafo $H := (V(G), F)$. Entonces $H$ es unión disjunta de ciclos y caminos.
    \Dibujo{Ilustración de $H$, donde por un lado tenemos las aristas de \red{$M \setminus M'$} y las de \blue{$M' \setminus M$}.}
    Cada componente de $H$ alterna entre $M$ y $M'$, y por lo tanto sus ciclos son pares. Al tener $\abs{M'} > \abs M$ tiene que haber en $H$ una componente que no es ciclo. Más aún, alguna de las componentes que no son ciclos tiene que tener más aristas de $M'$ que de $M$. Por lo tanto, hay una componente que es camino que empieza y termina con aristas de $M'$. Esta componente nos da un camino $M$-aumentante, lo cual es imposible.
\end{proof}

\begin{obs}\label{obs}
En general, sea $G$ un grafo con un matching máximo $M$, y sea $U$ el conjunto de vértices de $G$ que no están cubiertos por $M$. Luego si $u \in U$, implica que todos los vecinos de $u$ están cubiertos por $M$.
\end{obs}
\begin{proof}
En efecto, pues de lo contrario, si $u ' \in U$ es un vecino de $u$, agregando la arista $uu'$ a $M$ obtendríamos un matching más grande.
\end{proof}

\begin{exercise}
Sea $G$ un grafo con grado máximo $\Delta (G) = k$. Sea $M$ un matching máximo de $G$. Para $k \geq 3$, demuestre que el número de aristas que une vértices cubiertos por $M$ a vértices no cubiertos por $M$ es a lo más $(k-1) \abs M$.
\end{exercise}

\begin{solution}
Sea $S$ el conjunto de aristas que unen vértices cubiertos por $M$ a vértices no cubiertos por $M$. Llamemos $U$ al conjunto de vértices que no están cubiertos por $M$. Tenemos que para todo $u \in U$ los vecinos de $u$ son todos vértices cubiertos por $M$ por la Observación \ref{obs}.

\begin{definition}
Sea $u \in U$ con $U$ como recién. Sea $e$ una arista de $M$ que tiene uno de sus extremos vecino a $u$. Si $e$ tiene alguno de sus extremos adyacente a $u$, diremos que $e$ es \textbf{vecina} de $u$ y diremos que $u$ es \textbf{vecino} de $e$. Diremos que $u$ es \textbf{compañero} de $e$ si es adyacente a ambos extremos de $e$. De lo contrario, diremos que es \textbf{no compañero}, y notaremos como $x_u$ al único vértice de $e$ adyacente a $u$.
\end{definition}

\begin{lemma}
Para $e \in M$ fijo pueden ocurrir dos casos disjuntos:
\begin{enumerate}
\item $e$ tiene solamente un único vecino en $U$, el cual es compañero de $e$.
\item Todos los vecinos $u \in U$ de $e$ son \textit{no compañeros} ($e$ podría no tener vecinos en $U$) adyacentes a un único extremo de $e$.
\end{enumerate}
\end{lemma}
\begin{proof}
Supongamos que $e \in M$ tiene algún vecino $u \in U$. Si $u$ es el único vecino, o estamos en el primer caso o estamos en el segundo. Si $u$ no es único, es decir, existe otro vértice $v \in U$ vecino de $e$, entonces si o si $u$ y $v$ deben ser ambos adyacentes al mismo vértice $x$ o $y$, donde $e = xy$. En efecto, de lo contrario si $u$ es adyacente a $x$ y $v$ es adyacente a $y$, entonces como $u,v$ no son extremos de ninguna arista de $M$, reemplazando la arista $e \in M$ por las aristas $xu$ e $yv$, obtenemos un matching más grande que $M$, absurdo. Esta misma demostración prueba que $u$ y $v$ no pueden tener más de un vecino que sea extremo de $e$, es decir, ambos son no compañeros. Con lo cual, si aplicamos este razonamiento a todos los vecinos de $e$ en $U$, deben ser todos no compañeros y adyacentes a un único extremo de $e$, i.e. estamos en el segundo caso.

Es claro que estos dos casos son disjuntos.
\end{proof}

El lema anterior nos permite contar de la siguiente manera: para cada $e \in M$ nos fijamos si estamos en el caso 1. o en el caso 2. En el primer caso contamos solamente un vecino de $e$ en $U$, i.e. $2 \leq k-1$ aristas de $S$. En el segundo caso, todos los vecinos de $e =xy$ en $U$ son adyacentes a un único extremo $x$ o $y$, digamos $x$, luego $e$ puede tener a lo más $k-1$ vecinos en $U$ (no contamos a $y$), i.e. contamos $\leq k-1$ aristas de $S$. Juntando ambos casos disjuntos, nos queda que $\abs S \leq (k-1) \abs M$.
\end{solution}




\begin{exercise}
Dos personas juegan un juego en un grafo: se alternan para elegir vértices $v_1,v_2, \ldots$ de modo que para todo $i \geq 2$, el vértice $v_i$ es adyacente al veŕtice $v_{i-1}$ y no ha sido escogido antes. El último jugador capaz de escoger un vértice gana.
\begin{enumerate}[(a)]
\item Demuestre que el segundo jugador tiene una estrategia ganadora si el grafo tiene un matching perfecto.
\item Demuestre que el primer jugador tiene una estrategia ganadora si el grafo no posee un matching perfecto.
\end{enumerate}
\end{exercise}
\begin{solution}
\begin{enumerate}[(a)]
\item Sea $M$ un matching perfecto de $G$. Afirmo que la estrategia ganadora del segundo jugador es elegir el extremo opuesto de la arista de $M$ cuyo extremo ha sido escogido por el primer jugador en el anterior turno. En efecto, supongamos que esta estrategia falló. Es decir, ocurrió una cantidad impar elecciones de vértices de $G$: $v_1, v_2, v_3, v_4, \ldots, v_{2k -1}$ para algún $k \in \naturals$ y $v_{2k-1}$ no tiene vecinos sin visitar. (Notar que $k \geq 2$, pues el grafo está cubierto por un conjunto de aristas no vacío $M$). Ahora, la estrategia del segundo jugador implica que las aristas $e_1 := v_1 v_2, e_2 := v_3 v_4 , \ldots, e_{k-1} := v_{2k-3} v_{2k-2}$ pertenecen al matching $M$. Luego $v_{2k-1}$ pertenece a una arista de $M$ distinta de $e_1, \ldots, e_{k-1}$, es decir, $v_{2k-1}$ tiene un vecino distinto sin escoger: el extremo opuesto de una arista de $M$ que cubre a $v_{2k-1}$, absurdo. Con lo cual, esta era una estrategia ganadora para el segundo jugador.

 \item Sea $M$ un matching máximo de $G$, con $G$ sin matching perfecto. Sea $U$ el conjunto de vértices de $G$ que no están cubiertos por $M$. Notemos por $U_k$ al conjunto de vértices que no están cubiertos por las aristas de $M_k := M \cap E(G_k)$, donde $G_k$ es el grafo obtenido a partir de $G$ luego quitar todos los vértices escogidos por ambos jugadores previos al $k$-ésimo turno del primer jugador.
  La estrategia del primer jugador será siempre elegir un vértice de $U_k$ en su $k$-ésimo turno. A priori no sabemos que siempre se pueda escoger un vértice de $U_k$. Sin embargo, veremos que efectivamente se puede. Más precisamente, probaremos por inducción la afirmación más fuerte:

\begin{proposition}\label{proposicion}
Para todo $k \geq 1$, se tiene que si el primer jugador no ganó en su $(k-1)$-ésimo turno, entonces
\begin{enumerate}[(i)]
\item $M_k$ es un matching máximo de $G_k$;
\item Todos los vecinos de cualquier elemento $u$ de $U_k$ están cubiertos por una arista de $M_k$.
\item El primer jugador puede escoger un vértice de $U_k$ en su $k$-ésimo turno.
\end{enumerate}
\end{proposition}

Necesitamos un lema previo:

\begin{lemma}\label{lema}
 En general, si $M$ es un matching máximo de un grafo $G$, y $x$ es un extremo de una arista $e$ de $M$, e $y$ es un vértice adyacente a $x$ que no está cubierto por $M$. Entonces el grafo $G' = G \setminus \{x,y\}$ tiene a $M' = M \cap E(G')$ como matching máximo.
\end{lemma}
\begin{proof}
 Supongamos que no, es decir que existe un matching $W$ de $G'$ con más aristas que $M'$, es decir $\abs {M'} \leq \abs W - 1$. Notar que $\abs {M'} = \abs M - 1$ porque borramos dos véŕtices $x,y$: donde $x$ solamente es extremo de una arista de $M$ por ser un matching, e $y$ no era extremo de ninguna arista de $M$ por cómo lo elegimos. Esto implica que $\alpha ' (G) - 1 \leq \abs W - 1$. Luego como $W$ también es un matching de $G$, debe ser que $\abs W \leq \alpha ' (G)$, con lo cual $\alpha ' (G) = \abs W$ y $W$ es un matching máximo de $G$. Sean $x$ y $e \in M$ como al principio. Por construcción de $W$, tenemos que $e = xy$ no está en $W$, más aún, esta arista es independiente de $W$, luego $W \cup \{e \}$ es un matching de $G$ de tamaño $\alpha ' (G) + 1$, absurdo. Esto prueba que $M'$ es un matching máximo de $G'$.
\end{proof}

Estamos ahora en condiciones de probar la Proposición \ref{proposicion}:
\begin{proof}
Si $k = 1$, como $M_k = M$, $G_k = G$ y $U_k = U$, no hay nada que probar en (i); (ii) se sigue inmediatamente de la Observación \ref{obs}; (iii) se sigue de que $G_k$ no tiene matching perfecto. En general, si el primer jugador no ganó en su $k$-ésimo turno, $M_{k+1}$ es igual a $M_k \cap E(G_{k+1})$, donde notemos que $G_{k+1} = G_k \setminus \{x_k, y_k\}$, y $x_k$ es el vértice escogido por el primer jugador en el $k$-ésimo turno $y_k$ el vértice (adyacente) escogido subsecuentemente por el segundo jugador, más aún, por hipótesis inductiva $x_k \in U_k$ es un vértice no cubierto por el matching máximo $M_k$ de $G_k$, con lo cual $y_k$ es adyacente a $x_k$ y está cubierto por una arista de $M_k$ y luego por el Lema \ref{lema} $M_{k+1}$ es un matching máximo de $G_{k+1}$. Esto prueba (i). Por la Observación \ref{obs}, los vecinos de todo $u \in U_{k+1}$ tienen que estar cubiertos por el matching máximo $M_{k+1}$, probando así (ii). Como $y_k$ esta cubierto por una arista de $M_k$, el otro extremo de esta arista puede ser escogido por el primer jugador, y además debe estar en $U_{k+1}$, pues la única arista de $M$ que incide en este extremo fue eliminado de $G_k$ (recordar que $M_{k+1} = M_k \cap E(G_k) = M \cap E(G_{k+1})$). Así, se sigue (iii).
\end{proof}

Finalmente, el último ítem de la Proposición \ref{proposicion} dice que si el primer jugador no ganó en su $k$-ésimo turno, luego puede escoger un vértice en su $(k+1)$-ésimo turno. Esto significa que el primer jugador siempre va a ser el último en escoger un vértice, es decir, cuando el juego eventualmente termine, el primer jugador ganará: la estrategia es ganadora.
\end{enumerate}
\end{solution}

\subsection{Matchings en grafos generales}

Dados un grafo $G$ llamemos $\mathcal C _G$ al conjunto de componentes conexas, y por $q(G)$ al número de sus componentes de orden impar. Si $G$ tiene un matching perfecto $M$, luego claramente tenemos
\begin{equation}\label{eq:condicion de Tutte}
q(G \setminus S) \leq \abs S \quad \forall S\subset V(G),
\end{equation}
ya que toda componente impar de $G \setminus S$ tiene que mandar una arista de $M$ en $S$: por paridad una de las aristas de $M$ tiene un extremo en la componente impar y el otro en $S$; claramente dos compoenentes no pueden estar asociadas de esta manera a un mismo vértice de $S$ porque $M$ es un matching.
\Inkscape[0.6]{Ilustración de la condición de Tutte, de un conjunto \yellow{$S$} con \green{$q(G \setminus S) = 3$} componentes impares en $G\setminus S$, luego se cumple la condición de Tutte pues \yellow{$\abs S = 5$}.}

Diremos que la ecuación \eqref{eq:condicion de Tutte} es la \textbf{condición de Tutte}. De hecho se tiene que esta condición es necesaria y suficiente:

\begin{theorem}[Tutte (1947)]\label{th:teorema de Tutte}
Un grafo $G$ tiene un matching perfecto si y solo si
\[
    q(G\setminus S) \leq \abs S \quad \forall S \subset V(G),
\]
es decir, se cumple la condición de Tutte \eqref{eq:condicion de Tutte} para todo $S \subset V(G)$.
\end{theorem}
\begin{proof}
Recien vimos una implicación, con lo cual nos resta ver la implicación recíproca. Por el absurdo, supongamos que $G= (V,E)$ es un grafo sin matching perfecto, y supongamos que es arista-maximal con esta propiedad: esto es posible pues si $G'$ se obtiene a partir de $G$ agregando aristas y $S \subset V$ no cumple la condición de Tutte en $G'$, luego $S$ tampoco lo cumple en $G$, pues toda componente impar de $G' \setminus S$ es la unión de las componentes impares de $G \setminus S$, o sea que una de estas debe ser impar.

Ahora, claramente si $G$ contiene un conjunto $S$ que no cumple la condición de Tutte, luego por arista-maximalidad y de la implicación del teorema que ya probamos:
\begin{afirmacion}
Todas las componentes de $G \setminus S$ son completas y todo vértice $s \in S$ es adyacente a todos los vértices de $G \setminus s$.
\end{afirmacion}
Pero recíprocamente, si un conjunto $S \subset V$ satisface la afirmación anterior, entonces $S$ o el conjunto vacío deben violar la condición de Tutte: Si $S$ no viola la condición de Tutte, podemos unir las componentes impares de $G \setminus S$ de manera disjunta con $S$ y emparejar a todos los vértices restantes formando un matching perfecto, salvo que $\abs G$ sea impar, en cuyo caso $\emptyset$ no cumple \eqref{eq:condicion de Tutte}.

Con lo cual, si probamos que $G$ contiene un subconjunto $S$ que cumple la afirmación llegaremos a un absurdo. Sea $S$ el conjunto de vérticees que son adyacentes a todo otro vértice. Si $S$ no cumple la afirmación, es porque alguna componente de $G\setminus S$ tiene dos vértices $a,a'$ no adyacentes. Sean $a,b,c$ los primeros tres vértices en algún $a$-$a'$ camino de longitud mínima dentro de esta componente; entonces $ab,bc \in E$ pero $ac \not \in E$. Como $b \not \in S$, existe un vértice $d \in V$ tal que $bd \not \in E$. Por maximalidad de $G$, existe un matching $M_1$ que cubre $V$ en $G+ ac$, y otro matching $M_2$ que cubre a $V$ en $G + bd$.

\Inkscape[.8]{Ver la pagina 42 para una ilustración de la contradicción.}

Sea $P = d \cdots v$ un camino maximal en $G$ que empieza en $d$ con una arista de $M_1$ y que contiene alternadamente aristas de $M_1$ y $M_2$ como se ve en el dibujo de arriba. Si la última arista de $P$ se encuentra en $M_1$, entonces $v = b$, pues si no podríamos continuar $P$ y obtener un camino $M_2$-aumentante en $G + bd$. Escribamos entonces $C := P + bd$ en este caso. Por otro lado, si la última arista de $P$ yace en $M_2$, entonces por maximalidad de $P$ la $M_1$-arista en $v$ debe ser $ac$, con lo cual $v \in \{a, c \}$; en este caso escribamos $C:= d P v b d$. En cualquier caso, $C$ es un ciclo par donde las aristas se alternan afuera y adentro de $M_2$, y con su única arista fuera de $E$ es $bd$. Reemplazando en $M_2$ sus aristas en $C$ por las aristas de $C \setminus M_2$, obtenemos un matching perfecto de $G$ contenido en $E$, absurdo.
\end{proof}

\begin{corollary}
Todo grafo $G = (V,E)$ $3$-regular sin puentes tiene un matching perfecto.
\end{corollary}
\begin{proof}
Por el Teorema de Tutte, basta ver que todo $S \subset V$ cumple la condición \eqref{eq:condicion de Tutte}. En efecto, consideremos las componentes impares $C$ de $G\setminus S$. Como $G$ es $3$-regular, los grado en $G$ de los vértices en $C$ suman un número impar, pero solamente una cantidad par de esta suma proviene de aristas en $C$: tenemos la siguiente ecuación módulo $2$
\begin{align*}
1 &\equiv \sum_{v \in C} d_G (v)\\
&= \left ( \sum_{v \in C}  d_C (v)\right) + \# \{\text{$C$-$S$ caminos}\},
\end{align*}
pero la sumatoria del lado derecho es par, pues recordemos que esta sumatoria es el doble de la cantidad de aristas de $C$.
 Con lo cual, $G$ tiene un número impar de $S$-$C$ aristas, y por lo tanto tiene al menos $3$ de estas aristas ya que $G$ no tiene puentes. Consecuentemente el número de aristas entre $S$ y $G\setminus S$ es al menos $3 q (G\setminus S)$. Por otro lado, esta cantidad es a lo más $3 \abs S$, porque $G$ es $3$-regular. Juntando ambas cosas, nos queda $q ( G\setminus S) \leq \abs S$, como queríamos probar.
\end{proof}


\bigskip

\begin{definition}
Un grafo no vacío $G = (V,E)$ se llama \textbf{factor-crítico} si no tiene matching perfecto, pero para cada vértice $v \in G$, el grafo $G \setminus \{v\}$ tiene un matching perfecto.

Llamamos a un conjunto de vértices $S \subset V$ matcheable con $\mathcal C_{G \setminus S}$ si el grafo bipartito $G_S$\footnote{$G_S$ es el grafo creado a partir de $G$ por contracción de las componentes $C \in \mathcal C_{G \setminus S}$ a vértices y borrando todas las aristas dentro de $S$. Formalmente, $G_S$ es el grafo con conjunto de vértices $S \cup \mathcal C_{G \setminus S}$ y conjunto de aristas $\set{sC | \text{ existe un vértice $c \in C$ adyacente a $s$ en $G$}}$.} contiene un matching que cubre a $S$.
\end{definition}

\Inkscape{Ilustración cómo se ve el grafo $G_S$ construido a partir de \yellow{$S$}.}

\begin{theorem}
Todo grafo $G = (V,E)$ contiene un conjunto de vértices $S$ con las siguientes propiedades:
\begin{enumerate}
\item $S$ es matcheable con $\mathcal C _{G \setminus S}$;
\item toda componente de $G\setminus S$ es factor-crítico.
\end{enumerate}
Más aún, dados un conjunto $S$ de esta forma, el grafo $G$ contiene un matching perfecto si y solo si $\abs S = \abs{\mathcal C_{G \setminus S}}$.
\end{theorem}

Para un grafo $G$, la afirmación del teorema de Tutte se sigue directamente de este resultado. En efecto, por (i) e (ii) tenemos que $\abs S \leq \abs{\mathcal C_{G\setminus S}} = q (G\setminus S)$ ya que los grafos factores-críticos tienen orden impar; con lo cual la condición \eqref{eq:condicion de Tutte} $q (G\setminus S) \leq \abs S$ implica $\abs S = \abs {\mathcal C _{G\setminus S}}$, y la existencia de un matching perfecto se sigue de la última afirmación del resultado.

\begin{proof}
Notemos que la última afirmación del teorema se sigue de los ítems (i) y (ii): como $\abs S \leq \abs {\mathcal C _{G \setminus S}} = q(G \setminus S)$ porque todas las componentes de $G\setminus S$ son impares al ser factores críticos, se sigue que si $G$ tiene un matching perfecto, luego $q (G\setminus S) \leq \abs S$ y por lo tanto $\abs S = \abs {\mathcal C _{G\setminus S}}$; recíprocamente, si $\abs S = \abs {\mathcal C _{G \setminus S}}$, luego existe un matching perfecto de los ítems (i) y (ii).

Ahora probaremos la existencia de $S$ por inducción en $\abs G$. Si $\abs G = 0$ podemos tomar $S = \emptyset$. En general, supongamos que $\abs G > 0$.

Consideremos los conjuntos $T \subset V$ para los cuales no se cumple la condición \eqref{eq:condicion de Tutte} y
\[
    d(T) := d_G (T) := q(G \setminus T) - \abs T
\]
es máximo; tomemos un conjunto $T$, llamado $S$, de cardinal máximo. Observemos sque $d(S) \geq d(\emptyset) \geq 0$.

Veamos primero que todas las componentes $C \in \mathcal C_{G \setminus S}$ son impares. En efecto, si $\abs C$ es par, podemos tomar $c \in C$ y considerar $T := S \cup \{c\}$. Como $C \setminus \{c\}$ tiene orden impar, debe tener al menos una componente impar, la cual también es componente de $G \setminus T$. Así,
\[
    q(G\setminus T) \neq q(G \setminus S) + 1 \quad \text{mientras que} \quad \abs T = \abs S + 1,
\]
con lo cual $d(T) \geq d(S)$ contradiciendo la elección de $S$ de tamaño máximo.

Luego probaremos la afirmación (ii), eso es que todo $C \in \mathcal C _{G \setminus S}$ tiene un factor crítico. Supongamos que no, es decir, existen $C\in \mathcal C _{G \setminus S}$ y $c \in C$ tales que $C' := C \setminus \{c\}$ no tiene matching perfecto. Por la hipótesis inductiva, y la observación anterior, en donde vimos que este teorema implica el Teorema de Tutte \ref{th:teorema de Tutte}, existe un conjutno $S' \subset V(C')$ tal que
\[
    q(C' \setminus S') > \abs {S'}.
\]
Como $\abs C$ es impar, $\abs{C'}$ es par, las cantidades $q(C' \setminus S')$ y $\abs{S'}$ son ambos pares o impares, con lo cual difieren por al menos $2$ unidades, i.e.
\[
    q(C' \setminus S') \geq \abs {S'} + 2
\]
y $d_{C'} (S') \neq 2$. Tomemos $T := S \cup \{c\} \cup S'$, cumple:
\[
    d(T) \geq (q(G \setminus S) - 1 + q(C' \setminus S')) - (\abs S + 1 + \abs{S'})  \geq d(S) - 1 - 1 + d_{C'} (S') \geq d(S),
\]
donde el primer $-1$ proviene de que perdimos la componente impar $C$ y el segundo $-1$ proviene de incluir a $c$ en $T$. Nuevamente, esto contradice la elección de $S$.

Finalmente, nos queda probar que $S$ es matcheable con $\mathcal C _{G \setminus S}$. Si no lo fuera, entonces por el Teorema \ref{th:teorema de Hall} aplicado al grafo bipartito $G_S$, existe un conjunto $S' \subset S$ con más vértices que vecinos, es decir, $S'$ tiene menos aristas que componentes de $\mathcal C_{G \setminus S}$. Debido a que las componentes no adyacentes a $S'$ son también componentes de $G \setminus (S \setminus S')$, y de que al quitar los vértices $S'$ de $S$ nos quedan también las componentes, el conjunto $T = S \setminus S'$ satisface
\[
    d(T) \geq (q(G \setminus S) - \abs{N_{G_S} (S')}) - (\abs S - \abs S') > d(S),
\]
contradiciendo la elección de $S$.
\end{proof}

Podemos caracterizar a los matchings máximos de un grafo $G$ conociendo al conjunto $S$ del teorema de arriba. Sea $M$ un matching en $G$ y sea $\mathcal C := \mathcal C_{G \setminus S}$. Denotemos $k_S$ al número de aristas en $M$ que cubren a algún vértice de $S$, y $k_{\mathcal C}$ al número de aristas de $M$ con ambos extremos en $G \setminus S$. Tenemos que

\begin{proposition}
Todo matching $M$ cumple
\begin{equation}\label{eq:matching condition 1}
k_S \leq \abs S \quad \text{y} \quad k_{\mathcal C} \leq \frac{\abs V - \abs S - \abs {\mathcal{C}}}{2}.
\end{equation}
Más aún, $M$ es un matching máximo si y solo si se alcanzan ambas igualdades.
\end{proposition}
\begin{proof}
Primero veamos que todo matching cumple \eqref{eq:matching condition 1}. Por un lado, claramente vale la primera desigualdad. Por otro lado, como todos los $C \in \mathcal{C}$ son impares, alguno de sus vértices no es incidente con una arista de $M$, así contando vértices cubiertos por $M$ en $G\setminus S$, vale la segunda desigualdad.

Más aún, existe un matching $M_0$ que cumple las igualdades en \eqref{eq:matching condition 1}: Tomemos $\abs S$ aristas entre $S \bigcup \mathcal C$ gracias a (i), y luego usemos (ii) para encontrar un un conjunto de $\frac{\abs C-1}{2}$ aristas en cada componente $C \in \mathcal C$. Así, $M_0$ tiene
\[
    \abs{M_0} = \abs S + \frac{\abs V - \abs S - \abs {\mathcal{C}}}{2}
\]
aristas. Esto implica junto con \eqref{eq:matching condition 1} que todo matching máximo tiene que cumplir las igualdades en \eqref{eq:matching condition 1}.

Recíprocamente, si $M$ cumple las igualdades en \eqref{eq:matching condition 1}, entonces $k_S = \abs S$ implica que todo vértice $s \in S$ tiene una arista $st \in M$ con $t \in G \setminus S$, y por $k_\mathcal{C} = \frac{\abs V - \abs S - \abs{\mathcal{C}}}{2}$ se tiene que $M$ tiene exactamente $\frac{\abs C - 1}{2}$ aristas en $C$ para cada $C \in \mathcal{C}$. Como estas últimas aristas solamente no cubren a un vértice en $C$, el extremo $t$ de cada arista $st$, debe caer en una ditinta componente $C$ para cada distinto $s$. Con lo cual $M$ tiene el mismo cardinal que el matching máximo $M_0$.
\end{proof}






\begin{remark}
Existe algorítmos polinomiales para encontrar matchings máximos en un grafo. Más precisamente, el ``blossom algorithm'' desarrollado por Jack Edmonds en 1961\footnote{Ver \cite{edmonds1991glimpseOfHeaven}.} corre en tiempo $O (\abs E \abs V^2)$ donde $G = (V,E)$. Existe un algorítmo más eficiente, obtenido por Micali y Vazirani\footnote{Ver \cite{micaliSilvioVazirani1980MaximumMatching}.}, qu ecorre en tiempo $O(\abs E \sqrt{\abs V})$, pero es mucho más complicado.
\end{remark}


\subsection{The Erdös-Pósa theorem}

Estamos motivados ahora de generalizar los teoremas de König y Hall: dados una clase de grafos $\mathcal H$, nos gustaría encontrar una función $f : \naturals \rightarrow \naturals$ independiente de cualquier grafo $G$, tal que $G$ tiene $k$ subgrafos disjuntos isomorfos a un grafo de $\mathcal H$ o tiene un subconjunto con a lo más $f(k)$ vértices que cubren los subgrafos de $G$ pertenecientes a $\mathcal H$. Si existe una función $f$ para $\mathcal H$ que cumple lo anteriormente mencionado, decimios que $\mathcal H$ tiene la \textbf{propiedad de Erdös-Pósa}.

\begin{Warning}
En lo que sigue, usamos la notación del diestal ``$\log$'' que creo que se refiere al logarítmo en base $2$.
\end{Warning}

\begin{lemma}
Sea $k \in \naturals$, y $H$ un multigrafo $3$-regular. Si $\abs H \geq s_k$, entonces $H$ contiene $k$ ciclos disjuntos. Donde
\begin{align*}
    s_k := \begin{cases}
    4kr_k & \text{ si $k \geq 2$,}\\
    1 & \text{ si $k \leq 1$}
    \end{cases} \quad \text{donde} \quad r_k := \log k + \log \log k + 4.
\end{align*}
\end{lemma}
\begin{proof}
Haremos inducción en $k$. Si $k \leq 1$, la afirmación es trivial, con lo cual supongamos que $k \geq 2$. Sea $C$ el ciclo mas corto en $H$.

Veamos primer que $H \setminus C$ contiene una subdivisión de un multigrafo $3$-regular $H'$ con $\abs{H'}\geq \abs H  - 2 \abs C$. Sea $m$ el número de aristas entre $C$ y $H \setminus C$. Como $H$ es $3$-regular y $d (C) = 2$, tenemos que $m \leq \abs C$. Ahora consideramos biparticiones $\{V_1, V_2\}$ de $V(H)$, empezando con $V_1 := V(C)$ (eventualmente permitiremos que $V_2$ sea vacío). Si $H[V_2]$ tiene un vértice de grado a lo más $1$, movemos este vértice a $V_1$, obteniendo una nueva partición $\{V_1,V_2\}$ con menos aristas que antes. Supongamos que podemos realizar una sucesión con $n$ pasos, pero no más. Luego la partición final $\{V_1,V_2\}$ tiene a lo más $m - n$ aristas. Y $H[V_2]$ tiene a lo más $m-n$ vértices de grado $< 3$, ya que cada una de estas incide en una arista de cruce entre $V_1$ y $V_2$. De hecho, estos vértices tienen grado exactamente $2$ en $H[V_2]$, pues no podemos mover más vértices a $V_1$. Sea $H'$ el multigrafo $3$-regular obtenido a partir de $H[V_2]$ luego de eliminar estos vértices de grado $<3$. Tenemos que
\[
    \abs{H'} \geq \abs H - \abs C - n - (m-n) \geq \abs H - 2 \abs C,
\]
como queríamos.

Para finalizar la demostración, basta ver que $\abs {H'} \geq s_{k-1}$. Ya que $\abs C \leq 2 \log \abs H$ por el Corolario \ref{corolario:si delta(G) geq 3, entonces g(G) < 2 log_2 abs G} (vale dx), y $\abs H \geq s_k \geq 6$, tenemos
\[
    \abs{H'} \geq \abs H - 2 \abs C \geq \abs H - 4 \log \abs H \geq s_k - 4 \log s_k.
\]
(En la última desigualdad usamos que la función $x \mapsto x - 4 \log x $ es creciente para todo $x \geq 6$.) Así, basta ver que $s_k - 4 \log s_k \geq s_{k-1}$. En efecto, si $k = 2$ es claro, luego supongamos que $k \geq 3$. Entonces $r_k \leq 4 \log k$ para $k \geq 4$, y el caso $k = 3$ es fácil. Consecuentemente,
\begin{align*}
s_k - 4 \log s_k &= 4(k-1) r_k + 4 \log k + 4 \log \log k + 16 - (8+ 4 \log k + 4 \log r_k) \\
&\geq s_{k-1} + 4 \log \log k + 8 - 4 \log (4 \log k) = s_{k-1}.
\end{align*}
\end{proof}



\begin{theorem}[Erdös \& Pósa (1965)]
Existe una función $f : \naturals \rightarrow \naturals$ tal que, dados cualquier $k \in \naturals$, todo grafo contiene $k$ ciclos disjuntos o un conjunto de a lo más $f(k)$ vértices cubriendo todos sus ciclos.
\end{theorem}
\begin{proof}
Veamos que vale para $f(k):= \lfloor s_k + k - 1 \rfloor$. Sea $k$ fijo, y $G$ un grafo. Podemos suponer que $G$ contiene un ciclo, y luego tiene un subgrafo maximal $H$ en  el cual todo vértice tiene grado $2$ o $3$. Sea $U$ su conjunto vértices de grado $3$.

Sea $\mathcal C$ el conjunto de todos sus ciclos en $G$ que que no intersecan a $U$, pero que intersecan a $H$ en exactamente un vérticce. Sea $Z\subset v(H) \setminus U$ el conjunto de estos vértices. Para cada $z \in Z$ elegimos un ciclo $C_z \in \mathcal C$ que interseca a $H$ en $z$, y escribamos $\mathcal C ' := \set{C_z | z \in Z}$. Por maximalidad de $H$, los ciclos en $\mathcal C'$ son disjuntos.

Sea $\mathcal D$ el conjunto de las componentes $2$-regulares de $H$ que no intersecan $Z$. Luego $\mathcal C' \cup \mathcal D$ es otro conjunto de ciclos disjuntos. Si $\abs{\mathcal C ' \cup \mathcal D} \geq k$, terminamos. De lo contrario, podemos agregar a $Z$ un vértice de cada ciclo en $\mathcal D$ y obtener un conjunto $X$ de a lo más $k-1$ vértices que intersecan a todos los ciclos en $\mathcal C$ y a todas las componentes $2$-regulares de $H$. Ahora consideremos cualquier ciclo de $G$ que no interseca $X$. Por maximalidad de $H$, interseca $H$. Sin embargo, no es una componente conexa de $H$, no está en $\mathcal C$, y no contiene un $H$-camino entre distintos vértices fuera de $U$ (por maximalidad de $H$). Así que este ciclo interseca $U$.

Esto prueba que todo ciclo de $G$ interseca a $X \cup U$. Como $\abs X \leq k-1$, basta probar que $\abs U < s_k$ a menos que $H$ contenga $k$ ciclos disjuntos. Pero esto se sigue del lema anterior aprlicado al multigrafo obtenido de $H$ luego de suprimir sus vértices de grado $2$ (puede quedar un multigrafo).
\end{proof}




\subsection{Empaquetamiento de árboles y arboricidad}

El problema de encontrar la máxima cantidad de árboles arista-disjuntos en un grafo o la mínima cantidad de árboles que cubren las aristas es un problema clásico, el cual resolveremos como corolario de una unificación reciente, obtenida por Bowler y Carmesin: el Teorema de packing-covering.

La motivación de encontrar $k$ subárboles arista-disjuntos en un grafo, es que permite una aplicación en la vida real: si tu computadora tiene guardado en su memoria estos árboles, rápidamente puede encontrar, de manera canónica, $k$ caminos arista disjuntos entre dos vértices dados.

\begin{definition}
Sea $G$ un grafo con una partición de sus vérticces $V(G)$ en $r$ conjuntos, cada uno generando un árbol de $G$. Llamamos \textbf{cross-edge}, a las aristas de $G$ cuyos extremos yacen en distintos conjuntos de la partición.
\end{definition}

\begin{obs}
Sea $G$ un grafo con $k$ árboles arista disjuntos generadores de $G$. Sea $U_1, \ldots, U_r$ una partición de $V(G)$ en $r$ conjuntos. Entoncces todo árbol generador $T$ de $G$ tiene al menos $r-1$ \textit{cross-edges}, con lo cual, $G$ tiene al menos $k(r-1)$ cross-edges.
\end{obs}
\begin{proof}
En efecto, por inducción en la cantidad de vértices de $G$, el caso base es trivial, en general tomamos una hoja $h \in T$, y supongamos sin pérdida de generalidad que $h \in U_1$, y supongamos que $r >1$ pues si no la afirmación es trivial. Entonces consideramos $G' := G\setminus \{h\}$, que tiene una partición $U_1 \setminus \{h\}, U_2, \ldots, U_r$ luego como $T\setminus \{h\}$ es un árbol generador podemos aplicar hipótesis inductiva. Si $U_1 \setminus \{h\} = \emptyset$, entonces tenemos al menos $r-2$ cross-edges en $G'$, luego $r-1$ en $G$, pues la arista $hv$ con $v$ el único vecino de $h$ en $T$ es un cross-edge; pero si $U_1 \setminus \{h\}$ es no vacío, entonces por hipótesis inductiva $G'$, y por lo tanto $G$, tiene al menos $r-1$ cross-edges.
\end{proof}
La observación no solo es necesaria, si no también es suficiente:

\begin{theorem}[Nash-Williams (1961); Tutte (1961)]
Un multigrafo contiene $k$ árboles generadores arista-disjuntos si y solo si toda partición $P = \{U_1,U_2,\ldots,U_r\}$ de los vértices de tiene al menos $k(r-1)$ cross-edges.
\end{theorem}

\begin{remark}
El teorema equivale a cambiar la partición $P$ por una partición en conjuntos conexos. En efecto, cualquier partición se puede refinar en una partición en conjuntos de vértices que inducen subgrafos conexos: por cada $U \in P$, consideramos la partición en las componentes conexas de $G[U]$. Luego, los cros-edges deben inducir cross-edges de la partición original, pues si $V,V'$ son dos componentes conexas de $U \in P$, no pueden tener aristas que las unan.

Así, el teorema dice que un multigrafo $G$ tiene $k$ árboles generadores disjuntos si y solo si sus contracciones por $r$ menores tienen al menos $k(r-1)$ aristas.
\end{remark}

\begin{corollary}
Todo multigrafo $G$ que es $2k$-arista conexo tiene $k$ árboles generadores disjuntos.
\end{corollary}
\begin{proof}
Saliendo de cada conjunto $U_i$ tienen que salir al menos $2k$ cross-edges, pues $G$ es $2k$-arista conexo (estamos suponiendo que $r > 1$ pues si no es trivial). Con lo cual, $G$ tiene al menos $\frac 1 2 \sum_{i = 1}^r 2k = k r$ cross-edges (consideramos el grafo obtenido luego de contraer cada $U_i$ en un solo vértice y estimamos inferiormente el grado total). Así, se sigue el resultado del teorema anterior.
\end{proof}

\begin{definition}
Decimos que un conjunto $\{H_i\}_{i}$ de un subgrafos de un multigrafo $G$ forma una \textbf{descomposición en aristas} de $G$ si $\{E(H_i)\}_i$ particiona $E(G)$.
\end{definition}
En esta terminología, el objetivo de esta sección es reponder la pregunta: ¿cuántos subgrafos generadores que forman una descomposición en aristas tiene un multigrafo $G$?

Como un subgrafo conexo es generador si y solo si interseca todos los enlaces de $G$, la pregunta anterior tiene una pregunta dual: ¿cuál es la mínima cantidad de subgrafos \textbf{few-acyclic} (i.e. su comlemento interseca a todos los circuitos) podemos descomponer en aristas a $G$?

\begin{definition}
Diremos que una familia de grafos \textbf{cubre sus aristas}, si toda arista de $G$ yace en al menos uno de estos grafos.
\end{definition}
Nuestro problema dual se traduce entonces a encontrar cuáles son los multigrafos $G$ a los que se les pueden cubrir sus aristas por a lo más $K$ árboles.

\begin{obs}
Necesariamente, todo subconjunto $U \subset V(G)$, induce a lo más $k(\abs U -1)$ aristas, no más de $\abs U -1$ por cada árbol. Dualmente, no hay manera de ``eliminar'' menores de $G$, de manera que nos quede un grafo con demasiadas aaristas para ser cubiertas por $K$ árboles
\end{obs}
La observación no solo es necesaria, si no también es suficiente:

\begin{theorem}[Nash-Williams (1964)]\label{th:nash-williams-arboricidad}
Las aristas de un multigrafo $G = (V,E)$ se pueden cubrir por a lo más $K$ árboles si y solo si $\Abs {G[U]} \leq k (\abs U - 1)$ para todo subconjunto no vacío $U \subset V$.
\end{theorem}

\begin{definition}
El menor número de árboles que puede cubrir las aristas de un grafo es la \textbf{arboricidad}.
\end{definition}
 Por el Teorema anterior \ref{th:nash-williams-arboricidad}, la arboricidad de un grafo mide la densidad máxima local: un grafo tiene poca arboricidad si y solo si es ``nunca denso'' en el sentido de que no tiene subgrafos $H$ con $\epsilon (H)$ grande.

\begin{theorem}[Bowler \& Carmesin (2015)]\label{th:packing-covering theorem - Bowler - Carmesin - 2015}
Para todo multigrafo conexo $G = (V,E)$ y todo $k \in \naturals$, existe una partición $P$ de $V$ tal que todo $G[U]$ con $U \in P$ tiene $k$ árboles generadores disjuntos y las aristas de $G/P$ (el grafo contraido: aristas entre dos conjuntos $U,U' \in P$ se vuelven aristas paralelas en $G/P$) pueden cubrirse con $k$ árboles generadores.
\end{theorem}
\begin{proof}
\begin{notation}
Sea $T$ un árbol generador de $G$, $e$ una cuerda, y $f \in E(T)$ una arista en el ciclo fundamental $C_e$. Entonces $T' = T + e - f$ es otro árbol generador: por el Corolario \ref{}, pues $T'$ es conexo y tiene el mismo número de aristas que $T$. Decimos que $T'$ es obtenido de $T$ al \textbf{intercambiar} $f$ por $e$.

Ahora, sea $\mathcal{T} = \{T_1,\ldots, T_k\}$ una familia de árboles generadores de $G$. llamemos a una sucesión $e_0, \ldots, e_n$ de aristas una \textbf{cadena de intercambios} para $\mathcal{T}$ \textbf{empezando} en $e_0$ si $e_n$ no yace en inguno de estos árboles, pero para todo $i < n$ existe $j = j(i)$ tal que $e_i \in T_J$ mientras que $e_{i+1}$ es una cuerda de $T_j$ cuyo ciclo fundamental con respecto de $T_j$ contiene a $e_i$.

Escribamos $E(\mathcal{T})  = \bigcup \{ E(T) | T \in \mathcal{T} \}$ para una familia.
\end{notation}

\begin{lemma}
Si $e_0$ comienza una cadena de intercambios para $\mathcal{T}$ y yace en dos de sus árboles, luego existe unau familia $\mathcal{T} '$ de $k$ árboles generadores de $G$ tales que $E(\mathcal{T}) \subsetneq E(\mathcal{T} ')$.
\end{lemma}
\begin{proof}
Tomemos una cadena de intercambios $e_0,\ldots, e_n$ de longitud mínima para $\mathcal T$ que empiece en $e_0$. Entonces ninguno de los $e_i$ yace en el ciclo fundamental, con respecto de cualquier árbol en $\mathcal T$, para cualquier $e_\ell$ con $\ell > i + 1$: de lo contrario podríamos acortar la secuencia saltando de $e_i$ en $e_\ell$ o $e_{\ell+1}$.

Ahora, empezando con $\mathcal T ^0 = \mathcal T$, definimos $\mathcal T^{i+1}$ recursivamente para $i = 0, \ldots, n-1$ reemplazando en $\mathcal T^i = \{ T_1^i , \ldots, T_k^i$ el árbol $T_j^i$ por $T_j^i + e_{i+1} - e_i =: T_j^{i+1}$ para $j = j(i)$. Notar que para $j = j(i)$ la minimalidad de nuestra secuencia implica que toda arista $e$ de $T_j$ en su ciclo fundamental para $e_{i+1}$ está todavía en $T_j^i$: de lo contrario $e = e_{i'}$ para algún $i' < i$, obteniendo una contradicción para $\ell := i+1 > i' + 1$. Así, si $T_j^i$ es un árbol generador de $G$, lo cual podemos asumir inductivamente, implica que $T_j^{i+1}$ también lo es.

Claramente, $\mathcal T ' := \{ T_1^n , \ldots, T_k^n \}$ cumple $E(\mathcal T ') = E(\mathcal T) \cup \{e_n\}$.
\end{proof}

Ahora estamos en condiciones de probar el teorema. Sea $\mathcal T =   \{T_1,\ldots, T_k\}$ una familia de $k$ árboles generadores de $G$, elegidos de manera que $E(\mathcal T)$ es maximal. Sea $D$ el conjunto de tudas sus aristas en $G$ que empiezan una cadena de intercambios para $\mathcal T$. Estas incluyen todas las aristas que no están en $E(\mathcal T)$, pues estas forman cadenas de intercambio con una sola arista. Sea $P$ la partición de $V$ en sus conjuntos de vértices de las componentes conexas de $(V,D)$.

Para la afirmación de la parte de packing del teorema, sea $U \in P$. Para todo $j = 1, \ldots, k$ sea $S_j$ el subgrafo de $T_j [U]$ formado por sus aristas en $D$. Estos árboles $S_j$ son arista disjuntos, pues por maxximalidad de $\mathcal T$ y el lema anterior, ninguna arista en $D$ yace en más de un $T_j$. Veamos que los $S_j$ son conexos.

En efecto, como las aristas de $D$ forman un submultigrafo conexo en $U$, basta probar que para cada aristas $uu'\in D$ con $u,u' \in U$ existe un $u$-$u'$ camino en $S_j$. Es claro que si $uu'$ yace en $T_j$, luego yace en $S_j$. Si no, entonces existe un camino $uT_j u'$ que sigue teniendo sus aristas $e \in D$, y por lo tanto yace en $S_j$: si $e_0, \ldots, e_n$ es un intercambio de cadenas tal que $e_0 = uu' \in D$, entonces $e, e_0, \ldots, e_n$ es un intercambio de cadenas poniendo $e \in D$, pues $e$ yace en el ciclo fundamental de $e_0$ respecto de $T_j$.

Como todo $T_j$ induce subgrafos conexos $S_j$ en los conjuntos de la partición $P$, contrayendo estos $S_j$ convierte los $T_j$ en árboles generadores $T_j'$ de $G/P$. Estos $T_j'$ cubren todas las aristas de $G/P$, ya que $E \setminus E(\mathcal T) \subset D$.

\end{proof}

\begin{proof}[(Nash-Williams; Tutte)]
Supongamos que un multigrafo $G$ tiene al menos $k (\abs P -1)$ cross-edges por ccada partición $P$ de $V(G)$. Sea $P$ la partición del Teorema \ref{th:packing-covering theorem - Bowler - Carmesin - 2015}. Por el teorema, $G/P$ tiene $k$ árboles generadores que cubren sus aristas. Como $\Abs {G/P} \geq k(\abs P -1)$, deben ser arista disjuntos. Combinandolas con los árboles generadores arista-disjuntos de $G[U]$ que también son provistos por el Teorema \ref{th:packing-covering theorem - Bowler - Carmesin - 2015}, obtenemos los $K$ árboles generadores de $G$ que buscabamos.
\end{proof}

\begin{proof}[(Nash-Williams)]
Supongamos que todo $U\subset V$ induce a lo más $k (\abs U - 1)$ aristas en $G$. Sea $C$ una componente de $G$, y $P$ la partición de $V(C)$ provista por el Teorema \ref{th:packing-covering theorem - Bowler - Carmesin - 2015}. Para cada $U \in P$, cada uno de los $k$ árboles generadores arista disjuntos de $G[U]$ que provee el teorema tiene $\abs U -1$ aristas, con lo cual todas las aristas de $G[U]$ yacen en estos árboles. Combinando estos árboles con los árboles generadores de $C/P$ que cubren todas sus aristas (provisto por el teorema) obtenemos $k$ árboles generadores de $C$ que cubren todas sus aristas. Estos se pueden combinar en $k$ árboles que cubren las aristas de $G$. Solo falta agregar aristas para convertir estos nosques en los $k$ árboles deseados.

\end{proof}


























%%%%%%%%%%%
\Clase{15/05/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%


\subsection{Grafos planares}


\subsubsection{Prerequisitos topológicos}

\begin{definition}
\begin{enumerate}[(a)]
\item Un \textbf{segmento de recta} en el plano Euclídeo es un conjunto de puntos de la forma $\{ P + \lambda (Q-P) | 0 \leq \lambda \leq 1 \}$ para un par de puntos fijos $P,Q \in \reals^2$.
\item Un \textbf{polígono} es un subconjunto de $\reals ^2$ que es unión de un número finíto de segmentos que es homeomorfo\footnote{ Recordar que un \textbf{homeomorfismo} $\varphi : X \rightarrow Y$ entre dos espacios topológicos $X$ e $Y$, es una función continua y biyectiva tal que su función inversa $\varphi^{-1} : Y \rightarrow X$ también es continua.} al cículo unitario.
\item Un \textbf{arco} (poligonal) es la unión de un número finito de segmentos que es homeomorfo al intervalo cerrado $[0,1]$. En particular, un arco es cerrado. Fijado un homeomorfismo, las pre-imágenes de $0$ y $1$ son los \textbf{extremos} del arco y decimos que el arco \textbf{une} o \textbf{va entre} sus extremos. Observar que los extremos de un arco son distintos, pues un homeomorfismo es biyectivo. Si $P$ es un arco entre $x$ e $y$, denotamos por $I(P)$ al \textbf{interior} del arco, es decir, $I(P) :== P \setminus \{ x,y \}$.
\item Sea $A \subset \reals^2$ un conjunto abierto. Estar unido por un arco en $A$, define una relación de equivalencia en los elementos de $A$. Las clases de equivalencia las llamamos \textbf{regiones}. (Notar que las regiones son las componentes arco-conexas (por curvas continuas), o equivalentemente, las componentes conexas).
\item La \textbf{frontera} de un conjunto $X \subset \reals^2$ es el conjunto $Y$ de todos los puntos $y \in \reals^2$ tal que todo vecindario de $y$ intersecta a ambos $X$ y $\reals^2 \setminus X$.
\end{enumerate}
\end{definition}

\Inkscape{Ilustración de un abierto \darkblue{$A$}. Ilustramos los puntos $x_1,y_1 \in A$ equivalentes, ya que podemos dibujar un arco $P_1 \subset A$ entre ellos. Similarmente, $x_2,y_2$ están unidos por un arco $P_2$ en $A$, luego son equivalentes entre sí. Las regiones de $A$ son el \textit{maní} y el \textit{boomerang}. La frontera de $A$ es la ``cáscara'' del maní (líneas punteadas) y el ``borde'' del boomerang.}

\begin{theorem}[De la curva de Jordan para polígonos]
Para todo polígono $P \subset \reals ^2$, el conjunto $\reals^2 \setminus P$ tiene dos regiones: una acotada\footnote{En $\reals^2$ o más en general en $\reals^n$, decimos que un conjunto es \textbf{acotado}, si está contenido en alguna bola de tamaño lo suficientemente grande.} y otra no acotada. Cada región tiene a $P$ como frontera.
\end{theorem}

Con este teorema no es difícil probar lo siguiente:
\begin{lemma}
Sean $P_1, P_2, P_3$ arcos disjuntos salvo en sus extremos, donde cualquier par de arcos comparten ambos extremos. Entonces:
\begin{enumerate}[(i)]
\item $\reals ^2 \setminus (P_1 \cup P_2 \cup P_3)$ tiene exactamente tres regiones con fronteras $P_1 \cup P_2$, $P_2 \cup P_3$ y $P_1 \cup P_3$.
\item Si $P$ es un arco entre un punto en $I (P_1)$ y otro en $I(P_3)$, tal que $I(P)$ está en la región $\reals^2 \setminus (P_1 \cup P_3)$ que contiene a $I(P_2)$, entonces $I(P) \cap I(P_2) \neq \emptyset$.
\end{enumerate}
\end{lemma}

\Inkscape{Dos ilustraciones del lema.}

\begin{lemma}\label{lema:arco tiene una sola cara}
Para todo arco $P$, el conjunto $\reals^2 \setminus P$ tiene una sola región.
\end{lemma}




\bigskip

\begin{definition}
Un \textbf{grafo plano} (no confundir con \textit{grafo planar}) es un par $(V,E)$ que cumple:
\begin{enumerate}
\item $V \subset \reals^2$ es finito.
\item $E$ es un conjunto de arcos entre elementos de $V$.
\item Aristas distintas tienen distintos conjuntos de extremos.
\item El interior de una arista no contiene ningún vértice y ningún punto de otra arista.
\end{enumerate}
\end{definition}

Todo grafo plano $(V,E)$ define un grafo $G$ en $V$ de manera natural.

\begin{definition}
Decimos que $G$ es un \textbf{grafo planar} si se puede construir a partir de un grafo plano.
\end{definition}

\Inkscape[0.4]{Ejemplo de grafo plano, correspondiente a $K_4$.}

Es conveniente pensar al \textit{grafo plano} asosciado a un \textit{grafo planar} $G$, como el ``dibujo'' de $G$. A veces haremos el abuso de notación, y hablaremos de grafo plano y de su grafo planar asosciado refiriéndonos a cualquiera de los dos sin preocuparnos por ser correctos con la terminología.



%%%%%%%%%%%
\Clase{18/05/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%


\begin{definition}
Si $G$ es un grafo plano, llamamos \textbf{caras} a las regiones de $\reals \setminus G$. Al conjunto de caras de $G$ lo denotamos por $F (G)$.
\end{definition}

Como trabajamos con grafos planos finitos, estos son acotados, es decir, existe una bola $B \subset \reals^2$ tal que $G \subset B$. Siempre va a haber una cara que contiene a $\reals^2 \setminus B$ y esa cara la llamamos \textbf{cara exterior}.

\Inkscape{Grafo plano $G$ contenido en una bola $B$, con caras \gray{$f_1$},\purple{$f_2$},\red{$f_3$},\yellow{$f_4$}. La cara exterior $f_1$ contiene a \gray{$B$}.}

\begin{lemma}
Sea $G$ un grafo plano, $f$ una de sus caras y $H$ un subgrafo de $G$. Entonces,
\begin{enumerate}[(i)]
\item $H$ tiene una cara $f'$ que contiene a $f$.
\item Más aún, si la frontera de $f$ está en $H$, entonces $f' = f$.
\end{enumerate}
\end{lemma}

\Inkscape{Del lado izquierdo un ejemplo del ítem (i), y del derecho uno del ítem (ii).}

\begin{proof}
\begin{enumerate}[(i)]
\item Es claro que los puntos en $f$ son equivalentes en $\reals^2 \setminus H$; escojo $f'$ como la clase de equivalencia que los contiene.
\item Todo arco entre $f$ y $f' \setminus f$ pasa por la frontera $X$ de $f$. Si $f' \setminus f \neq \emptyset$, entonces hay un arco dentro de $f'$ cuyos puntos en $X$ no están en $H$. Entonces $X \not \subset H$.
\end{enumerate}
\end{proof}

\begin{lemma}\label{lema:grafos planos - una arista está en la frontera de una cara o no interseca con el interior de una arista - una arista esta en la frontera de un ciclo luego esta en dos caras de G y en dos caras distintas de C}
Sea $G$ un grafo plano y $e$ una arista de $G$. Entonces,
\begin{enumerate}[(i)]
\item Si $X$ es la frontera de una cara de $G$, luego o bien $e \subset X$ o se tiene que $X \cap I (e) = \emptyset$.
\item Si $e$ está en un ciclo $C \subset G$, luego $e$ está en la frontera de exactamente dos caras de $G$, más aún, estas están contenidas en distintas caras de $C$.
\end{enumerate}
\end{lemma}

\Inkscape{Del lado izquierdo tenemos una ilustración del ítem (i), con una arista $e$ contenida en la frontera \yellow{$X_1$} pero no en la frontera \red{$f_2$}. Del lado derecho se ilustra el ítem (ii), con una arista en un ciclo \red{$C$} también contenida en las caras $f_1$ y $f_2$ de $G$, las cuales están contenidas en las dos caras de $C$ la \gray{exterior} y la \red{interior}.}

\begin{proposition}
Si $G$ es un grafo plano que corresponde a un árbol, $G$ tiene una sola cara.
\end{proposition}
\begin{proof}
Se deduce del Lema \ref{lema:arco tiene una sola cara} dice que un arco genera una sola cara.
\end{proof}


\begin{theorem}[Fórmula de Euler]
    Sea $G$ un grafo plano conexo con $n$ vértices, $m$ aristas y $f$ caras. Entonces, se tiene
    \[
            \boxed{n - m + f = 2.}
    \]
\end{theorem}
\begin{proof}
Fijemos $n$ y hacemos inducción en la cantidad de aristas $m$. Si $m \leq n -1$, entonces $G$ es un árbol y $m = n-1$; pero la proposición anterior implica que el árbol tiene una sola cara, y por lo tanto $n - m + f = n - (n-1) + 1 = 2$.

Ahora, supongamos que $m \geq n$, entonces $G$ tiene una arista $e$ que está en un ciclo. Sea $G' = G \setminus e$. Por el lema anterior ítem (ii), $e$ está en la frontera de exactamente dos caras $f_1,f_2$ de $G$. Como los puntos en $I(e)$ de $G$. Como los puntos en $I(e)$ son equivalentes en $\reals^2 \setminus G'$, entonces hay una cara $f_e$ de $G'$ que contiene a $I(e)$.

Luego basta demostrar que
\[
    F (G) \setminus \{f_1, f_2 \} = F (G') \setminus \{f_e\},
\]
porque luego $G'$ tiene exactamente una cara y una arista menos que $G$. Así obtenemos el resultado por hipótesis inductiva.
\end{proof}





%%%%%%%%%%%
\Clase{25/05/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%


\begin{definition}
Llamamos \textbf{subdivisión} de $G$ a cualquier grafo $H$ que se obtiene luego de \textit{subdividir} algunas aristas de $G$ y dibujando encima nuevos vértices. Más precisamente, reemplazamos las aristas de $G$ por caminos entre sus extremos, de manera que los interiores de estos caminos son disjuntos y tampoco intersecan a $V(G)$, salvo en los extremos.

Si un grafo $X$ contiene un subgrafo $H$ obtenido luego de subdividir a $G$, diremos que $G$ es un \textbf{menor topológico} de $X$.
\end{definition}

\Inkscape{De izquierda a derecha, tenemos la construcción progresiva: primero $G$, luego creamos \red{vértices subdivisores} formando $H$, y finalmente ilustramos un ejemplo de grafo $X$ con $G$ como menor topológico.}

\subsubsection{\underline{Operaciones que conocemos}}

\begin{enumerate}
\item[\underline {\textit{Subgrafo inducido:}}] remover vértices.
\item[\underline {\textit{Subgrafo:}}] remover vértices y aristas.
\item[\underline {\textit{Menor:}}] remover vérties, aristas, y contraer aristas.
\item[\underline {\textit{Menor topológico:}}] remover vértices, aristas, y \textbf{contraer vértices} de grado $2$.
\end{enumerate}

Contraer un vértice $v$ de grado $2$ quiere decir que lo quitamos, pero si $u,w$ eran sus vecinos de $v$, entonces nuestro nuevo grafo tiene a $u$ y $w$ como vecinos. Equivalentemente, es lo mismo que contraer una de las dos aristas que inciden en $v$.
\Inkscape{Ejemplo de contracción de un vértice $v$.}

\subsubsection{\underline{Otra perspectiva con respecto a los menores}}

\begin{definition}
Sean $G,H$ dos grafos. Decimos que $G$ contiene un \textbf{modelo} de $H$, si $V(G)$ admite una partición $\{V_x | x \in V(H)\}$ en subconjuntos que inducen subgrafos conexos tales que dos vértices $x,y \in V(H)$ son adyacentes en $H$ si y solo si $G$ contiene una arista entre $V_x$ y $V_y$.
\end{definition}

\Inkscape{A la izquierda un grafo $H$, y a la derecha un grafo $G$ que contiene un modelo de $H$.}

Si $F$ es un grafo que contiene como subgrafo a un modelo de $H$, entonces decimos que $H$ es \textbf{menor} de $F$.

\begin{proposition}\label{proposition:relaciones entre menor y menor topologico}
Tenemos que
\begin{enumerate}[(i)]
\item Todo menor topológico de un grafo también es un menor.
\item Todo menor $H$ con $\Delta (H) \leq 3$ de un grafo es también un menor topológico.
\end{enumerate}
\end{proposition}

\subsubsection{\underline{Retomando grafos planos}}

Recordemos la Fórmula de Euler:
\begin{theorem}[Fórmula de Euler]
Sea $G$ un grafo plano conexo con $n$ vértices, $m$ aristas, y $f$ caras. Se tiene
\[
    n-m + f = 2.
\]
\end{theorem}

\begin{definition}
Un grafo plano es \textbf{maximal plano} si al agregar cualquier arista, deja de ser plano.

Un grafo plano es una \textbf{triangulación} si todas sus caras tienen por frontera un triángulo.
\end{definition}

Estas dos definiciones son equivalentes:

\begin{proposition}
Un grafo es maximial plano si y solo si es una triangulación.
\end{proposition}

\begin{corollary}
Un grafo plano $G$ con $n \geq 3$ vértices tiene a lo más $3n - 6$ aristas. Más aún, toda triangulación con $n$ vértices tiene exactamente $3n-6$ aristas; es decir, un grafo plano es una triangulación si y solo si tiene exactamente $3n-6$ aristas.
\end{corollary}
\begin{proof}
Basta demostrar la segunda afirmación gracias a la proposición anterior. En una triangulación, cada cara tiene $3$ aristas en su frontera y cada arista está en la frontera de exactamente dos caras (por el segundo ítem del Lema \ref{lema:grafos planos - una arista está en la frontera de una cara o no interseca con el interior de una arista - una arista esta en la frontera de un ciclo luego esta en dos caras de G y en dos caras distintas de C}). Consideramos ahora el $X,Y$-bigrafo que tiene los conjuntos de vértices $X := E(G)$ e $Y := F (G)$, donde $ef$ es una arista ($e \in E(G)$, $f \in F (G)$) si y solo si $e$ está en la frontera de $f$.

\Inkscape{Ejemplo de grafo bipartito obtenido a partir de una triangulación $G$.}

Notar que el número de aristas de este grafo bipartito es justamente $2 \abs {E(G)} = 3 \abs{F(G)}$. Luego reemplazando $f = \frac 2 3 m$ en la fórmula de Euler:
\[
    n - m + \frac 2 3 m = 2 \quad \Leftrightarrow \quad m = 3 n - 6.
\]
\end{proof}




%%%%%%%%%%%
\Clase{26/05/23}   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%

\begin{example}
El grafo $G := K_{3,3}$ no es plano. En efecto, al ser bipartito todos los ciclos son pares, luego si tuviera un grafo plano correspondiente, las fronteras de sus caras van a ser de largo al menos $4$, pues las fronteras de un grafo plano siempre forman un ciclo (si es que el grafo plano tiene más de una cara). Como en la demostración del corolario anterior, construimos el $X,Y$-bigrafo asosciado al grafo plano con $X = E(K_{3,3})$ e $Y = F(K_{3,3})$. Pero como en la demostración del corolario, el grafo bipartito tiene $2 \abs E (G)$ aristas y almenos $4 \abs F$ caras. Llamemos $n,m,f$ al número de vértices, aristas, y caras de $G$, respectivamente. Así, la desigualdad anterior se traduce a que $2 f \leq m$. Con lo cual, aplicando el Teorema de Euler:
\begin{array}{ccc}
    $2 = n - m + f$ & $\leq n - m + \frac m 2$ & $\quad (2 f \leq m)$ \\
                    & $\leq \frac 3 2$ & $\quad (n = 6, m = 9)$,
\end{array}
absurdo.
\end{example}

\begin{obs}
Si un grafo no es plano, entonces sus subdivisiones tampoco, porque quitar subdivisiones de un grafo plano te devuelve un grafo plano.
\end{obs}

\begin{example}
Como $K_5$ y $K_{3,3}$ no son planares, tampoco lo son sus subdivisiones. Con lo cual, si $G$ es un grafo plano entonces $G$ no contiene ni a $K_5$ ni a $K_{3,3}$ como subdivisión. De hecho, vale la recíproca:
\end{example}

\begin{theorem}
Un grafo es planar si y solo si no contiene a $K_5$ o $K_{3,3}$ como subdivisión.
\end{theorem}

\begin{lemma}
Un grafo contiene a $K_5$ o $K_{3,3}$ como menor si y solo si contiene a $K_5$ o $K_3,3$ como subdivisión.
\end{lemma}
Con lo cual, el teorema anterior equivale a pedir que contenga a estos grafos como menor.
\begin{proof}
\begin{enumerate}
\item[($\Leftarrow$)] Esta implicancia es gratis pues una subdivisión es un menor topológico, y en particular es menor.
\item[($\Rightarrow$)] Por el segundo ítem de la Proposición \ref{proposition:relaciones entre menor y menor topologico} si $G$ contiene un grafo $H$ con $\Delta (H) \leq 3$, entonces $G$ contiene a $H$ como subdivisión (i.e. $H$ es un menor topológico de $G$). Entonces nos basta demostra que $G$ contiene a $K_5$ como menor, entonces contiene a $K_5$ o a $K_{3,3}$ como subdivisión. Supongamos que $G$ contiene a $K_5$ como menor y tomo como modelo de $K_5$ en $G$ que sea minimal con respecto a las aristas, es decir, si particionamos los vértices del modelo como $V_x$ con $x \in K_5$, las aristas en $V_x$ son mínimas tal que es conexo, es decir, es un árbol, y entre cada $V_x, V_y$ con $x\neq y \in K_5$ hay una única arista.

\Dibujo{Ilustración del modelo.}

Si consideramos el grafo inducido por $V_x$ y las cuatro aristas que salen de él, obtengo un árbol $T_x$. Si cada $T_x$ fuese una subdivisión de un $K_{1,4}$
\Dibujo{}
entonces ya tenemos la subdivisión de $K_5$. Luego supongamos que no sucede, es decir, existe un $V_x$ tal que $T_x$ no es subdivisión de $K_{1,4}$. Entonces tiene dos vértices de grado $3$. Tomo esos dos vértices como extremos como extremos de su subdivisión y junto con otros extremos en las otras bolsas obtengo una subdivisión de grafo que contiene a $K_{3,3}$
\end{enumerate}
\end{proof}



















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%import{nombre de carpeta/}{Nombre del archivo}
\subfile{Apendice/Apendice.tex}





%--------------------------------
\newpage

\bibliographystyle{alpha}
\bibliography{BibliografiaGRAFOS.bib}{}
%--------------------------------







\end{document}

